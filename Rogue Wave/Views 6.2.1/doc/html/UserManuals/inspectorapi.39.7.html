<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Creating the Color Combo Box Inspector Panel</title><link rel="Prev" href="inspectorapi.39.6.html" title="Previous" /><link rel="Next" href="ctrusrpart2.html" title="Next" /><link rel="StyleSheet" href="css/inspectorapi.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/inspectorapi_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/inspectorapi.39.7.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pgY94rqd7LeHquqCaZG5iBw" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/inspectorapi.39.7.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/ctrusrfrontcover.html#wwconnect_header">Gadgets</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/ctrusrpart1.html#ww144909">Creating GUI Applications with Rogue Wave&nbsp;Views Studio</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/inspectorapi.39.1.html#wwconnect_header">Using Inspector Classes</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/inspectorapi.39.6.html#wwconnect_header">Defining a New Inspector Panel</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Creating the Color Combo Box Inspector Panel</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww998904" class="Heading2"><span></span>Creating the Color Combo Box Inspector Panel</div><div id="ww998901" class="Body">Graphic object inspectors derive from the class <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStInspectorPanel.html">IlvStInspectorPanel</a></span>. Since in our example, the inspected graphic object is also a gadget, the inspector panel we are going to create derives from <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIGadgetInspectorPanel.html">IlvStIGadgetInspectorPanel</a></span>, a subclass of <span class="code">IlvStInspectorPanel</span>. </div><div id="ww999460" class="NormalCode">class IlvColorComboBoxInspectorPanel</div><div id="ww999461" class="NormalCode">: public IlvStIGadgetInspectorPanel {</div><div id="ww999462" class="NormalCode">public:</div><div id="ww999463" class="NormalCode">    IlvColorComboBoxInspectorPanel(IlvManager* manager,</div><div id="ww999464" class="NormalCode">                                   IlvSystemView transientFor = 0,</div><div id="ww999465" class="NormalCode">                                   IlvStIAccessor::UpdateMode =</div><div id="ww999466" class="NormalCode">                                                   IlvStIAccessor::OnApply);</div><div id="ww999468" class="NormalCode">    virtual void initializeEditors();</div><div id="ww999472" class="LastNormalCode">};</div><div id="ww999492" class="Body">As we said in the section <a href="../UserManuals/inspectorapi.39.3.html#ww997532" title="Components of an Inspector Panel">Components of an Inspector Panel</a>, inspector panels are implemented with accessors and editors. These must be declared in the method <span class="code">initializeEditors</span>. In our example, the definition of this method is divided in two parts, corresponding each to the implementation of the two notebook pages that make up the inspector panel (see <a href="../UserManuals/inspectorapi.39.6.html#ww1001713" title="Defining a New Inspector Panel">Pages of the Color Combo Box Inspector Panel</a>). These pages are described in the following two sections.</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1002807" class="Note"><span class="flag">Note:&nbsp;</span>The General and Callback pages are created automatically.</div></td></tr></table></div><div id="ww999649" class="Heading3"><span></span>Implementing the Specific Page</div><div id="ww999650" class="Body">The Specific page has been designed to inspect the following properties:</div><div id="ww999658" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Color name offset</span>&nbsp;&nbsp;Specifies the offset used to display the name of the color. This property is defined by the following value:</div><div id="ww999667" class="LastNormalCodeL1">IlvListGadgetItemHolder::_labelOffsetValue </div><div id="ww999659" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Color rectangle horizontal margin</span>&nbsp;&nbsp;Specifies the margin between the vertical border of the color rectangle and the border of the gadget item. This property is defined by the following value:</div><div id="ww999671" class="LastNormalCodeL1">IlvColorDrawInfo::_HColorRectMarginValue</div><div id="ww999677" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Color rectangle vertical margin</span>&nbsp;&nbsp;Specifies the margin between the horizontal border of the color rectangle and the border of the gadget item. This property is defined by the following value:</div><div id="ww999679" class="LastNormalCodeL1">IlvColorDrawInfo::_VColorRectMarginValue</div><div id="ww999686" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Small rectangle</span>&nbsp;&nbsp;Specifies whether the color rectangle in the gadget item should be drawn in the margin specified by the color name offset property or occupy the whole gadget item. The property is defined by the following value: </div><div id="ww999699" class="LastNormalCodeL1">IlvColorDrawInfo::_SmallColorRectValue</div><div id="ww999703" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Rounded rectangle radius</span>&nbsp;&nbsp;Specifies the radius applied to the rectangle corners. For the purpose of this example, this property is ignored if the small rectangle property has been set. The property is defined by the following value:</div><div id="ww999710" class="LastNormalCodeL1">IlvColorDrawInfo::_ColorRoundRectRadius </div><div id="ww999720" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Visible items</span>&nbsp;&nbsp;Specifies which items appear in the drop-down list of the combo box. The property is defined by the following value:</div><div id="ww999726" class="LastNormalCodeL1">IlvScrolledComboBox::_nbVisibleItemsValue</div><div id="ww999728" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="bold">Enable large list option</span>&nbsp;&nbsp;Specifies the “Enable large list” option for the combo box. For details about this option, see the class <span class="ClassName"><a href="../RefMan/refcppgadgets/classIlvScrolledComboBox.html">IlvScrolledComboBox</a></span> in the Rogue Wave&nbsp;Views<span class="emphasis"> Reference Manual</span>. The property is defined by the following value:</div><div id="ww999732" class="LastNormalCodeL1">IlvScrolledComboBox::_largeListValue</div><div id="ww999737" class="Body">To inspect the above properties, you must define the <span class="code">initializeEditors</span> member function as follows:</div><div id="ww999826" class="NormalCode">void</div><div id="ww999834" class="NormalCode">IlvColorComboBoxInspectorPanel::initializeEditors()</div><div id="ww999837" class="NormalCode">{</div><div id="ww999838" class="NormalCode">&nbsp;</div><div id="ww999839" class="NormalCode">   // Color name offset.</div><div id="ww999751" class="NormalCode">   link("ColorNameOffset", IlvListGadgetItemHolder::_labelOffsetValue);</div><div id="ww999755" class="NormalCode">&nbsp;</div><div id="ww999756" class="NormalCode">   // Horizontal margin.</div><div id="ww999757" class="NormalCode">   link("XColorMargin", IlvColorDrawInfo::_HColorRectMarginValue);</div><div id="ww999761" class="NormalCode">&nbsp;</div><div id="ww999762" class="NormalCode">   // Vertical margin.</div><div id="ww999763" class="NormalCode">   link("YColorMargin", IlvColorDrawInfo::_VColorRectMarginValue);</div><div id="ww999767" class="NormalCode">&nbsp;</div><div id="ww999768" class="NormalCode">   // Small rectangle editor.</div><div id="ww999769" class="NormalCode">   link("SmallRect", IlvColorDrawInfo::_SmallColorRectValue);</div><div id="ww999775" class="NormalCode">&nbsp;</div><div id="ww999776" class="NormalCode">   // Rounded rectangle editor.</div><div id="ww999777" class="NormalCode">   link("RoundRadius", IlvColorDrawInfo::_ColorRoundRectRadius);</div><div id="ww999783" class="NormalCode">&nbsp;</div><div id="ww999784" class="NormalCode">   // Visible items.</div><div id="ww999785" class="NormalCode">   link("ComboVisibleItems", IlvScrolledComboBox::_nbVisibleItemsValue);</div><div id="ww999746" class="LastNormalCode">}</div><div id="ww999819" class="Body">The <span class="code">link</span> method automatically builds an editor and associates it with the gadget whose name is passed as its first parameter. It also creates an accessor to the property provided as its second parameter. It then links the editor and the accessor, which will be used in conjunction to inspect the property. For more information about this function, refer to the class <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStInspectorPanel.html">IlvStInspectorPanel</a></span> in the reference manual.</div><div id="ww999854" class="Heading4">Previewing Changes </div><div id="ww999820" class="Body">The changes made to the color combo box properties via the inspector panel can be reflected in a preview gadget. To achieve this, you have to create an accessor to the gadget that you decide to use as the preview gadget. To create this accessor, we recommend that you use the class <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIGraphicContainerAccessor.html">IlvStIGraphicContainerAccessor</a></span>. Once this is done, you register the accessor as the preview accessor to the inspected property using the <span class="code">setPreviewAccessor</span> or <span class="code">setPreviewValueAccessor</span> member functions (<span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIEditor.html">IlvStIEditor</a></span> and <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIPropertyAccessor.html">IlvStIPropertyAccessor</a></span>). Here is what you should do to implement a preview gadget for the properties mentioned earlier in this section:</div><div id="ww999935" class="NormalCode">void</div><div id="ww999936" class="NormalCode">IlvColorComboBoxInspectorPanel::initializeEditors()</div><div id="ww999937" class="NormalCode">{</div><div id="ww999940" class="NormalCode">    IlvStIPropertyAccessor* previewGadgetAcc =</div><div id="ww999945" class="NormalCode">          new IlvStIGraphicContainerAccessor(getHolder(), "ColorItemsList");</div><div id="ww999884" class="NormalCode">   </div><div id="ww999950" class="NormalCode">    IlvStIEditor* editor;</div><div id="ww999885" class="NormalCode">&nbsp;</div><div id="ww999886" class="NormalCode">    // Color name offset.</div><div id="ww999887" class="NormalCode">    editor = link("ColorNameOffset",</div><div id="ww999978" class="NormalCode">                  IlvListGadgetItemHolder::_labelOffsetValue);</div><div id="ww999888" class="NormalCode">    editor-&gt;setPreviewValueAccessor(</div><div id="ww999889" class="NormalCode">                                previewGadgetAcc,</div><div id="ww999890" class="NormalCode">                                IlvListGadgetItemHolder::_labelOffsetValue);</div><div id="ww999891" class="NormalCode">&nbsp;</div><div id="ww999892" class="NormalCode">    // Horizontal margin.</div><div id="ww999893" class="NormalCode">    editor = link("XColorMargin", IlvColorDrawInfo::_HColorRectMarginValue);</div><div id="ww999894" class="NormalCode">    editor-&gt;setPreviewValueAccessor(previewGadgetAcc,</div><div id="ww999896" class="NormalCode">                                    IlvColorDrawInfo::_HColorRectMarginValue);</div><div id="ww999897" class="NormalCode">&nbsp;</div><div id="ww999898" class="NormalCode">    // Vertical margin.</div><div id="ww999899" class="NormalCode">    editor = link("YColorMargin", IlvColorDrawInfo::_VColorRectMarginValue);</div><div id="ww999900" class="NormalCode">    editor-&gt;setPreviewValueAccessor(previewGadgetAcc,</div><div id="ww999902" class="NormalCode">                                    IlvColorDrawInfo::_VColorRectMarginValue);</div><div id="ww999903" class="NormalCode">&nbsp;</div><div id="ww999904" class="NormalCode">    // Small rectangle editor.</div><div id="ww999905" class="NormalCode">    editor = link("SmallRect", IlvColorDrawInfo::_SmallColorRectValue);</div><div id="ww999906" class="NormalCode">    editor-&gt;setPreviewValueAccessor(previewGadgetAcc,</div><div id="ww999908" class="NormalCode">                                    IlvColorDrawInfo::_SmallColorRectValue);</div><div id="ww999911" class="NormalCode">&nbsp;</div><div id="ww999912" class="NormalCode">    // Rounded rectangle editor.</div><div id="ww999913" class="NormalCode">    editor = link("RoundRadius", IlvColorDrawInfo::_ColorRoundRectRadius);</div><div id="ww999914" class="NormalCode">    editor-&gt;setPreviewValueAccessor(previewGadgetAcc,</div><div id="ww999916" class="NormalCode">                                    IlvColorDrawInfo::_ColorRoundRectRadius);</div><div id="ww999975" class="LastNormalCode">}</div><div id="ww999928" class="Heading4">Using Preconditions </div><div id="ww999929" class="Body">Earlier in this section, we said that the Rounded rectangle radius property is ignored when the small rectangle property is set. The following code shows you how to implement this condition:</div><div id="ww999996" class="NormalCode">    // Small rectangle editor.</div><div id="ww999997" class="NormalCode">    editor = link("SmallRect", IlvColorDrawInfo::_SmallColorRectValue);</div><div id="ww1000001" class="NormalCode">    IlvStIPropertyAccessor* smallRectAcc =</div><div id="ww1000002" class="NormalCode">                            (IlvStIPropertyAccessor*)editor-&gt;getAccessor();</div><div id="ww1000003" class="NormalCode">&nbsp;</div><div id="ww1000004" class="NormalCode">    // Rounded rectangle editor.</div><div id="ww1000005" class="NormalCode">    editor = link("RoundRadius", IlvColorDrawInfo::_ColorRoundRectRadius);</div><div id="ww1000009" class="NormalCode">    editor-&gt;getAccessor()-&gt;setPrecondition(</div><div id="ww999932" class="NormalCode">              new IlvStIPreconditionValue(smallRectAcc, </div><div id="ww1008126" class="NormalCode">                                          IlFalse, (IlvInt)0));</div><div id="ww1004350" class="LastNormalCode">    ...</div><div id="ww1000017" class="Heading3"><span></span>Implementing the Items Page</div><div id="ww1000018" class="Body">The Items page allows the user to edit the list of colors displayed in the combo box. To handle the list of colors, we must first define a list accessor by deriving the class <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIPropertyListAccessor.html">IlvStIPropertyListAccessor</a></span>, as illustrated below. List accessors are described in the <a href="../UserManuals/inspectorapi.39.3.html#ww998173" title="Components of an Inspector Panel">List Accessors</a>. </div><div id="ww1000020" class="NormalCode">class IlvColorItemsAccessor</div><div id="ww1000057" class="NormalCode">: public IlvStIPropertyListAccessor {</div><div id="ww1000058" class="NormalCode">public:</div><div id="ww1000059" class="NormalCode">    // ----------------------------------------------------------------------</div><div id="ww1000060" class="NormalCode">    // Constructor / destructor</div><div id="ww1000061" class="NormalCode">    ....</div><div id="ww1000067" class="NormalCode">    // ----------------------------------------------------------------------</div><div id="ww1000069" class="NormalCode">    IlvListGadgetItemHolder* getListGadgetItemHolder() const;</div><div id="ww1000070" class="NormalCode">&nbsp;</div><div id="ww1000071" class="NormalCode">protected:</div><div id="ww1000072" class="NormalCode">    IlvGadgetItem* getGadgetItem(const IlvStIProperty* property) const;</div><div id="ww1000073" class="NormalCode">&nbsp;</div><div id="ww1000074" class="NormalCode">    virtual IlvStIProperty** getInitialProperties(IlUInt&amp; count);</div><div id="ww1000075" class="NormalCode">    virtual IlvStIProperty*  createDefaultProperty() const;</div><div id="ww1000076" class="NormalCode">    </div><div id="ww1000077" class="NormalCode">    virtual void addProperty(IlvStIProperty* property, IlUInt index);</div><div id="ww1004370" class="NormalCode">    virtual void replaceProperty(IlvStIProperty* origProperty,</div><div id="ww1004371" class="NormalCode">                                 IlvStIProperty* newProperty,</div><div id="ww1004372" class="NormalCode">                                 IlUInt index);</div><div id="ww1000078" class="NormalCode">    virtual void deleteNewProperty(IlvStIProperty* property);</div><div id="ww1000079" class="NormalCode">    virtual void deleteProperty(IlvStIProperty* property, IlUInt index);</div><div id="ww1000080" class="LastNormalCode">};</div><div id="ww1000099" class="Body">The <span class="code">getListGadgetItemHolder</span> method returns the gadget item holder that contains the colors to be displayed. This value is the one returned by the <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIPropertyAccessor.html">IlvStIPropertyAccessor</a></span> passed to the constructor. </div><div id="ww1000100" class="NormalCode">IlvListGadgetItemHolder*</div><div id="ww1000114" class="NormalCode">IlvColorItemsAccessor::getListGadgetItemHolder()const</div><div id="ww1000115" class="NormalCode">{</div><div id="ww1000116" class="NormalCode">    IlvStIProperty* property = (_accessor? _accessor-&gt;get() : 0);</div><div id="ww1000117" class="NormalCode">    return (property? (IlvListGadgetItemHolder*)property-&gt;getPointer() : 0);</div><div id="ww1000119" class="LastNormalCode">}</div><div id="ww1004358" class="Body">The <span class="code">getGadgetItem</span> method returns the gadget item stored in the property provided as its parameter.</div><div id="ww1004359" class="NormalCode">IlvGadgetItem*</div><div id="ww1004360" class="NormalCode">IlvColorItemsAccessor::getGadgetItem(const IlvStIProperty* property)const</div><div id="ww1004361" class="NormalCode">{</div><div id="ww1004362" class="NormalCode">    return (IlvGadgetItem*)(property? property-&gt;getPointer() : 0);</div><div id="ww1004363" class="LastNormalCode">}</div><div id="ww1000126" class="Body">The <span class="code">getInitialProperties</span> method returns an array of properties which corresponds to the initial colors contained in the combo box.</div><div id="ww1000133" class="NormalCode">IlvStIProperty**</div><div id="ww1000134" class="NormalCode">IlvColorItemsAccessor::getInitialProperties(IlUInt&amp; count)</div><div id="ww1000135" class="NormalCode">{</div><div id="ww1000136" class="NormalCode">    IlvListGadgetItemHolder* listHolder = getListGadgetItemHolder();</div><div id="ww1000137" class="NormalCode">    if (!listHolder)</div><div id="ww1000257" class="NormalCode">        return 0;</div><div id="ww1000139" class="NormalCode">&nbsp;</div><div id="ww1000140" class="NormalCode">    count = (IlUInt)listHolder-&gt;getCardinal();</div><div id="ww1000141" class="NormalCode">    if (!count)</div><div id="ww1000258" class="NormalCode">        return 0;</div><div id="ww1000143" class="NormalCode">    IlvStIProperty** properties = new IlvStIProperty*[count];</div><div id="ww1000144" class="NormalCode">    for(IlUInt i = 0; i &lt; count; i++) {</div><div id="ww1000259" class="NormalCode">         properties[i] =</div><div id="ww1000260" class="NormalCode">             new IlvStIValueProperty(</div><div id="ww1000263" class="NormalCode">                  (IlvAny)listHolder-&gt;getItem((IlvUShort)i), "Item");</div><div id="ww1000148" class="NormalCode">    }</div><div id="ww1000149" class="NormalCode">    return properties;</div><div id="ww1000150" class="LastNormalCode">}</div><div id="ww1000264" class="Body">The <span class="code">createDefaultProperty</span> method is called when the user presses the Add button to create a new color. By default, this color is black. </div><div id="ww1000269" class="NormalCode">IlvStIProperty*</div><div id="ww1000154" class="NormalCode">IlvColorItemsAccessor::createDefaultProperty() const</div><div id="ww1000155" class="NormalCode">{</div><div id="ww1000156" class="NormalCode">    IlvListGadgetItemHolder* listHolder = getListGadgetItemHolder();</div><div id="ww1000157" class="NormalCode">    if (!listHolder)</div><div id="ww1000270" class="NormalCode">        return 0;</div><div id="ww1000159" class="NormalCode">    IlvValue valueInfo(IlvColorDrawInfo::_ColorInfosValue-&gt;name());</div><div id="ww1000160" class="NormalCode">    IlvColorDrawInfo* colorInfo = (IlvColorDrawInfo*)(IlvAny)</div><div id="ww1000271" class="NormalCode">                          listHolder-&gt;getGadget()-&gt;queryValue(valueInfo);</div><div id="ww1000274" class="NormalCode">    return new IlvStIValueProperty(</div><div id="ww1000275" class="NormalCode">                    new IlvColorGadgetItem(listHolder-&gt;getGadget()-&gt;</div><div id="ww1000283" class="NormalCode">                                             getDisplay()-&gt;getColor("Black"),</div><div id="ww1000284" class="NormalCode">                                           colorInfo),</div><div id="ww1000285" class="NormalCode">                    "Item");</div><div id="ww1000166" class="LastNormalCode">}</div><div id="ww1000292" class="Body">The <span class="code">addProperty</span> method is called when changes are applied to add the gadget item contained in the property given as its first parameter to the position specified by the <span class="code">index</span> parameter. The gadget item is added to the combo box. </div><div id="ww1000293" class="NormalCode">void</div><div id="ww1000177" class="NormalCode">IlvColorItemsAccessor::addProperty(IlvStIProperty* property, IlUInt index)</div><div id="ww1000179" class="NormalCode">{</div><div id="ww1000180" class="NormalCode">    IlvListGadgetItemHolder* listHolder = getListGadgetItemHolder();</div><div id="ww1000181" class="NormalCode">    if (listHolder)</div><div id="ww1000296" class="NormalCode">        listHolder-&gt;insertItem(getGadgetItem(property), </div><div id="ww1004178" class="NormalCode">                               (IlvShort)(IlvUShort)index);</div><div id="ww1000184" class="LastNormalCode">}</div><div id="ww1000300" class="Body">The <span class="code">replaceProperty</span> method is called when changes are applied to replace the gadget item contained in the property given as its first parameter by the gadget item contained in the property given as its second parameter. The third parameter indicates the position of the replaced gadget item in the combo box. </div><div id="ww1000187" class="NormalCode">void</div><div id="ww1000188" class="NormalCode">IlvColorItemsAccessor::replaceProperty(IlvStIProperty* origProperty, </div><div id="ww1000308" class="NormalCode">                                       IlvStIProperty* newProperty,</div><div id="ww1000309" class="NormalCode">                                       IlUInt)</div><div id="ww1000191" class="NormalCode">{</div><div id="ww1000192" class="NormalCode">    IlvListGadgetItemHolder* listHolder = getListGadgetItemHolder();</div><div id="ww1000193" class="NormalCode">    if (!listHolder)</div><div id="ww1000310" class="NormalCode">        return;</div><div id="ww1000195" class="NormalCode">    IlvGadgetItem* origGadgetItem = getGadgetItem(origProperty);</div><div id="ww1000196" class="NormalCode">    IlvGadgetItem* newGadgetItem = getGadgetItem(newProperty);</div><div id="ww1000197" class="NormalCode">    *(origGadgetItem) = *newGadgetItem;</div><div id="ww1000203" class="NormalCode">    newProperty-&gt;setPointer(origGadgetItem);</div><div id="ww1000204" class="LastNormalCode">}</div><div id="ww1004381" class="Body">The <span class="code">deleteNewProperty</span> method deletes the gadget item contained in the property passed as its parameter. This method is invoked when the changes made by the user are cancelled, to destroy the gadget item created by pressing the Add button. Since this gadget item is not actually added to the combo box, it does not have to be removed from it. </div><div id="ww1004382" class="NormalCode">void</div><div id="ww1004383" class="NormalCode">IlvColorItemsAccessor::deleteNewProperty(IlvStIProperty* property)</div><div id="ww1004384" class="NormalCode">{</div><div id="ww1004385" class="NormalCode">    IlvGadgetItem* gadgetItem = getGadgetItem(property);</div><div id="ww1004386" class="NormalCode">    if (gadgetItem)</div><div id="ww1004387" class="NormalCode">        delete gadgetItem;</div><div id="ww1004388" class="LastNormalCode">}</div><div id="ww1000318" class="Body">The <span class="code">deleteProperty</span> method is called when changes are applied to remove the gadget item contained in the property given as the parameter from the color combo box. </div><div id="ww1000207" class="NormalCode">void</div><div id="ww1000208" class="NormalCode">IlvColorItemsAccessor::deleteProperty(IlvStIProperty*, IlUInt index)</div><div id="ww1000209" class="NormalCode">{</div><div id="ww1000210" class="NormalCode">    IlvListGadgetItemHolder* listHolder = getListGadgetItemHolder();</div><div id="ww1000211" class="NormalCode">    if (!listHolder)</div><div id="ww1000323" class="NormalCode">        return;</div><div id="ww1000324" class="NormalCode">    listHolder-&gt;removeItem((IlvShort)(IlvUShort)index);</div><div id="ww1000216" class="LastNormalCode">}</div><div id="ww1000459" class="Heading4">Reusing the Color List Accessor </div><div id="ww1000402" class="Body">As we have seen throughout the example, the list accessor does not access the combo box directly but through its gadget item holder. The same list accessor can therefore be reused to inspect a color string list. To access the gadget item holder of the inspected combo box, we just have to create a combined accessor, as shown in the following code sample. For a description of combined accessors, see the section <a href="../UserManuals/inspectorapi.39.3.html#ww997834" title="Components of an Inspector Panel">Combined Accessors</a>. This combined accessor will be provided as a parameter to the <span class="code">IlvColorItemsAccessor</span> constructor.</div><div id="ww1000417" class="NormalCode">class IlvColorGadgetItemHolderAccessor</div><div id="ww1000419" class="NormalCode">: public IlvStICombinedAccessor</div><div id="ww1000420" class="NormalCode">{</div><div id="ww1000421" class="NormalCode">public:</div><div id="ww1000422" class="NormalCode">    IlvColorGadgetItemHolderAccessor(IlvStIPropertyAccessor* accessor = 0,</div><div id="ww1000423" class="NormalCode">                                     UpdateMode updateMode = NoUpdate,</div><div id="ww1000424" class="NormalCode">                                     BuildMode buildMode = None,</div><div id="ww1000425" class="NormalCode">                                     const char* name = 0);</div><div id="ww1000426" class="NormalCode">    // ----------------------------------------------------------------------</div><div id="ww1000427" class="NormalCode">protected:</div><div id="ww1000428" class="NormalCode">    virtual IlvStIProperty* getOriginalValue();</div><div id="ww1000429" class="NormalCode">};</div><div id="ww1000130" class="NormalCode">&nbsp;</div><div id="ww1000433" class="NormalCode">IlvStIProperty*</div><div id="ww1000435" class="NormalCode">IlvColorGadgetItemHolderAccessor::getOriginalValue()</div><div id="ww1000436" class="NormalCode">{</div><div id="ww1000437" class="NormalCode">    IlvStIProperty* property =</div><div id="ww1000449" class="NormalCode">                   (getObjectAccessor()? getObjectAccessor()-&gt;get() : 0);</div><div id="ww1000439" class="NormalCode">    if (!property)</div><div id="ww1000450" class="NormalCode">         return 0;</div><div id="ww1000441" class="NormalCode">    IlvColorComboBox* combo = (IlvColorComboBox*)property-&gt;getPointer();</div><div id="ww1000442" class="NormalCode">    if ((!combo) || (!combo-&gt;getStringList()))</div><div id="ww1000451" class="NormalCode">        return 0;</div><div id="ww1000445" class="NormalCode">    return new IlvStIValueProperty((IlvListGadgetItemHolder*)combo,</div><div id="ww1000452" class="NormalCode">                                   "ColorHolder");</div><div id="ww1000447" class="LastNormalCode">}</div><div id="ww1000688" class="Body">The class <span class="code">IlvColorItemsAccessor</span> is used in the inspector panel in the following way:</div><div id="ww1000690" class="NormalCode">IlvColorItemsAccessor* lstAccessor = </div><div id="ww1000698" class="NormalCode">    new IlvColorItemsAccessor(</div><div id="ww1000707" class="LastNormalCode">         new IlvColorGadgetItemHolderAccessor(getInspectedGraphicAccessor()));</div><div id="ww1000477" class="Heading4">Modifying Colors in the List </div><div id="ww1000483" class="Body">In the previous section, we explained how to access a list of colors. We are now going to modify a color selected in the list. To do so, we define a class that lets us inspect the color of an <span class="code">IlvColorGadgetItem</span> gadget item. Since the color is defined by the gadget item label, changing the label implies changing the color.</div><div id="ww1000492" class="NormalCode">class IlvGadgetItemColorAccessor</div><div id="ww1000493" class="NormalCode">: public IlvStICombinedAccessor</div><div id="ww1000494" class="NormalCode">{</div><div id="ww1000495" class="NormalCode">public:</div><div id="ww1004393" class="NormalCode">      ...</div><div id="ww1000496" class="NormalCode">      // ----------------------------------------------------------------------</div><div id="ww1000502" class="NormalCode">protected:</div><div id="ww1000503" class="NormalCode">    IlvGadgetItem* getGadgetItem() const;</div><div id="ww1000504" class="NormalCode">    virtual IlvStIProperty* getOriginalValue();</div><div id="ww1000505" class="NormalCode">    virtual void            applyValue(IlvStIProperty*);</div><div id="ww1000506" class="NormalCode">};</div><div id="ww1000515" class="NormalCode">&nbsp;</div><div id="ww1000517" class="NormalCode">IlvGadgetItem*</div><div id="ww1000518" class="NormalCode">IlvGadgetItemColorAccessor::getGadgetItem() const</div><div id="ww1000519" class="NormalCode">{</div><div id="ww1000520" class="NormalCode">    IlvStIProperty* property =</div><div id="ww1000550" class="NormalCode">                (getObjectAccessor()? getObjectAccessor()-&gt;get() : 0);</div><div id="ww1000522" class="NormalCode">    return (property? (IlvGadgetItem*)property-&gt;getPointer() : 0);</div><div id="ww1000523" class="NormalCode">}</div><div id="ww1000524" class="NormalCode">&nbsp;</div><div id="ww1000526" class="NormalCode">IlvStIProperty*</div><div id="ww1000527" class="NormalCode">IlvGadgetItemColorAccessor::getOriginalValue()</div><div id="ww1000528" class="NormalCode">{</div><div id="ww1000529" class="NormalCode">    IlvGadgetItem* gadgetItem = getGadgetItem();</div><div id="ww1000530" class="NormalCode">    if (!gadgetItem</div><div id="ww1000555" class="NormalCode">        return 0;</div><div id="ww1000532" class="NormalCode">    return new IlvStIValueProperty(gadgetItem-&gt;getLabel(), "Color");</div><div id="ww1000533" class="NormalCode">}</div><div id="ww1000534" class="NormalCode">&nbsp;</div><div id="ww1000536" class="NormalCode">void</div><div id="ww1000537" class="NormalCode">IlvGadgetItemColorAccessor::applyValue(IlvStIProperty* property)</div><div id="ww1000538" class="NormalCode">{</div><div id="ww1000539" class="NormalCode">    IlvGadgetItem* gadgetItem = getGadgetItem();</div><div id="ww1000540" class="NormalCode">    if (!gadgetItem)</div><div id="ww1000558" class="NormalCode">        return;</div><div id="ww1000542" class="NormalCode">    IlvValue value;</div><div id="ww1000561" class="NormalCode">    gadgetItem-&gt;setLabel((const char*)property-&gt;getValue(value));</div><div id="ww1000545" class="LastNormalCode">}</div><div id="ww1000488" class="Body">This class is used in the inspector panel code as follows:</div><div id="ww1000725" class="NormalCode">editor = new IlvStIPropertyColorEditor("EditColorItem",</div><div id="ww1000736" class="NormalCode">       new IlvGadgetItemColorAccessor(lstAccessor-&gt;getSelectionAccessor()));</div><div id="ww1000731" class="LastNormalCode">addEditor(editor);</div><div id="ww1000684" class="Body">The class <span class="code">IlvStIPropertyColorEditor</span> interfaces with a selection field to make it possible to select a color. The label that appears in the selection field represents the name of the selected color. </div><div id="ww1000685" class="Heading4">Creating the Color List Editor </div><div id="ww1000752" class="Body">To display a list of items, it is common practice to use an <span class="ClassName"><a href="../RefMan/refcppgadgets/classIlvStringList.html">IlvStringList</a></span>, which is handled by an <span class="ClassName"><a href="../RefMan/refcppstudio/classIlvStIPropertyListEditor.html">IlvStIPropertyListEditor</a></span>. However in the case of our example, we want the list to display color gadget items instead of character strings. We have implemented such list using the class <span class="code">IlvColorStringList</span>, a subclass of <span class="ClassName"><a href="../RefMan/refcppgadgets/classIlvStringList.html">IlvStringList</a></span>. To interface this new class, we have defined the following editor class:</div><div id="ww999161" class="NormalCode">class IlvColorListEditor</div><div id="ww999163" class="NormalCode">: public IlvStIPropertyListEditor {</div><div id="ww999165" class="NormalCode">public:</div><div id="ww999167" class="NormalCode">    // ----------------------------------------------------------------------</div><div id="ww999169" class="NormalCode">    // Constructor / destructor</div><div id="ww1004396" class="NormalCode">    ...</div><div id="ww999171" class="NormalCode">    // ----------------------------------------------------------------------</div><div id="ww999181" class="NormalCode">    // Overridables.</div><div id="ww999183" class="NormalCode">    virtual IlBoolean connectHolder(IlvGraphicHolder* holder);</div><div id="ww999187" class="NormalCode">protected:</div><div id="ww999189" class="NormalCode">    virtual IlvGadgetItem* createGadgetItem(</div><div id="ww1004397" class="NormalCode">                                     const IlvStIProperty* property) const;</div><div id="ww999191" class="NormalCode">};</div><div id="ww1000850" class="NormalCode">&nbsp;</div><div id="ww1000760" class="NormalCode">IlBoolean</div><div id="ww1000762" class="NormalCode">IlvColorListEditor::connectHolder(IlvGraphicHolder* holder)</div><div id="ww1000763" class="NormalCode">{</div><div id="ww1000764" class="NormalCode">    // Replaces string list of colors by an IlvColorStringList.</div><div id="ww1000765" class="NormalCode">    IlvGraphicHolder* subHolder;</div><div id="ww1000766" class="NormalCode">    IlvGadget* oldList =</div><div id="ww1000806" class="NormalCode">          (IlvGadget*)IlvStIFindGraphic(holder, getName(), &amp;subHolder);</div><div id="ww1000768" class="NormalCode">    if (!oldList)</div><div id="ww1000807" class="NormalCode">        return IlvStIPropertyListEditor::connectHolder(holder);</div><div id="ww1000770" class="NormalCode">    IlvRect bbox;</div><div id="ww1000771" class="NormalCode">    oldList-&gt;boundingBox(bbox);</div><div id="ww1000772" class="NormalCode">    IlvColorStringList* colorList =</div><div id="ww1000810" class="NormalCode">            new IlvColorStringList(oldList-&gt;getDisplay(),</div><div id="ww1000813" class="NormalCode">                                   bbox,</div><div id="ww1000816" class="NormalCode">                                   oldList-&gt;getThickness(),</div><div id="ww1000817" class="NormalCode">                                   oldList-&gt;getPalette());</div><div id="ww1000777" class="NormalCode">    colorList-&gt;useFullSelection(IlTrue, IlFalse);</div><div id="ww1000778" class="NormalCode">    colorList-&gt;setSelectionMode(IlvStringListSingleSelection);</div><div id="ww1000779" class="NormalCode">    colorList-&gt;setExclusive(IlTrue);</div><div id="ww1000780" class="NormalCode">    colorList-&gt;scrollBarShowAsNeeded(IlTrue, IlTrue, IlFalse);</div><div id="ww1000781" class="NormalCode">    subHolder-&gt;getContainer()-&gt;replace(oldList, colorList, IlTrue);</div><div id="ww1000782" class="NormalCode">&nbsp;</div><div id="ww1000783" class="NormalCode">    return IlvStIPropertyListEditor::connectHolder(holder);</div><div id="ww1000784" class="NormalCode">}</div><div id="ww1000785" class="NormalCode">&nbsp;</div><div id="ww1000787" class="NormalCode">IlvGadgetItem*</div><div id="ww1000788" class="NormalCode">IlvColorListEditor::createGadgetItem(const IlvStIProperty* property) const</div><div id="ww1000789" class="NormalCode">{</div><div id="ww1000790" class="NormalCode">    IlvGadgetItem* gadgetItem = (IlvGadgetItem*)property-&gt;getPointer();</div><div id="ww1000791" class="NormalCode">    if (!gadgetItem)</div><div id="ww1000818" class="NormalCode">        return 0;</div><div id="ww1000793" class="NormalCode">    IlvValue valueInfo(IlvColorDrawInfo::_ColorInfosValue-&gt;name());</div><div id="ww1000794" class="NormalCode">    IlvColorDrawInfo* colorInfo = </div><div id="ww1000821" class="NormalCode">         (IlvColorDrawInfo*)(IlvAny)getListGadget()-&gt;queryValue(valueInfo);</div><div id="ww1000796" class="NormalCode">    IlvGadgetItem* newGadgetItem = </div><div id="ww1000824" class="NormalCode">         new  IlvColorGadgetItem(getDisplay()-&gt;getColor(gadgetItem-&gt;getLabel()),</div><div id="ww1000829" class="NormalCode">                                colorInfo);</div><div id="ww1000799" class="NormalCode">    newGadgetItem-&gt;setEditable(IlFalse);</div><div id="ww1000800" class="NormalCode">    return newGadgetItem;</div><div id="ww1000801" class="LastNormalCode">}</div><div id="ww1000856" class="Heading4">Declaring Accessors and Editors for Inspecting Color Items to the Inspector Panel </div><div id="ww1000876" class="Body">Accessors and editors for inspecting color items are declared in the <span class="code">initializeEditors</span> method as follows: </div><div id="ww1000909" class="NormalCode">IlvColorItemsAccessor* lstAccessor =</div><div id="ww1000888" class="NormalCode">     new IlvColorItemsAccessor(</div><div id="ww1000893" class="NormalCode">         new IlvColorGadgetItemHolderAccessor(getInspectedGraphicAccessor()));</div><div id="ww1000881" class="NormalCode">addEditor(new IlvColorListEditor(lstAccessor, "ColorItemsList"));</div><div id="ww1000882" class="NormalCode">    </div><div id="ww1000883" class="NormalCode">IlvStIEditor* editor =</div><div id="ww1000908" class="NormalCode">    new IlvStIPropertyColorEditor("EditColorItem",</div><div id="ww1000903" class="NormalCode">        new IlvGadgetItemColorAccessor(lstAccessor-&gt;getSelectionAccessor()));</div><div id="ww1000886" class="LastNormalCode">addEditor(editor);</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>