<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>The IlvLightingFilter Class</title><link rel="Prev" href="filters.06.11.html" title="Previous" /><link rel="Next" href="filters.06.13.html" title="Next" /><link rel="StyleSheet" href="css/filters.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/filters_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/filters.06.12.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="po44RzGwqgbFgb4ntC6TuCg" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/filters.06.12.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/foundusrfrontcover.html#wwconnect_header">Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/filters.06.01.html#wwconnect_header">Image Processing Filters </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/filters.06.02.html#wwconnect_header">IlvBitmapFilter: The Image Processing Class </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">The IlvLightingFilter Class </span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww1006243" class="Heading2"><span></span>The IlvLightingFilter Class </div><div id="ww1006244" class="Body">The <span class="code">IlvLightingFilter</span> class lets you light an image using the alpha channel as a bump map. Several types of lights can be specified (see later).</div><div id="ww1006246" class="Body">This class is an abstract class and has two usable subclasses.</div><div id="ww1009813" class="Heading3"><span></span>The IlvDiffuseLightingFilter Class  </div><div id="ww1006248" class="Body">For the <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvDiffuseLightingFilter.html">IlvDiffuseLightingFilter</a></span> class, the resulting image is an RGBA opaque image based on the light color with alpha = 1.0 everywhere. The lighting calculation follows the standard diffuse component of the Phong lighting model. The resulting image depends on the light color, light position, and surface geometry of the input bump map.</div><div id="ww1006250" class="Body">The light map produced by this filter primitive can be combined with a texture image using the multiply term of the arithmetic <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvComposeFilter.html">IlvComposeFilter</a></span> compositing method. Multiple light sources can be simulated by adding several of these light maps together before applying it to the texture image.</div><div id="ww1006252" class="Body">The resulting RGBA image is computed as follows:</div><div id="ww1006254" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Dr = kd * N.L * Lr</span></div><div id="ww1006255" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Dg = kd * N.L * Lg</span></div><div id="ww1006256" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Db = kd * N.L * Lb</span></div><div id="ww1006257" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Da = 1.0 </span></div><div id="ww1009854" class="Body">where:</div><div class="ww_skin_page_overflow"><table class="NoBorder" style="width: 354.3304251968501pt" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top; width: 85.0393700787401pt"><div id="ww1009835" class="Cellbody"><span class="code">kd</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top; width: 269.29105511811pt"><div id="ww1009837" class="Cellbody">Diffuse lighting constant</div></td></tr><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009839" class="Cellbody"><span class="code">N</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009841" class="Cellbody">Surface normal unit vector, a function of x and y (see below)</div></td></tr><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009843" class="Cellbody"><span class="code">L</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009845" class="Cellbody">Unit vector pointing from surface to light, a function of x and y in the point and spot light cases</div></td></tr><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009847" class="Cellbody"><span class="code">Lr, Lg, Lb</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009849" class="Cellbody">RGB components of light, a function of x and y in the spot light case </div></td></tr></table></div><div id="ww1006266" class="Body"><span class="code">N</span> is a function of x and y and depends on the surface gradient as follows:</div><div id="ww1006268" class="Body">The surface described by the input alpha image <span class="code">Ain (x,y)</span> is:</div><div id="ww1006270" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Z (x,y) = surfaceScale * Ain (x,y) </span></div><div id="ww1006272" class="Body">Surface normal is calculated using the Sobel gradient 3x3 filter:</div><div id="ww1006274" class="NormalCode">Nx (x,y)= - surfaceScale * 1/4*(( I(x+1,y-1) + 2*I(x+1,y) + I(x+1,y+1))</div><div id="ww1006275" class="NormalCode">                                  - (I(x-1,y-1) + 2*I(x-1,y) + I(x-1,y+1)))</div><div id="ww1010810" class="NormalCode">&nbsp;</div><div id="ww1006276" class="NormalCode">Ny (x,y)= - surfaceScale * 1/4*(( I(x-1,y+1) + 2*I(x,y+1) + I(x+1,y+1))</div><div id="ww1006277" class="NormalCode">                                  - (I(x-1,y-1) + 2*I(x,y-1) + I(x+1,y-1)))</div><div id="ww1010811" class="NormalCode">&nbsp;</div><div id="ww1006278" class="NormalCode">Nz (x,y) = 1.0</div><div id="ww1010812" class="NormalCode">&nbsp;</div><div id="ww1006280" class="LastNormalCode">N = (Nx, Ny, Nz) / Norm((Nx,Ny,Nz)) </div><div id="ww1006282" class="Body">See <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvLightSource.html">IlvLightSource</a></span> for a further description of <span class="code">L</span>, the unit vector from the image sample to the light.</div><div id="ww1009938" class="Heading3"><span></span>The IlvSpecularLightingFilter Class </div><div id="ww1006285" class="Body">For <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvSpecularLightingFilter.html">IlvSpecularLightingFilter</a></span>, the resulting image is an RGBA image based on the light color. The lighting calculation follows the standard specular component of the Phong lighting model. The resulting image depends on the light color, light position, and surface geometry of the input bump map. The result of the lighting calculation is added. The filter primitive assumes that the viewer is at infinity in the z direction (that is, the unit vector in the eye direction is (0,0,1) everywhere).</div><div id="ww1006287" class="Body">This filter primitive produces an image that contains the specular reflection part of the lighting calculation. Such a map is intended to be combined with a texture using the add term of the arithmetic <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvComposeFilter.html">IlvComposeFilter</a></span> method. Multiple light sources can be simulated by adding several of these light maps before applying it to the texture image.</div><div id="ww1006289" class="Body">The resulting RGBA image is computed as follows:</div><div id="ww1006291" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Sr = ks * pow(N.H, specularExponent) * Lr</span></div><div id="ww1006292" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Sg = ks * pow(N.H, specularExponent) * Lg</span></div><div id="ww1006293" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Sb = ks * pow(N.H, specularExponent) * Lb</span></div><div id="ww1006294" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">Sa = max(Sr, Sg, Sb) </span></div><div id="ww1009982" class="Body">where:</div><div class="ww_skin_page_overflow"><table class="NoBorder" style="width: 354.3304251968501pt" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top; width: 85.0393700787401pt"><div id="ww1009967" class="Cellbody"><span class="code">ks</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top; width: 269.29105511811pt"><div id="ww1009969" class="Cellbody">Specular lighting constant</div></td></tr><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009971" class="Cellbody"><span class="code">N</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009973" class="Cellbody">Surface normal unit vector, a function of x and y (see below)</div></td></tr><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009975" class="Cellbody"><span class="code">H</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009977" class="Cellbody">"Halfway" unit vector between eye unit vector and light unit vector</div></td></tr><tr><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009979" class="Cellbody"><span class="code">Lr, Lg, Lb</span> </div></td><td style="padding-bottom: 2pt; padding-left: 3pt; padding-right: 3pt; padding-top: 4pt; vertical-align: top"><div id="ww1009981" class="Cellbody">RGB components of light </div></td></tr></table></div><div id="ww1006303" class="Body">See <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvDiffuseLightingFilter.html">IlvDiffuseLightingFilter</a></span> for definitions of <span class="code">N</span> and (<span class="code">Lr, Lg, Lb</span>).</div><div id="ww1006305" class="Body">The definition of <span class="code">H</span> reflects our assumption of the constant eye vector <span class="code">E = (0,0,1)</span>:</div><div id="ww1006307" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">H = (L + E) / Norm(L+E) </span></div><div id="ww1005986" class="Body">where <span class="code">L</span> is the light unit vector.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>