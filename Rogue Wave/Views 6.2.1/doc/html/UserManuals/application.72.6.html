<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Writing New Accessor Classes</title><link rel="Prev" href="application.72.5.html" title="Previous" /><link rel="Next" href="application.72.7.html" title="Next" /><link rel="StyleSheet" href="css/application.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/application_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/application.72.6.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pqIoA4_002b_002f1oJiiHXk8tgb3Xg" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/application.72.6.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/twodgfrontcover.html#wwconnect_header">2D Graphics</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/twodgpart3.html#ww144909">Prototypes</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/application.72.1.html#wwconnect_header">Using Prototypes in C++ Applications</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/application.72.5.html#wwconnect_header">Advanced Uses of Prototypes</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Writing New Accessor Classes</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww955043" class="Heading2"><span></span>Writing New Accessor Classes</div><div id="ww954240" class="Body">The Prototypes package contains many predefined accessor classes that allow you to define complex behaviors in your prototypes. You may, however, wish to implement specific behaviors for your particular needs. This section explains how you can extend the set of accessor classes you use to build your prototypes. It also explains how your new accessor classes are integrated into Rogue Wave®&nbsp;Views Studio.</div><div id="ww927958" class="Body">To add a class of accessors, you simply have to write two classes:</div><div id="ww927961" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>A subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvUserAccessor.html">IlvUserAccessor</a></span> that defines the effect of your new accessor.</div><div id="ww927962" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>A subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvAccessorDescriptor.html">IlvAccessorDescriptor</a></span> that defines the way your accessor will be edited in Rogue Wave&nbsp;Views Studio.</div><div id="ww928057" class="Body">The <span class="code">&lt;ILVHOME&gt;/samples</span> directory of the Rogue Wave&nbsp;Views distribution contains an example of a new accessor class (the <span class="code">gpacc.h</span> and <span class="code">gpacc.cpp</span> files). See the <span class="code">README</span> file in that directory for more information.</div><div id="ww927569" class="Heading3"><span></span>Subclassing IlvUserAccessor</div><div id="ww927992" class="Body">To define a new accessor class, you can either write a direct subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvUserAccessor.html">IlvUserAccessor</a></span> or derive from an existing subclass that implements the features you want to extend. You may also want to make this class persistent.</div><div id="ww959264" class="Heading4">Defining the Subclass</div><div id="ww928196" class="Body">The declaration of a subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvUserAccessor.html">IlvUserAccessor</a></span> will typically appear as follows:</div><div id="ww928280" class="NormalCode">class MyAccessor: public IlvUserAccessor {</div><div id="ww933804" class="NormalCode">public:</div><div id="ww933803" class="NormalCode">    MyAccessor(const char* name,</div><div id="ww933802" class="NormalCode">               const IlvValueTypeClass* type,</div><div id="ww933801" class="NormalCode">               const char* param1,</div><div id="ww933800" class="NormalCode">               const char* param2);</div><div id="ww933799" class="NormalCode">    DeclareUserAccessorInfo();</div><div id="ww933798" class="NormalCode">    DeclareUserAccessorIOConstructors(MyAccessor);</div><div id="ww933797" class="NormalCode">protected:</div><div id="ww933796" class="NormalCode">    IlvSymbol* _param1;</div><div id="ww933795" class="NormalCode">    IlvSymbol* _param1;</div><div id="ww933794" class="NormalCode">    virtual IlBoolean changeValue(IlvAccessorHolder* object,</div><div id="ww933793" class="NormalCode">                                   const IlvValue&amp; val);</div><div id="ww933805" class="NormalCode">    virtual IlvValue&amp; queryValue(const IlvAccessorHolder* object,</div><div id="ww933792" class="NormalCode">                                 IlvValue&amp; val) const;</div><div id="ww933791" class="LastNormalCode">}</div><div id="ww927997" class="Body">The following methods must be redefined to create a new accessor class:</div><div id="ww960174" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">MyAccessor</span></div><div id="ww928001" class="NormalCodeL1">MyAccessor(const char* name,</div><div id="ww933786" class="NormalCodeL1">           const IlvValueTypeClass* type,</div><div id="ww933787" class="NormalCodeL1">           const char* param1,</div><div id="ww933788" class="LastNormalCodeL1">           const char* param2);</div><div id="ww928013" class="IndentedL1">This constructor is used to create an instance of your accessor by code. In Rogue Wave&nbsp;Views Studio, only the input constructor will be used. The <span class="code">name</span> parameter defines the name of the attribute that will be handled by the accessor and the <span class="code">type</span> parameter defines the type of the attribute. Your constructor will probably have additional parameters, such as <span class="code">param1</span>. These parameters are often character strings that correspond to the parameters that the user can input in Rogue Wave&nbsp;Views Studio and that are evaluated at runtime.</div><div id="ww960187" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">changeValue</span></div><div id="ww928058" class="NormalCodeL1">virtual IlBoolean changeValue(IlvAccessorHolder* object,</div><div id="ww933824" class="LastNormalCodeL1">                               const IlvValue&amp; val);</div><div id="ww928061" class="IndentedL1">The <span class="code">changeValue</span> method is called when the attribute handled by the accessor is changed using a call to <span class="code">changeValue</span> on the prototype or one of its instances. You use this method to define the effect of changing the value of your accessor. If your accessor uses parameters, you must evaluate these parameters. This can be done using the <span class="code">getValue</span> method that evaluates a string containing either an immediate value or the name of another accessor.</div><div id="ww928072" class="IndentedL1">The <span class="code">object</span> parameter is the prototype or the prototype instance to which the accessor is attached. The <span class="code">val</span> parameter contains the new value. The <span class="code">changeValue</span> method must return <span class="code">IlTrue</span> if the value was successfully changed, or <span class="code">IlFalse</span> if an error occurred (for example, if one of the parameters could not be evaluated).</div><div id="ww960196" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">queryValue</span></div><div id="ww928067" class="NormalCodeL1">virtual IlvValue&amp; queryValue(const IlvAccessorHolder* object,</div><div id="ww933842" class="LastNormalCodeL1">                             IlvValue&amp; val) const;</div><div id="ww928073" class="IndentedL1">The <span class="code">queryValue</span> method is called when the attribute handled by the accessor is retrieved using a call to <span class="code">queryValue</span> on the prototype or one of its instances. This method must store the “current” value of the accessor in its <span class="code">val</span> parameter (if doing so is appropriate). Some accessors store their current value, while others do not (for example, Condition accessors do not store their value). The current value is stored in the <span class="code">val</span> parameter using the assignment operator of <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvValue.html">IlvValue</a></span>. The method must return its <span class="code">val</span> parameter.</div><div id="ww960205" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">initialize</span></div><div id="ww928086" class="LastNormalCodeL1">virtual void initialize(const IlvAccessorHolder* object);</div><div id="ww928088" class="IndentedL1">The <span class="code">initialize</span> method is called when the accessor object is associated with its prototype or prototype instance. You can redefine this method to perform any kind of initialization.</div><div id="ww928111" class="Heading4">Making the IlvUserAccessor Subclass Persistent</div><div id="ww928089" class="Body">Like graphic objects, accessor objects need to be persistent, which means they are saved to the prototype definition file and are read when the prototype is loaded. The persistence mechanism for accessor objects is very similar to the mechanism used for graphic objects.</div><div id="ww928110" class="Body">First, in the <span class="code">.h</span> file of your accessor class, you must call the following macros in the <span class="code">public</span> section of the class declaration:</div><div id="ww928119" class="NormalCode">DeclareUserAccessorInfo();</div><div id="ww933859" class="LastNormalCode">DeclareUserAccessorIOConstructors(MyAccessor);</div><div id="ww928122" class="Body">This automatically creates the Rogue Wave&nbsp;Views runtime type information for your subclass and declares the persistence and copy methods.</div><div id="ww928131" class="Body">In the <span class="code">.cpp</span> file, you then have to write the following methods:</div><div id="ww928134" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">MyAccessor(IlvDisplay* display, IlvGroupInputFile&amp; f)</span></div><div id="ww954262" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">MyAccessor::MyAccessor(const MyAccessor&amp; source)</span></div><div id="ww954267" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">MyAccessor::write(IlvGroupOututFile&amp; f) const</span></div><div id="ww954290" class="Body">This constructor reads the description of your accessor object from an input stream. The <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvGroupInputFile.html">IlvGroupInputFile</a></span> class is similar to <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvInputFile.html">IlvInputFile</a></span>. Typically, you use only its <span class="code">getStream</span> method. This returns a reference to an <span class="code">istream</span> object from which you can read the description of your accessor object. However, the convenience method <span class="code">readValue</span> can be used. The <span class="code">writeValue</span> method puts quotation marks around strings containing spaces, and the <span class="code">readValue</span> method checks for these quotation marks and reads the string correctly. Combined use of these methods avoids input/output errors. For example, the implementation of the method could be as follows:</div><div id="ww954299" class="NormalCode">MyAccessor::MyAccessor(IlvDisplay* display, IlvGroupInputFile&amp; f)</div><div id="ww954300" class="NormalCode">: IlvUserAccessor(display, f)</div><div id="ww954301" class="NormalCode">{</div><div id="ww954302" class="NormalCode">        _param1 = f.readValue();</div><div id="ww954303" class="NormalCode">        _param2 = f.readValue();</div><div id="ww954304" class="LastNormalCode">}</div><div id="ww928160" class="Body">Next, you have to write a copy constructor that will be called when the prototype is copied or when an instance of the prototype is created:</div><div id="ww928167" class="NormalCode">MyAccessor::MyAccessor(const MyAccessor&amp; source)</div><div id="ww933884" class="NormalCode">: IlvUserAccessor(source)</div><div id="ww933885" class="NormalCode">{</div><div id="ww933886" class="NormalCode">        _param1 = source._param1;</div><div id="ww933887" class="NormalCode">        _param2 = source._param2;</div><div id="ww933888" class="LastNormalCode">}</div><div id="ww928165" class="Body">The <span class="code">write</span> method must be redefined to save the description of the accessor. The format used to save the parameters must match the format defined by the input constructor:</div><div id="ww938500" class="NormalCode">MyAccessor::write(IlvGroupOututFile&amp; f) const</div><div id="ww938503" class="NormalCode">{</div><div id="ww938504" class="NormalCode">        IlvUserAccessor::write(f);</div><div id="ww938505" class="NormalCode">        f.writeValue(_param1); f &lt;&lt; IlvSpc();</div><div id="ww938506" class="NormalCode">        f.writeValue(_param2); f &lt;&lt; endl;</div><div id="ww938507" class="LastNormalCode">}</div><div id="ww928290" class="Body">Finally, the following macros must be called in the <span class="code">.cpp</span> file:</div><div id="ww928321" class="NormalCode">IlvPredefinedUserAccessorIOMembers(MyAccessor)</div><div id="ww933896" class="LastNormalCode">IlvRegisterUserAccessorClass(MyAccessor,IlvUserAccessor);</div><div id="ww927570" class="Heading3"><span></span>Subclassing IlvAccessorDescriptor</div><div id="ww928330" class="Body">Once you have written your subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvUserAccessor.html">IlvUserAccessor</a></span>, you need to write another class, a subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvAccessorDescriptor.html">IlvAccessorDescriptor</a></span>. This class provides the information needed by the Group Inspector of Rogue Wave&nbsp;Views Studio to edit the parameters of your accessor class.</div><div id="ww928336" class="Body">The name of the <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvAccessorDescriptor.html">IlvAccessorDescriptor</a></span> subclass must match the name of the subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvUserAccessor.html">IlvUserAccessor</a></span>. For example, if your accessor class is <span class="code">MyAccessor</span>, the descriptor class must be called <span class="code">MyAccessorDescriptorClass</span>.</div><div id="ww928422" class="Body">You only need to declare the accessor descriptor class. An instance of it will be automatically created and associated with your user accessor subclass by the <span class="code">IlvRegisterUserAccessorClass</span> macro.</div><div id="ww928335" class="Body">Here is a typical example of a descriptor class:</div><div id="ww928339" class="NormalCode">class MyAccessorDescriptorClass :</div><div id="ww933899" class="NormalCode">public IlvAccessorDescriptor {</div><div id="ww933900" class="NormalCode">public:</div><div id="ww933901" class="NormalCode">    MyAccessorDescriptorClass()</div><div id="ww933902" class="NormalCode">        : IlvAccessorDescriptor("MyAccessor: an example",</div><div id="ww938510" class="NormalCode">                Miscellaneous,</div><div id="ww933903" class="NormalCode">                "example %s %s...",</div><div id="ww933904" class="NormalCode">                IlFalse,</div><div id="ww933905" class="NormalCode">                &amp;IlvValueIntType,</div><div id="ww933906" class="NormalCode">                0,</div><div id="ww933898" class="NormalCode">                2,</div><div id="ww933907" class="NormalCode">                "Parameter #1", &amp;IlvValueParameterTypeString,</div><div id="ww933908" class="NormalCode">                "Parameter #2", &amp;IlvNodeNameParameterType) {}</div><div id="ww933909" class="LastNormalCode">};</div><div id="ww928416" class="Body">The accessor descriptor class only requires a constructor with no arguments. It must call the <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvAccessorDescriptor.html">IlvAccessorDescriptor</a></span> constructor. For a detailed explanation of the parameters of this constructor, see the description of the <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvAccessorDescriptor.html">IlvAccessorDescriptor</a></span> class.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>