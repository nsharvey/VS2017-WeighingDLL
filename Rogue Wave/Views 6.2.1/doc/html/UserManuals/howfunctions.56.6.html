<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Commands</title><link rel="Prev" href="howfunctions.56.5.html" title="Previous" /><link rel="Next" href="howfunctions.56.7.html" title="Next" /><link rel="StyleSheet" href="css/howfunctions.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/howfunctions_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/howfunctions.56.6.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pKpK2yVjuTwywSAdejFABBQ" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/howfunctions.56.6.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/ctrusrfrontcover.html#wwconnect_header">Gadgets</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/ctrusrpart3.html#ww997051">Rogue Wave&nbsp;Views Application Framework</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/howfunctions.56.1.html#wwconnect_header">Implementing an Application</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Commands</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww110723" class="Heading1"><span></span>Commands</div><div id="ww110724" class="Body">To modify the data of a document, it is recommended to use the Application Framework command mechanism, which provides the following advantages:</div><div id="ww110726" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Undo/Redo mechanism - The Undo, Redo, and Repeat actions are automatically processed, as well as their state. </div><div id="ww110727" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The modification state of a document is automatically managed. Adding a command to an unmodified document will mark the document as modified (a star will appear in the title of the frames that contain views associated with this document). Similarly, undoing this command will restore the unmodified state of the document (and will remove the star from the title of the same frames).</div><div id="ww110728" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Keeps a log of all modifications made to the document.</div><div id="ww110729" class="Body">Consider the following document class:</div><div id="ww110730" class="NormalCode">class MyDocument </div><div id="ww110731" class="NormalCode">: public IlvDvDocument </div><div id="ww110732" class="NormalCode">{ </div><div id="ww110733" class="NormalCode">... </div><div id="ww110734" class="NormalCode">   void setX(int x) { _x = x; } </div><div id="ww110735" class="NormalCode">   int getX() const { return _x; } </div><div id="ww110736" class="NormalCode">   protected: </div><div id="ww110737" class="NormalCode">   int _x; </div><div id="ww110738" class="LastNormalCode">}; </div><div id="ww110739" class="Body">To modify the X property of the document while processing either a document view event/action or a document action, it is not recommended to call directly the <span class="code">setX</span> method of the document. It is more appropriate to implement a command class (called <span class="code">ChangeXPropertyCommand</span> in this example) that will modify this property: </div><div id="ww110740" class="NormalCode">class ChangeXPropertyCommand </div><div id="ww110741" class="NormalCode">: public IlvDvCommand </div><div id="ww110742" class="NormalCode">{ </div><div id="ww110743" class="NormalCode">   ChangeXPropertyCommand(MyDocument* document, int newX) </div><div id="ww110744" class="NormalCode">   : _document(document), </div><div id="ww110745" class="NormalCode">   _newX(newX) </div><div id="ww110746" class="NormalCode">   { </div><div id="ww110747" class="NormalCode">      _oldX = document-&gt;getX(); </div><div id="ww110748" class="NormalCode">   } </div><div id="ww110749" class="NormalCode">   virtual void doIt() { setX(_newX); } </div><div id="ww110750" class="NormalCode">   virtual void undo() { setX(_oldX); } </div><div id="ww110751" class="NormalCode">   void setX(int x) { _document-&gt;setX(x); } </div><div id="ww110752" class="NormalCode">   protected: </div><div id="ww110753" class="NormalCode">   MyDocument* _document; </div><div id="ww110754" class="NormalCode">   int _newX; </div><div id="ww110755" class="NormalCode">   int _oldX; </div><div id="ww110756" class="LastNormalCode">}; </div><div id="ww110757" class="Body">Therefore, the implementation of a view or the document itself should invoke the following code to change the X property (instead of calling directly the <span class="code">setX</span> method of the document): </div><div id="ww110758" class="LastNormalCode">document-&gt;doCommand(new ChangeXPropertyCommand(document, newX)); </div><div id="ww110759" class="Body">This code will execute the <span class="code">ChangeXPropertyCommand</span> command by calling its <span class="code">doIt</span> method, and will store it within a command history internally managed by the document.</div><div id="ww110760" class="Body">Use the following method of the <span class="ClassName"><a href="../RefMan/refcppappframe/classIlvDvDocument.html">IlvDvDocument</a></span> class to manage commands:</div><div id="ww110769" class="NormalCode">void doCommand(IlvDvCommand* cmd, </div><div id="ww110771" class="NormalCode">               IlBoolean updateUI = IlTrue, </div><div id="ww110773" class="LastNormalCode">               IlBoolean bSetModified = IlTrue);</div><div id="ww110774" class="Body">This method is called to add the command object <span class="code">cmd</span> to the history of internal commands. Then, the command is executed by calling its <span class="MethodName"><a href="../RefMan/refcppappframe/classIlvDvCommand.html#ad48d145b3a2467e2e3e7cdf151e36646">IlvDvCommand::doIt</a></span> method. The <span class="code">updateUI</span> parameter specifies that the UI of the Undo, Redo, and Repeat commands must be updated. The <span class="code">bSetModified</span> parameter specifies whether the modification flag of the document must be set to true.</div><div id="ww110778" class="Subhead"><span></span>Undo / Redo / Repeat Actions</div><div id="ww110779" class="Body">The Undo, Redo, and Repeat actions are automatically managed by the document. To process these actions, the document invokes the following methods (which can be overridden for specific uses): </div><div id="ww110781" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">virtual IlBoolean canUndo() const;</span></div><div id="ww110783" class="IndentedL1">This method returns true if the command that has just been executed can be undone. If there is no command that can be undone, for example if the document has not been modified, this method returns false.</div><div id="ww110785" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">virtual void undo(IlBoolean bUpdateUI = IlTrue);</span></div><div id="ww110787" class="IndentedL1">This method calls the <span class="code">undo</span> method of the last command executed. The <span class="code">bUpdateUI</span> parameter specifies that the UI of the Undo, Redo, and Repeat commands must be updated.</div><div id="ww110789" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">virtual IlBoolean canRedo() const;</span></div><div id="ww110791" class="IndentedL1">This method returns true if the command that has just been undone can be redone by calling the <span class="MethodName"><a href="../RefMan/refcppappframe/classIlvDvCommand.html#ad48d145b3a2467e2e3e7cdf151e36646">IlvDvCommand::doIt</a></span> method. If there is no command that can be done, for example if the document has not been modified, this method returns false.</div><div id="ww110795" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">virtual void redo(IlBoolean bUpdateUI = IlTrue);</span></div><div id="ww110797" class="IndentedL1">This method calls the <span class="code">doIt</span> method of the last undone command. The <span class="code">bUpdateUI</span> parameter specifies that the UI of the Undo, Redo, and Repeat commands must be updated.</div><div id="ww110799" class="Itemize" style="color: #000000; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">virtual void repeat(IlBoolean bUpdateUI = IlTrue);</span></div><div id="ww110801" class="IndentedL1">This method repeats the last command executed. This command is copied by calling its <span class="MethodName"><a href="../RefMan/refcppappframe/classIlvDvCommand.html#a767d902af81069f2d3404be11d1d7934">IlvDvCommand::copy</a></span> method. The copy is added to the commands history and then executed. The <span class="code">bUpdateUI</span> parameter specifies that the UI of the Undo, Redo, and Repeat commands must be updated.</div><div id="ww110804" class="Subhead"><span></span>Reflecting Changes Made In the Data to Associated Views</div><div id="ww110719" class="Body">You have seen how to modify the data of a document by using commands. However, you still need to see how to notify the views associated with the document to reflect these changes.</div><div id="ww111307" class="Body">A document can have several views of different types. Therefore, to communicate with its views, a document sends generic messages that are interpreted by each view depending on their type. To send generic messages to its views, a document uses the following method:</div><div id="ww111259" class="NormalCode">void notifyViews(const char* messageName,</div><div id="ww111312" class="LastNormalCode">                 IlvDvDocViewInterface* exceptView, ...); </div><div id="ww111260" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The name of the message is <span class="code">messageName</span>. It must not be the name of an action (such as Copy, OpenDocument, and so on).</div><div id="ww111317" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The <span class="code">exceptView</span> parameter specifies a view that must not be notified. The value of this parameter is usually 0. It can also be the view returned by the call to <span class="code">getCurrentCallerView()</span> (this method returns the view that is currently notifying the document of an event). In this case, you may want this view <span class="emphasis">not</span> to be notified because it may have already modified its contents before it notified the document.</div><div id="ww111328" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The variable list of parameters that follows depends on the message name. For example, if a document contains information on an employee and that a command has just changed the name of that employee, the document notifies its views of this change as follows:</div><div id="ww111261" class="NormalCode">void EmployeeDocument::changeName(const char* name)</div><div id="ww111262" class="NormalCode">{</div><div id="ww111263" class="NormalCode">   _employeeName = name;</div><div id="ww111264" class="NormalCode">   notifyViews("NameChanged", 0 /* Notify all views */, name);</div><div id="ww111265" class="LastNormalCode">}</div><div id="ww111266" class="Body">To receive a message, a view (or any other class that implements the <span class="ClassName"><a href="../RefMan/refcppappframe/classIlvDvInterface.html">IlvDvInterface</a></span> interface) must specify an entry in its interface declaration. This entry makes a message name and its parameters correspond with a method of the class. This is explained in more detail in <a href="../UserManuals/interfaces.57.1.html#ww113472" title="Application Framework Interfaces">Application Framework Interfaces</a>.</div><div id="ww111267" class="Body">The sample can now be completed so that the view of an employee document can receive the message <span class="code">NameChanged</span>: </div><div id="ww111268" class="NormalCode">IlvDvBeginInterface(EmployeeView) </div><div id="ww111269" class="NormalCode">/* The message "NameChanged" with one parameter const char* name</div><div id="ww111444" class="NormalCode">   is processed by the method:</div><div id="ww111270" class="NormalCode">   EmployeeView::nameChanged with one parameter const char* name */</div><div id="ww111447" class="NormalCode">&nbsp;</div><div id="ww111271" class="NormalCode">   Method1(NameChanged, nameChanged, const char*, name) </div><div id="ww111272" class="NormalCode">IlvDvEndInterface1(IlvDvFormView) </div><div id="ww111450" class="NormalCode">&nbsp;</div><div id="ww111273" class="NormalCode">/* The nameChanged method is automatically called when an EmployeeDocument</div><div id="ww111451" class="NormalCode">   notifies its views giving the message name "NameChanged" */</div><div id="ww111454" class="NormalCode">&nbsp;</div><div id="ww111275" class="NormalCode">void EmployeeView::nameChanged(const char* name)</div><div id="ww111276" class="NormalCode">{</div><div id="ww111277" class="NormalCode">   IlvTextField* nameField = getEmployeeNameField();</div><div id="ww111278" class="NormalCode">   nameField-&gt;setLabel(name, IlvTrue);</div><div id="ww111279" class="LastNormalCode">}</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>