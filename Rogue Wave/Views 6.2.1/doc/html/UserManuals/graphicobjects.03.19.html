<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Implementing the Object Functions</title><link rel="Prev" href="graphicobjects.03.18.html" title="Previous" /><link rel="Next" href="graphicobjects.03.20.html" title="Next" /><link rel="StyleSheet" href="css/graphicobjects.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/graphicobjects_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/graphicobjects.03.19.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pN18VL_002bCmYl1g1sQHh5WDDLQ" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/graphicobjects.03.19.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/foundusrfrontcover.html#wwconnect_header">Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/graphicobjects.03.01.html#wwconnect_header">Graphic Objects</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/graphicobjects.03.15.html#wwconnect_header">Creating a new Graphic Object Class</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Implementing the Object Functions</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww168639" class="Heading2"><span></span>Implementing the Object Functions</div><div id="ww14740" class="Body">For this <a href="../UserManuals/graphicobjects.03.15.html#ww18945" title="Creating a new Graphic Object Class">example</a>, you created a header file that declares the new class and the necessary overloaded member functions. </div><div id="ww168640" class="Body">This section explains the code for the functions implemented in the file <span class="code">shadellp.cpp</span>.</div><div id="ww1704" class="Heading3"><span></span>computeInvertedPalette Member Function</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; border-bottom-color: none; border-bottom-style: none; border-bottom-width: 0.0pt; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: none; border-top-style: none; border-top-width: 0.0pt; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww24792" class="CodeInTable">void</div><div id="ww24793" class="CodeInTable">ShadowEllipse::computeInvertedPalette()</div><div id="ww24794" class="CodeInTable">{</div><div id="ww24795" class="CodeInTable">    IlvPalette* newPalette = getDisplay()-&gt;getInvertedPalette(getPalette());</div><div id="ww24796" class="CodeInTable">    newPalette-&gt;lock();</div><div id="ww24797" class="CodeInTable">    if (_invertedPalette)</div><div id="ww24798" class="CodeInTable">        _invertedPalette-&gt;unLock();</div><div id="ww24799" class="CodeInTable">    _invertedPalette = newPalette;</div><div id="ww23029" class="CodeInTable">}</div></td></tr></table></div><div id="ww7204" class="Body">The member function <span class="code">computeInvertedPalette</span> computes the inverted palette from the one we get by means of the call to the member function <span class="code">getPalette</span>. We create this inverted palette, unlock the previous one (if there was one), and lock the new one.</div><div id="ww168669" class="Body">This function is called whenever the original palette is modified (by overloading the appropriate member functions), and when the object is originally created.</div><div id="ww14270" class="Body">Creating this second palette may seem strange. In the member function <span class="code">draw</span>, the second palette is used only when calling two <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvDisplay.html">IlvDisplay</a></span> drawing member functions. Another method could have been to call the member function <span class="MethodName"><a href="../RefMan/refcppfoundation/classIlvPalette.html#a64e7c515391ff7d490cd053d8906ab42">IlvPalette::invert</a></span> before we call these member functions and then bring the palette to its original state by another call to <span class="MethodName"><a href="../RefMan/refcppfoundation/classIlvPalette.html#a64e7c515391ff7d490cd053d8906ab42">IlvPalette::invert</a></span>. Developing with Rogue Wave&nbsp;Views shows that this is not an efficient way of manipulating objects. Palette management is one of the very efficient tasks performed by Rogue Wave&nbsp;Views and you should not hesitate to use palette management when needed.</div><div id="ww1763" class="Heading3"><span></span>Destructor</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; border-bottom-color: none; border-bottom-style: none; border-bottom-width: 0.0pt; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: none; border-top-style: none; border-top-width: 0.0pt; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww24922" class="CodeInTable">ShadowEllipse::~ShadowEllipse()</div><div id="ww24923" class="CodeInTable">{</div><div id="ww24924" class="CodeInTable">    _invertedPalette-&gt;unLock();</div><div id="ww23037" class="CodeInTable">}</div></td></tr></table></div><div id="ww7165" class="Body">In the destructor, we need to release the inverted palette to the display, so it can be deleted if not used by any other object.</div><div id="ww1803" class="Heading3"><span></span>draw Member Function</div><div id="ww14292" class="Body">The member function <span class="code">draw</span> fills the two ellipses, then draws the topmost ellipse border. The global bounding rectangle (<span class="code">_rect</span>) actually covers both ellipses.</div><div id="ww10852" class="Body">Now we can show the member function <span class="code">draw</span>. It demonstrates that drawing an object is merely a call to some of the primitive member functions of the <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvDisplay.html">IlvDisplay</a></span> class:</div><div id="ww20248" class="NormalCode">void</div><div id="ww20249" class="NormalCode">ShadowEllipse::draw(IlvPort* dst, const IlvTransformer* t,</div><div id="ww20250" class="NormalCode">                       const IlvRegion* clip) const</div><div id="ww20251" class="NormalCode">{</div><div id="ww20252" class="NormalCode">    // Transform the bounding rectangle ______________________________</div><div id="ww20253" class="NormalCode">    IlvRect rect = _rect;</div><div id="ww20254" class="NormalCode">    if (t)</div><div id="ww20255" class="NormalCode">        t-&gt;apply(rect); </div><div id="ww20256" class="NormalCode">	</div><div id="ww20257" class="NormalCode">    // Set the gradient bounding box _________________________________</div><div id="ww20258" class="NormalCode">    IlvGradientGraphicBBoxManager(palette,</div><div id="ww20259" class="NormalCode">        		                IL_CONSTCAST(ShadowEllipse*, this),</div><div id="ww20260" class="NormalCode">    		                   t);</div><div id="ww20261" class="NormalCode"> </div><div id="ww20262" class="NormalCode">    // Store both the display and palette ____________________________</div><div id="ww20263" class="NormalCode">    IlvPalette* palette = getPalette();</div><div id="ww20264" class="NormalCode"> </div><div id="ww20265" class="NormalCode">    // Find a correct value for thickness ____________________________</div><div id="ww20266" class="NormalCode">    IlUShort thickness = _thickness;</div><div id="ww20267" class="NormalCode">    if ((rect.w() &lt;= thickness) || (rect.h() &lt;= thickness))</div><div id="ww20268" class="NormalCode">        thickness = IlMin(rect.w(), rect.h());</div><div id="ww20269" class="NormalCode"> </div><div id="ww20270" class="NormalCode">    // Compute actual shadow rectangle _______________________________</div><div id="ww20271" class="NormalCode">    rect.grow(-thickness, -thickness);</div><div id="ww20272" class="NormalCode">    IlvRect shadowRect = rect;</div><div id="ww20273" class="NormalCode">    shadowRect.translate(thickness, thickness);</div><div id="ww20274" class="NormalCode"> </div><div id="ww20275" class="NormalCode">#if defined(USE_2_PALETTES)</div><div id="ww20276" class="NormalCode">    // Set the clipping region for both palettes _____________________</div><div id="ww20277" class="NormalCode">    if (clip) {</div><div id="ww20278" class="NormalCode">        palette-&gt;setClip(clip);</div><div id="ww20279" class="NormalCode">        _invertedPalette-&gt;setClip(clip);</div><div id="ww20280" class="NormalCode">    } </div><div id="ww20281" class="NormalCode">	</div><div id="ww20282" class="NormalCode">    // Set the gradient bounding box _________________________________</div><div id="ww20283" class="NormalCode">    IlvGradientGraphicBBoxManager(_invertedPalette,</div><div id="ww20284" class="NormalCode">        			          IL_CONSTCAST(ShadowEllipse*, this),</div><div id="ww20285" class="NormalCode">    				    t);</div><div id="ww20286" class="NormalCode">&nbsp;</div><div id="ww20287" class="NormalCode">   // Fill shadow Ellipse ___________________________________________</div><div id="ww20288" class="NormalCode">    dst-&gt;fillArc(palette, shadowRect, 0., 360.);</div><div id="ww20289" class="NormalCode"> </div><div id="ww20290" class="NormalCode">    // Fill inverted Ellipse _________________________________________</div><div id="ww20291" class="NormalCode">    dst-&gt;fillArc(_invertedPalette, rect, 0., 360.);</div><div id="ww20292" class="NormalCode"> </div><div id="ww20293" class="NormalCode">    // Draw ellipse __________________________________________________</div><div id="ww20294" class="NormalCode">    dst-&gt;drawArc(palette, rect, 0., 360.);</div><div id="ww20295" class="NormalCode">    if (clip) {</div><div id="ww20296" class="NormalCode">        palette-&gt;setClip();</div><div id="ww20297" class="NormalCode">        _invertedPalette-&gt;setClip();</div><div id="ww20298" class="NormalCode">    }</div><div id="ww20299" class="NormalCode">#else  /* !USE_2_PALETTES */</div><div id="ww20300" class="NormalCode">    // Set the clipping region for both palettes _____________________</div><div id="ww20301" class="NormalCode">    if (clip)</div><div id="ww20302" class="NormalCode">        palette-&gt;setClip(clip);</div><div id="ww20303" class="NormalCode"> </div><div id="ww20304" class="NormalCode">    // Fill shadow ellipse ___________________________________________</div><div id="ww20305" class="NormalCode">    dst-&gt;fillArc(palette, shadowRect, 0., 360.);</div><div id="ww20306" class="NormalCode"> </div><div id="ww20307" class="NormalCode">    // Compute inverted palette and fill inverted ellipse ____________</div><div id="ww20308" class="NormalCode">    palette-&gt;invert();</div><div id="ww20309" class="NormalCode">    dst-&gt;fillArc(palette, rect, 0., 360.);</div><div id="ww20310" class="NormalCode">    palette-&gt;invert();</div><div id="ww20311" class="NormalCode"> // Draw elliptic border __________________________________________</div><div id="ww20312" class="NormalCode">    dst-&gt;drawArc(palette, rect, 0., 360.);</div><div id="ww20313" class="NormalCode"> </div><div id="ww20314" class="NormalCode">    // Set the clipping region for both palettes _____________________</div><div id="ww20315" class="NormalCode">    if (clip)</div><div id="ww20316" class="NormalCode">        palette-&gt;setClip();</div><div id="ww20317" class="NormalCode">#endif /* !USE_2_PALETTES */</div><div id="ww20318" class="NormalCode">}</div><div id="ww168756" class="Body">We do not need the transformer <span class="code">t</span> to perform our drawing work, because we want the thickness to be the same whatever the transformation is.</div><div id="ww168757" class="Body">The <span class="code">clip</span> parameter can be used when complex drawing is to take place (which is not the case here). You must reset the clipping region of all affected palettes to an empty region before you return from this function.</div><div id="ww1939" class="Heading3"><span></span>boundingBox Member Function</div><div id="ww14304" class="Body">The member function <span class="code">boundingBox</span> simply transforms the global bounding rectangle.</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; border-bottom-color: none; border-bottom-style: none; border-bottom-width: 0.0pt; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: none; border-top-style: none; border-top-width: 0.0pt; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww24907" class="CodeInTable">void</div><div id="ww24908" class="CodeInTable">ShadowEllipse::boundingBox(IlvRect&amp; rect, </div><div id="ww24909" class="CodeInTable">                           const IlvTransformer* t) const</div><div id="ww24910" class="CodeInTable">{</div><div id="ww24911" class="CodeInTable">    rect = _rect;</div><div id="ww24912" class="CodeInTable">    if (t)</div><div id="ww24913" class="CodeInTable">        t-&gt;apply(rect);</div><div id="ww23049" class="CodeInTable">}</div></td></tr></table></div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww14323" class="Note"><span class="flag">Note:&nbsp;</span>The bounding box must contain the complete drawing to avoid erasing errors.</div></td></tr></table></div><div id="ww14320" class="Heading3"><span></span>contains Member Function</div><div id="ww14327" class="Body">The member function <span class="code">contains</span> returns <span class="code">IlTrue</span> if the point is inside one of the two ellipses. All the coordinates are given in terms of the view’s coordinate system.</div><div id="ww12268" class="NormalCode">static IlBoolean</div><div id="ww12269" class="NormalCode">IsPointInEllipse(const IlvPoint&amp; p, const IlvRect&amp; bbox)</div><div id="ww12270" class="NormalCode">{</div><div id="ww12271" class="NormalCode">    if (!bbox.contains(p))</div><div id="ww12272" class="NormalCode">        return IlFalse;</div><div id="ww12273" class="NormalCode">    IlUInt rx = bbox.w() / 2,</div><div id="ww12274" class="NormalCode">            ry = bbox.h() / 2;</div><div id="ww12275" class="NormalCode">    IlUInt dx = (p.x() - bbox.centerx()) * (p.x() - bbox.centerx()),</div><div id="ww12276" class="NormalCode">            dy = (p.y() - bbox.centery()) * (p.y() - bbox.centery()),</div><div id="ww12277" class="NormalCode">    rrx = rx*rx,</div><div id="ww12278" class="NormalCode">    rry = ry*ry;</div><div id="ww12279" class="NormalCode">    return (rrx * dy + rry * dx &lt;= rrx * rry) ? IlTrue : IlFalse;</div><div id="ww12280" class="NormalCode">}</div><div id="ww12281" class="NormalCode">IlBoolean</div><div id="ww12282" class="NormalCode">ShadowEllipse::contains(const IlvPoint&amp;, const IlvPoint&amp; tp,</div><div id="ww12283" class="NormalCode">                           const IlvTransformer* t) const</div><div id="ww12287" class="NormalCode">{</div><div id="ww12288" class="NormalCode">    IlvRect rect = _rect;</div><div id="ww12289" class="NormalCode">    if (t)</div><div id="ww12290" class="NormalCode">        t-&gt;apply(rect);</div><div id="ww12291" class="NormalCode">    if ((rect.w() &lt;= _thickness) || (rect.h() &lt;= _thickness))</div><div id="ww12292" class="NormalCode">        return IsPointInEllipse(tp, rect);</div><div id="ww12293" class="NormalCode">    else {</div><div id="ww12294" class="NormalCode">        rect.grow(-_thickness, -_thickness);</div><div id="ww12295" class="NormalCode">        IlvRect shadowRect = rect;</div><div id="ww12296" class="NormalCode">        shadowRect.translate(_thickness, _thickness);</div><div id="ww12297" class="NormalCode">        return (IlBoolean)(IsPointInEllipse(tp, rect) ||</div><div id="ww12298" class="NormalCode">                            IsPointInEllipse(tp, shadowRect));</div><div id="ww12299" class="NormalCode">    }</div><div id="ww12300" class="LastNormalCode">}</div><div id="ww168817" class="Body">You can see that <span class="code">contains</span> calls the static function <span class="code">IsPointInEllipse</span> which tests whether the point parameter is inside the ellipse defined by the rectangle parameter.</div><div id="ww18913" class="Body">applyTransform Member Function</div><div id="ww18922" class="Body">The applyTransform member function applies the transformer to the rectangle of the graphic.</div><div id="ww18925" class="NormalCode">void ShadowEllipse::applyTransform(const IlvTransformer* t)</div><div id="ww18926" class="NormalCode">{</div><div id="ww18927" class="NormalCode"> if (t)</div><div id="ww18928" class="NormalCode">   t-&gt;apply(_rect);</div><div id="ww18929" class="LastNormalCode">}</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>