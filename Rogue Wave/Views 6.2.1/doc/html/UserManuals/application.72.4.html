<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Linking Prototypes to Application Objects</title><link rel="Prev" href="application.72.3.html" title="Previous" /><link rel="Next" href="application.72.5.html" title="Next" /><link rel="StyleSheet" href="css/application.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/application_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/application.72.4.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pN5Le0MkiNl7o_002bxoUYOSGA_002fA" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/application.72.4.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/twodgfrontcover.html#wwconnect_header">2D Graphics</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/twodgpart3.html#ww144909">Prototypes</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/application.72.1.html#wwconnect_header">Using Prototypes in C++ Applications</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Linking Prototypes to Application Objects</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww937264" class="Heading1"><span></span>Linking Prototypes to Application Objects</div><div id="ww937265" class="Body">This section describes the three methods that can be used to link prototypes to application objects: </div><div id="ww954798" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/application.72.4.html#ww937401" title="Linking Prototypes to Application Objects">Setting Values Directly</a>: This is the easiest way if you simply want to feed values from your application to the views.</div><div id="ww957013" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/application.72.4.html#ww937316" title="Linking Prototypes to Application Objects">Using Group Mediators</a>: This allows the application to both drive the interface and be notified of value changes produced by the user.</div><div id="ww954799" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/application.72.4.html#ww937583" title="Linking Prototypes to Application Objects">Using Proto Mediators</a>: This enables you to build object factories that will link application classes with prototypes, thereby creating the interface of a dynamic application automatically.</div><div id="ww937401" class="Subhead"><span></span>Setting Values Directly</div><div id="ww957719" class="Body">The sample <span class="code">base_feed</span> (contained in the <span class="code">&lt;ILVHOME&gt;/samples/protos</span> directory) shows how to drive your interface from your application. Once you have downloaded a panel containing instances of prototypes, or created your instances in a manager or container, you retrieve the instances that you want to edit:</div><div id="ww957721" class="NormalCode">IlvGroupHolder* groupHolder= IlvGroupHolder::Get(manager);</div><div id="ww957722" class="LastNormalCode">IlvGroup* myThermometer= groupHolder-&gt;getGroup(“thermometer”);</div><div id="ww957727" class="Body">Then, you change its values with the <span class="code">IlvGroup::changeValue</span> method:</div><div id="ww959247" class="NormalCode">if (myThermometer)</div><div id="ww957728" class="LastNormalCode">   myThermometer-&gt;changeValue(IlvValue(“temperature”,(IlUInt) 20)));</div><div id="ww937316" class="Subhead"><span></span>Using Group Mediators</div><div id="ww937317" class="Body">A group mediator (class <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvGroupMediator.html">IlvGroupMediator</a></span>) is used to connect an object of the application to a prototype and serves as an interactive graphic editor for the object (also called an object inspector). The samples <span class="code">inspector</span> and <span class="code">synoptic</span> (contained in the <span class="code">&lt;ILVHOME&gt;/samples/protos</span> directory) implement a group mediator and can be used as a baseline.</div><div id="ww937318" class="Body">The following code sample shows how to develop an application that cleanly separates the user interface from the application code. Assume that you have an application that includes a <span class="code">Machine</span> base class and a <span class="code">Boiler</span> specialization class:</div><div id="ww937319" class="NormalCode">class Machine { // The base class of most application objects.</div><div id="ww937422" class="NormalCode">protected:</div><div id="ww937423" class="NormalCode">     list&lt;MachineObserver* &gt; observers;</div><div id="ww937424" class="NormalCode">};</div><div id="ww937425" class="NormalCode">class MachineObserver { // A notification mechanism serving as a</div><div id="ww937426" class="NormalCode">                        // generic communication means between objects.</div><div id="ww937427" class="NormalCode">public:</div><div id="ww937428" class="NormalCode">     void observe(Machine* m) { m-&gt;observers.append(this); }</div><div id="ww937429" class="NormalCode">     virtual void notify (Machine*);</div><div id="ww937430" class="NormalCode">};</div><div id="ww937431" class="NormalCode">class Boiler : public Machine { // The class for which you want</div><div id="ww937432" class="NormalCode">                                // to create an object inspector.</div><div id="ww937433" class="NormalCode">public: </div><div id="ww937434" class="NormalCode">// Temperature is an attribute you want the user to have control of.</div><div id="ww937435" class="NormalCode">     void set_temperature(float) { ... </div><div id="ww937440" class="NormalCode">             for each observer in observers</div><div id="ww937441" class="NormalCode">                      observer-&gt;notify(this);</div><div id="ww937437" class="NormalCode">     } </div><div id="ww937442" class="NormalCode">     float get_temperature();</div><div id="ww937443" class="LastNormalCode">};</div><div id="ww937320" class="Body">These classes perform a simulation, a process control, or any computational activity independent of any kind of interactive or graphic behavior. A group mediator allows you to implement a graphical user interface for the <span class="code">Boiler</span> without introducing any dependencies in the application classes, which are assumed to be much more complex.</div><div id="ww937321" class="Body">For this, you want to create a subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvGroupMediator.html">IlvGroupMediator</a></span> that will handle the graphic representation and the user interaction of a machine of class <span class="code">Boiler</span>:</div><div id="ww937322" class="NormalCode">class BoilerUI : public IlvGroupMediator,  public MachineObserver {</div><div id="ww937518" class="NormalCode">public:</div><div id="ww937519" class="NormalCode">     BoilerUI(IlvGroup* ui, Boiler* b) : IlvGroupMediator(ui, b) { </div><div id="ww937520" class="NormalCode">          MachineObserver::observe(b); </div><div id="ww957743" class="NormalCode">          if (!temperatureSymbol) </div><div id="ww957744" class="NormalCode">            temperatureSymbol=IlvGetSymbol(“temperature”);</div><div id="ww937521" class="NormalCode">     }</div><div id="ww937523" class="NormalCode">     Boiler* boiler() { return (Boiler*) getObject(); }</div><div id="ww937522" class="NormalCode">     void queryValues(IlvValue* vals, IlUInt) const {</div><div id="ww937524" class="NormalCode">            if (vals[0].getName() == temperatureSymbol))</div><div id="ww937525" class="NormalCode">                 vals[0] = boiler()-&gt;get_temperature();</div><div id="ww937526" class="NormalCode">     }</div><div id="ww937527" class="NormalCode">     void changeValues(const IlvValue* vals, IlUInt) {</div><div id="ww937528" class="NormalCode">            if (vals[0].getName() == temperatureSymbol))</div><div id="ww937529" class="NormalCode">                  boiler-&gt;set_temperature(vals[0]);</div><div id="ww937530" class="NormalCode">     }</div><div id="ww937531" class="NormalCode">     void notify(Machine*) { update(); }</div><div id="ww957736" class="NormalCode">static IlvSymbol* temperatureSymbol;</div><div id="ww937532" class="LastNormalCode">};</div><div id="ww937323" class="Body">This class serves as a bridge between a prototype instance and an application object. It defines four methods:</div><div id="ww937324" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The constructor establishes a link and the <span class="code">observe(b)</span> statement declares to the application that it wants to be notified of internal changes occurring to the boiler.</div><div id="ww937325" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The <span class="code">changeValue()</span> method, which is called whenever the user changes an attribute of the object. It notifies the object that it should update its temperature value. It can handle other attributes as well.</div><div id="ww937326" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The <span class="code">queryValue()</span> method, which is called whenever the prototype needs to update its values. It queries the internal values of the object and transfers them to the user interface.</div><div id="ww937327" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The <span class="code">notify()</span> method, which must be called explicitly from within the application whenever an internal attribute of the object changes in order for these changes to be reflected in the user interface. Any call to <span class="code">Boiler::set_temperature()</span> automatically notifies all observers, which means that the <span class="code">notify()</span> method does not need to be called explicitly. Other applications that do not implement an observable/observer design pattern such as this may want to call <span class="code">notify()</span> from other parts of the internal code.</div><div id="ww937328" class="Body">Once the mediator class has been defined, you can dynamically link an object of the application to a prototype instance that is used as a boiler inspector:</div><div id="ww937329" class="NormalCode">IlvGroup* myBoilerInspector = groupHolder-&gt;getGroup("BoilerInspector");</div><div id="ww937493" class="LastNormalCode">BoilerUI* myBoilerUI = new BoilerUI(myBoilerInspector, myBoiler);</div><div id="ww937330" class="Body">You can change the application object being inspected by the prototype at any time:</div><div id="ww937331" class="LastNormalCode">myBoilerUI-&gt;setObject(myOtherBoiler);</div><div id="ww937332" class="Body">Even though this mechanism requires some application-specific coding, it is very generic—any application data structure can be adapted to use it. Once the mediator class has been designed, the user interface and the application become completely independent entities. Each can be developed and maintained separately. The user interface is developed using Rogue Wave&nbsp;Views Studio and the application using any application development environment.</div><div id="ww937333" class="Body">The group mediator also has a lock mechanism that can be used to prevent unnecessary refreshes of the user interface. In the above example, the boiler <span class="code">set_temperature</span> method calls the <span class="code">notify()</span> method of the <span class="code">BoilerUI</span> to refresh the user interface. Since the change of values comes from the <span class="code">UI</span>, it may be unnecessary to perform this last refresh. Testing the locked flag prevents such refreshes:</div><div id="ww937334" class="NormalCode">void BoilerUI::changeValues(const IlvValue* vals, IlUInt) {</div><div id="ww937569" class="NormalCode">    if (locked()) return;</div><div id="ww937570" class="NormalCode">    if (vals[0].getName() == temperatureSymbol))</div><div id="ww937581" class="NormalCode">           boiler-&gt;set_temperature(vals[0]);</div><div id="ww937582" class="LastNormalCode">}</div><div id="ww937583" class="Subhead"><span></span>Using Proto Mediators</div><div id="ww937336" class="Body">A proto mediator (class <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvProtoMediator.html">IlvProtoMediator</a></span>) is a subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvGroupMediator.html">IlvGroupMediator</a></span> and is used to dynamically create prototype instances of a given class and place them in a manager or container. The idea is to design a specific prototype for each main application class. When an object is created by the application, a corresponding prototype is instantiated and placed in the manager. This allows you to create a graphical user interface for a complete application, separating the user interface design from the functional core of the application. The following samples from the <span class="code">&lt;ILVHOME&gt;/samples/protos</span> directory implement this design pattern: <span class="code">interact_synoptic</span> to build an air-traffic control simulator, and <span class="code">synoptic</span> to build a simulator for a manufacturing plant.</div><div id="ww937337" class="Body">For example, assuming the same base application (<span class="code">Machines</span> and <span class="code">Boilers</span>), you want each <span class="code">Boiler</span> instance to be represented and edited at the same time by the user. Create a subclass of <span class="ClassName"><a href="../RefMan/refcppprotos/classIlvProtoMediator.html">IlvProtoMediator</a></span>:</div><div id="ww937338" class="NormalCode">class BoilerUI: public IlvProtoMediator, public MachineObserver {</div><div id="ww937612" class="NormalCode">public:</div><div id="ww937613" class="NormalCode">    BoilerUI(IlvManager*m,Boiler*b)</div><div id="ww937614" class="NormalCode">             :IlvProtoMediator(m,"BoilerPrototype",b) </div><div id="ww937615" class="NormalCode">        {</div><div id="ww937616" class="NormalCode">          observe(b);</div><div id="ww937617" class="NormalCode">          IlvSymbol* vals[2] = {</div><div id="ww937618" class="NormalCode">              IlvGetSymbol( "x"), IlvGetSymbol("y") };</div><div id="ww937619" class="NormalCode">          update(vals); // Sets the position of the current instance.</div><div id="ww937620" class="NormalCode">          // The application must have a way of specifying where to place</div><div id="ww937621" class="NormalCode">          // the object. Alternatively, you can handle the placement by</div><div id="ww937622" class="NormalCode">          // explicitly setting the x and y values of the BGO.</div><div id="ww937623" class="NormalCode">          install(m); // Place the prototype in the manager</div><div id="ww937624" class="NormalCode">        }</div><div id="ww937625" class="NormalCode">// Other methods are the same as the BoilerUI using the GroupMediator.</div><div id="ww937626" class="LastNormalCode">};</div><div id="ww937339" class="Body">Now, the application can have a global “user interface factory” responsible for generating prototype instances as soon as it creates its internal objects. The code of this factory may look like the following pseudo-code:</div><div id="ww937340" class="NormalCode">class myApplication {</div><div id="ww937628" class="NormalCode">      list&lt;Boiler*&gt; boilers;</div><div id="ww937629" class="NormalCode">      void initUI (IlvManager* m) {</div><div id="ww937630" class="NormalCode">           for each machine in boilers</div><div id="ww937631" class="NormalCode">               new BoilerUI(m, machine);</div><div id="ww937632" class="NormalCode">      }</div><div id="ww937633" class="NormalCode">      void add_boiler(Boiler* b) { </div><div id="ww937634" class="NormalCode">          boilers.append(b); </div><div id="ww937635" class="NormalCode">          new BoilerUI(getManager(), b); </div><div id="ww937636" class="NormalCode">      }</div><div id="ww958824" class="LastNormalCode">};</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>