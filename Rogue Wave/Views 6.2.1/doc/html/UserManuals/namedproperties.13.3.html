<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Extension of Named Properties</title><link rel="Prev" href="namedproperties.13.2.html" title="Previous" /><link rel="Next" href="printing.14.1.html" title="Next" /><link rel="StyleSheet" href="css/namedproperties.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/namedproperties_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/namedproperties.13.3.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pK0B_002fgPKR3JIQqemXIa70NQ" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/namedproperties.13.3.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/foundusrfrontcover.html#wwconnect_header">Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/namedproperties.13.1.html#wwconnect_header">IlvNamedProperty: The Persistent Properties Class</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Extension of Named Properties </span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww12677" class="Heading1"><span></span>Extension of Named Properties </div><div id="ww12682" class="Body">Creating your own named property class is a straightforward, three-step procedure:</div><div id="ww13392" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Create a subclass of <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvNamedProperty.html">IlvNamedProperty</a></span>.</div><div id="ww13397" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Choose the symbol that will be used to access this property.</div><div id="ww13399" class="IndentedL1">We remind you that in Rogue Wave&nbsp;Views all symbols whose names begin with the characters "<span class="code">_ilv</span>" are reserved for internal use.</div><div id="ww13398" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Define how this class will be persistent and register this class with Rogue Wave&nbsp;Views.</div><div id="ww14501" class="Body">Using a very simple example—the storage of two values—the following section explains how to create a named property that you can associate with graphic objects. You can, however, build named properties with member functions to handle more elaborate data members, or have named properties that store pointers to existing classes. Using named properties, you can link application data with a high level of complexity to light graphic objects, with minimum coding and without altering the API of your application classes. </div><div id="ww13473" class="Subhead"><span></span>Example: Creating a Named Property </div><div id="ww14422" class="Body">To illustrate, we are going to create a named property that holds both an integer and a character string and make it easily accessible and persistent.</div><div id="ww14452" class="Body">The general development tasks are:</div><div id="ww14453" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww12704" title="Extension of Named Properties">Declaring the Named Property: Header File</a></div><div id="ww14458" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww14428" title="Extension of Named Properties">Defining the Symbol for Accessing the Named Property</a></div><div id="ww14463" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww12915" title="Extension of Named Properties">Defining the Constructor for the Named Property</a></div><div id="ww14468" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww12947" title="Extension of Named Properties">Defining the setString Member Function</a></div><div id="ww14473" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww14446" title="Extension of Named Properties">Defining the Persistence and Copy Constructors</a></div><div id="ww14478" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww13167" title="Extension of Named Properties">Defining the write Member Function</a></div><div id="ww14483" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww13691" title="Extension of Named Properties">Providing an Entry Point to the Read and Copy Constructors</a></div><div id="ww14488" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww13717" title="Extension of Named Properties">Registering the Class</a></div><div id="ww14493" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/namedproperties.13.3.html#ww14168" title="Extension of Named Properties">Using the New Named Property</a></div><div id="ww12704" class="Heading3"><span></span>Declaring the Named Property: Header File </div><div id="ww13459" class="Body">The named property that we are going to create must be a subclass of <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvNamedProperty.html">IlvNamedProperty</a></span>. The named property stores an integer and a string. Its complete header file is given below: </div><div id="ww12705" class="NormalCode">#include &lt;ilviews/base/graphic.h&gt;</div><div id="ww12769" class="NormalCode">&nbsp;</div><div id="ww12770" class="NormalCode">class MyProperty</div><div id="ww12771" class="NormalCode">: public IlvNamedProperty</div><div id="ww12772" class="NormalCode">{</div><div id="ww12773" class="NormalCode">public:</div><div id="ww12774" class="NormalCode">    MyProperty(int   integer,</div><div id="ww12775" class="NormalCode">               char* string);</div><div id="ww12776" class="NormalCode">    virtual ~MyProperty();</div><div id="ww12777" class="NormalCode">&nbsp;</div><div id="ww12778" class="NormalCode">    int         getInteger() const      { return _integer; }</div><div id="ww12779" class="NormalCode">    void        setInteger(int integer) { _integer = integer; }</div><div id="ww12780" class="NormalCode">&nbsp;</div><div id="ww12781" class="NormalCode">    const char* getString()  const { return _string; }</div><div id="ww12782" class="NormalCode">    void        setString(const char* string);</div><div id="ww12783" class="NormalCode">&nbsp;</div><div id="ww12784" class="NormalCode">    static IlSymbol* GetSymbol();</div><div id="ww12785" class="NormalCode">&nbsp;</div><div id="ww12786" class="NormalCode">    DeclarePropertyInfo();</div><div id="ww12787" class="NormalCode">    DeclarePropertyIOConstructors(MyProperty);</div><div id="ww12788" class="NormalCode">&nbsp;</div><div id="ww12789" class="NormalCode">private:</div><div id="ww12790" class="NormalCode">    int   _integer;</div><div id="ww12791" class="NormalCode">    char* _string;</div><div id="ww12792" class="NormalCode">    static IlSymbol* _Symbol;</div><div id="ww12793" class="LastNormalCode">};</div><div id="ww13443" class="Body">In addition to the two data members <span class="code">_integer</span> and <span class="code">_string</span> (and their accessors), we will focus on the <span class="code">_Symbol</span> static data member and on the two macro calls that appear in the declaration part of the class, namely <span class="code">DeclarePropertyInfo</span> and <span class="code">DeclarePropertyIOConstructors</span>.</div><div id="ww12819" class="Body">Note that the destructor of the class is virtual like the one of the base class <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvNamedProperty.html">IlvNamedProperty</a></span>.</div><div id="ww14428" class="Heading3"><span></span>Defining the Symbol for Accessing the Named Property </div><div id="ww12820" class="Body">First we are going to define the property symbol that will be used to access the class. A simple way to define this symbol is to make it a static data member of your property class, <span class="code">_Symbol</span>, and provide it with a public accessor, <span class="code">GetSymbol</span>. By doing this, any application will be able to retrieve an instance of <span class="code">MyProperty</span> without having to know which symbol is used to associate it with an object. </div><div id="ww12826" class="Body">Therefore, the public and static accessor <span class="code">GetSymbol</span> is defined to return the appropriate <span class="code">IlSymbol</span> and create it if necessary. </div><div id="ww13499" class="Body">In the code below, an extract of the implementation file, we define both the accessor to the property symbol and the static data member, which we initialize to <span class="code">0</span>. Note that the symbol is created the first time it is queried in <span class="code">MyProperty::GetSymbol</span>. </div><div id="ww12854" class="NormalCode">IlSymbol*</div><div id="ww12864" class="NormalCode">MyProperty::GetSymbol()</div><div id="ww12865" class="NormalCode">{</div><div id="ww12866" class="NormalCode">    if (!_Symbol)</div><div id="ww12867" class="NormalCode">       _Symbol = IlGetSymbol("MyPropertySymbol");</div><div id="ww12868" class="NormalCode">    return _Symbol;</div><div id="ww12869" class="NormalCode">}</div><div id="ww12870" class="NormalCode">&nbsp;</div><div id="ww12871" class="LastNormalCode">IlSymbol* MyProperty::_Symbol = 0;</div><div id="ww12915" class="Heading3"><span></span>Defining the Constructor for the Named Property </div><div id="ww13513" class="Body">Let’s now examine the constructor and the destructor. All we need to do is call the constructor of the parent class, <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvNamedProperty.html">IlvNamedProperty</a></span>, and initialize our data members:</div><div id="ww12916" class="NormalCode">MyProperty::MyProperty(int   integer,</div><div id="ww12931" class="NormalCode">                       char* string)</div><div id="ww12932" class="NormalCode">: IlvNamedProperty(GetSymbol()),</div><div id="ww12933" class="NormalCode">  _integer(integer),</div><div id="ww12934" class="NormalCode">  _string(0)</div><div id="ww12935" class="NormalCode">{</div><div id="ww12936" class="NormalCode">    setString(string);</div><div id="ww12937" class="NormalCode">}</div><div id="ww13084" class="NormalCode">&nbsp;</div><div id="ww13077" class="NormalCode">MyProperty::~MyProperty()</div><div id="ww13079" class="NormalCode">{</div><div id="ww13080" class="NormalCode">    if (_string)</div><div id="ww13081" class="NormalCode">        delete [] _string;</div><div id="ww13082" class="LastNormalCode">}</div><div id="ww12997" class="Body">The first time a property of the <span class="code">MyProperty</span> type is created, the static member function <span class="code">GetSymbol</span> is called to set the static data member <span class="code">_Symbol</span> to a valid value.</div><div id="ww13000" class="Body">The <span class="code">string</span> parameter is copied by the <span class="code">setString</span> member function that will check whether the data member <span class="code">_string</span> is valid. This is why we initialize this data member to <span class="code">0</span> in the initializers of the constructor. This parameter is destroyed in the destructor, if it was valid.</div><div id="ww12947" class="Heading3"><span></span>Defining the setString Member Function </div><div id="ww13542" class="Body">Below is the definition of the <span class="code">setString</span> member function that copies and stores the string:</div><div id="ww12948" class="NormalCode">void</div><div id="ww12959" class="NormalCode">MyProperty::setString(const char* string)</div><div id="ww12960" class="NormalCode">{</div><div id="ww12961" class="NormalCode">    if (_string)</div><div id="ww12962" class="NormalCode">        delete [] _string;</div><div id="ww12963" class="NormalCode">    _string = string</div><div id="ww12971" class="NormalCode">                  ? strcpy(new char [strlen(string)+1], string)</div><div id="ww12974" class="NormalCode">                  : 0;</div><div id="ww12964" class="LastNormalCode">}</div><div id="ww12943" class="Body">This code is quite simple. If a valid string—a non-null string— was stored, it is destroyed. If the parameter is valid—non-null—a copy of this string is made and stored. If the parameter is not valid, the data member is simply reset to <span class="code">0</span>.</div><div id="ww168928" class="Body">At this stage, our class can store and retrieve both an integer and a character-string value.</div><div id="ww14446" class="Heading3"><span></span>Defining the Persistence and Copy Constructors </div><div id="ww13037" class="Body">For our named property to be complete, we have to add the class-level information and persistence-related member functions. The easiest way to do this is to use the following two macros in the body of the class declaration:</div><div id="ww13040" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">DeclarePropertyInfo</span>  declares the class information data members for the <span class="code">MyProperty</span> class. These members are used to retrieve information, such as the class name and its hierarchy. It also declares the member functions that are required to implement persistence for this class.</div><div id="ww13054" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">DeclarePropertyIOConstructors</span>  declares the constructors required for persistence and copy.</div><div id="ww13051" class="Body">These macros make it very easy to add copy and persistence functionality to your class.</div><div id="ww13648" class="Body">Once the macros have been declared, all we have to do to add copy and persistence features to our class is to define a copy constructor and a constructor that take an <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvInputFile.html">IlvInputFile</a></span> reference as its parameter:</div><div id="ww13064" class="NormalCode">MyProperty::MyProperty(const MyProperty&amp; source)</div><div id="ww13091" class="NormalCode">: IlvNamedProperty(GetSymbol()),</div><div id="ww13092" class="NormalCode">  _integer(source._integer),</div><div id="ww13093" class="NormalCode">  _string(0)</div><div id="ww13097" class="NormalCode">{</div><div id="ww13098" class="NormalCode">    setString(source._string);</div><div id="ww13102" class="NormalCode">}</div><div id="ww13071" class="NormalCode">&nbsp;</div><div id="ww13134" class="NormalCode">MyProperty::MyProperty(IlvInputFile&amp; i, IlSymbol* s)</div><div id="ww13135" class="NormalCode">: IlvNamedProperty(GetSymbol()),</div><div id="ww13136" class="NormalCode">  _integer(0),</div><div id="ww13137" class="NormalCode">  _string(0)</div><div id="ww13138" class="NormalCode">{</div><div id="ww13154" class="NormalCode">    // 's' should be equal to GetSymbol()</div><div id="ww13139" class="NormalCode">    i.getStream() &gt;&gt; _integer &gt;&gt; IlvQuotedString();</div><div id="ww13140" class="NormalCode">    setString(IlvQuotedString().Buffer);</div><div id="ww13038" class="LastNormalCode">}</div><div id="ww13603" class="Body">The first constructor initializes a new instance of <span class="code">MyProperty</span> with a copy of its source parameter.</div><div id="ww13161" class="Body">The second constructor reads the provided input stream to initialize its instance with what is read.</div><div id="ww13167" class="Heading3"><span></span>Defining the write Member Function </div><div id="ww13657" class="Body">Now that we are able to read a new instance of the class, we can save it. To do so, we have to define a <span class="code">write</span> member function, which is implicitly declared by the macro <span class="code">DeclarePropertyInfo</span>.</div><div id="ww13168" class="NormalCode">void</div><div id="ww13193" class="NormalCode">MyProperty::write(IlvOutputFile&amp; o) const</div><div id="ww13194" class="NormalCode">{</div><div id="ww13195" class="NormalCode">&nbsp;&nbsp;&nbsp;&nbsp;o.getStream() &lt;&lt; _integer &lt;&lt; IlvSpc() &lt;&lt; IlvQuotedString(_string);</div><div id="ww14005" class="LastNormalCode">}</div><div id="ww14006" class="Body">The saving order must be the same as the reading order.</div><div id="ww14007" class="Body">Note that you may define a named property that does not have any additional information to save. In this case, you would use the <span class="code">DeclarePropertyInfoRO</span> macro instead of <span class="code">DeclarePropertyInfo</span> in the class declaration and drop the <span class="code">write</span> member function that would be useless.</div><div id="ww13691" class="Heading3"><span></span>Providing an Entry Point to the Read and Copy Constructors </div><div id="ww14451" class="Body">To provide Rogue Wave&nbsp;Views with an entry point to the read and copy constructors, you must add another macro to the implementation file, outside the body of any function, as follows:</div><div id="ww13693" class="LastNormalCode">   <span style="font-family: &quot;Times New Roman&quot;; font-size: 10.0pt"> </span>IlvPredefinedPropertyIOMembers(MyProperty)</div><div id="ww13694" class="Body">Calling this macro actually creates a <span class="code">read</span> static member function that invokes the read constructor. It also defines a <span class="code">copy</span> member function that calls the copy constructor.</div><div id="ww13717" class="Heading3"><span></span>Registering the Class </div><div id="ww14449" class="Body">The final step to have our named property up and running in our application is to register the <span class="code">MyProperty</span> class with Rogue Wave&nbsp;Views as follows:</div><div id="ww13226" class="LastNormalCode">    <span style="font-family: &quot;Times New Roman&quot;; font-size: 10.0pt"> </span>IlvRegisterPropertyClass(MyProperty, IlvNamedProperty);</div><div id="ww13236" class="Body">Calling the macro <span class="code">IlvRegisterPropertyClass</span> registers the class <span class="code">MyProperty</span> with the Rogue Wave&nbsp;Views persistence mechanism.</div><div id="ww14168" class="Heading3"><span></span>Using the New Named Property </div><div id="ww14450" class="Body">You can now use this new named property as an extension of any graphic object with which it would be associated:</div><div id="ww14186" class="NormalCode">IlvGraphic* myObject = ...;</div><div id="ww14197" class="NormalCode">myObject-&gt;setNamedProperty(new MyProperty(12, "Some text"));</div><div id="ww14198" class="NormalCode">...</div><div id="ww14203" class="NormalCode">MyProperty* property =</div><div id="ww14206" class="NormalCode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MyProperty*)(myObject-&gt;getNamedProperty(MyProperty::GetSymbol());</div><div id="ww14207" class="NormalCode">if (property &amp;&amp; (property-&gt;getInteger() == someValue))</div><div id="ww14208" class="LastNormalCode">&nbsp;&nbsp;&nbsp;&nbsp;doSomething();</div><div id="ww14214" class="Body">You have extended your graphic object’s API in a persistent manner, without subclassing the base class.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>