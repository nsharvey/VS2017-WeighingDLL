<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Connection Pins</title><link rel="Prev" href="grapher.67.6.html" title="Previous" /><link rel="Next" href="grapher.67.8.html" title="Next" /><link rel="StyleSheet" href="css/grapher.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/grapher_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/UserManuals/grapher.67.7.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pCzad_002f7_002bliyMZw37yOmJxuw" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/UserManuals/grapher.67.7.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/twodgfrontcover.html#wwconnect_header">2D Graphics</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/twodgpart2.html#ww144909">Grapher</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/grapher.67.1.html#wwconnect_header">Features of the Grapher Package</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../UserManuals/grapher.67.3.html#wwconnect_header">Grapher Links</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Connection Pins</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww117265" class="Heading2"><span></span>Connection Pins</div><div id="ww127518" class="Body">Connection pins allow you to control the exact location of link end points on grapher nodes. When a link is attached to a connection pin, the connecting point stays the same, regardless of the relative position of its start and end nodes.</div><div id="ww130422" class="Body">The following items are described in this section:</div><div id="ww130423" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/grapher.67.7.html#ww127532" title="Connection Pins">Connection Pin Management Class</a></div><div id="ww130430" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/grapher.67.7.html#ww121763" title="Connection Pins">An All-Purpose IlvGrapherPin Subclass</a></div><div id="ww130441" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../UserManuals/grapher.67.7.html#ww121841" title="Connection Pins">Extending the IlvGrapherPin Class</a></div><div id="ww127532" class="Heading3"><span></span>Connection Pin Management Class</div><div id="ww121744" class="Body">The <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span> abstract class is designed to handle a collection of connection pins. Its first purpose is to maintain the association between links and pins. To do so, pins are referenced by indexes. You can connect a link to a given connection pin with the <span class="code">IlvGrapherPin::setPinIndex</span> method:</div><div id="ww121746" class="NormalCode">IlvLinkImage* link = …;</div><div id="ww121873" class="NormalCode">//== Recover the IlvGrapherPin instance associated with the starting node</div><div id="ww121747" class="NormalCode">IlvGrapherPin* pin  =  IlvGrapherPin::Get(link-&gt;getFrom());</div><div id="ww121874" class="NormalCode">//== Connect the link to the pin whose index is 0</div><div id="ww121748" class="LastNormalCode">pin-&gt;setPinIndex(link,0,IlTrue);</div><div id="ww121770" class="Body">Likewise, you can recover the index of the connection pin to which a link is attached, by using the <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span><span class="code">::getPinIndex</span> method.</div><div id="ww121753" class="Body">The second purpose of the <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span> class is to provide an interface to query the coordinates of the connecting points available for a given node. Each concrete subclass must provide an implementation for the <span class="MethodName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html#ad4f7722070bfb29e74f0704ad1d2fcc4">getCardinal</a></span> and <span class="MethodName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html#a69428feea174638dd77835c8a817a76a">getLocation</a></span> methods: </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; border-bottom-color: none; border-bottom-style: none; border-bottom-width: 0.0pt; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: none; border-top-style: none; border-top-width: 0.0pt; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww121785" class="CodeInTable">virtual IlUInt getCardinal(const IlvGraphic* node,</div><div id="ww121786" class="CodeInTable">                            const IlvTransformer* t) const;</div></td></tr></table></div><div id="ww121756" class="Body">This method returns the number of connection pins handled by the instance for the specified node <span class="code">node</span> when displayed with the transformer <span class="code">t</span>. </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; border-bottom-color: none; border-bottom-style: none; border-bottom-width: 0.0pt; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: none; border-top-style: none; border-top-width: 0.0pt; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww121804" class="CodeInTable">virtual IlBoolean getLocation(IlUInt pinIndex,</div><div id="ww121805" class="CodeInTable">                               const IlvGraphic* node,</div><div id="ww121806" class="CodeInTable">                               const IlvTransformer* t, </div><div id="ww121807" class="CodeInTable">                               IlvPoint&amp; where) const;</div></td></tr></table></div><div id="ww126614" class="Body">This method returns, in the <span class="code">where</span> parameter, the coordinates of the connection pin specified by the index <span class="code">pinIndex</span> on the node <span class="code">node</span>, when displayed with the transformer <span class="code">t.</span></div><div id="ww126619" class="Body">Other methods of this interface (<span class="MethodName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html#ad435265af32146030d9901f576a5336e">getClosest</a></span>, <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span><span class="code">::getLinkLocation</span>, and so on) have a default implementation that can be overloaded. For example, the <span class="code">getClosest</span> method considers all available connection pins and uses the <span class="code">getLocation</span> method. You can change this method to:</div><div id="ww121761" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>provide a faster implementation (<span class="code">getLocation</span> may contain computations that can be done only once in <span class="code">getClosest</span>),</div><div id="ww121762" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>return the first unused pin instead of the closest one in terms of distance.</div><div id="ww121763" class="Heading3"><span></span>An All-Purpose IlvGrapherPin Subclass</div><div id="ww121843" class="Body">The <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGenericPin.html">IlvGenericPin</a></span> class is a predefined concrete subclass of <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span> that makes it possible to dynamically define the connection pins on a node. New connection pins are specified by their desired location on the node when this node is displayed through a given transformer. Once this position is stored, the <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGenericPin.html">IlvGenericPin</a></span> class will use the shape of the object to accurately locate the connecting point regardless of the applied transformer.</div><div id="ww121856" class="Body">Here is an example of how to use this class to add connection pins on the four corners of a node bounding box:</div><div id="ww121846" class="NormalCode">IlvGraphic* node = ...;</div><div id="ww121926" class="NormalCode">//== Create an empty instance of IlvGenericPin</div><div id="ww121847" class="NormalCode">IlvGenericPin* pin = new IlvGenericPin();</div><div id="ww121848" class="NormalCode">//== Add the four connecting points</div><div id="ww121925" class="NormalCode">IlvRect bbox;</div><div id="ww121849" class="NormalCode">node-&gt;boundingBox(bbox,0);</div><div id="ww121902" class="NormalCode">pin-&gt;addPin(node,IlvPoint(bbox.x(),bbox.y()),0);</div><div id="ww121915" class="NormalCode">pin-&gt;addPin(node,IlvPoint(bbox.x()+bbox.w()-1,bbox.y()),0);</div><div id="ww121916" class="NormalCode">pin-&gt;addPin(node,IlvPoint(bbox.x()+bbox.w()-1,bbox.y()+bbox.h()-1),0);</div><div id="ww121917" class="NormalCode">pin-&gt;addPin(node,IlvPoint(bbox.x(),bbox.y()+bbox.h()-1),0);</div><div id="ww121897" class="NormalCode">//== Attach the IlvGenericPin instance to the node</div><div id="ww121924" class="LastNormalCode">pin-&gt;set(node);</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww127549" class="Note"><span class="flag">Note:&nbsp;</span>The points in this example are given in the object coordinate system when no transformer is applied.</div></td></tr></table></div><div id="ww121841" class="Heading3"><span></span>Extending the IlvGrapherPin Class</div><div id="ww121941" class="Body">An example of a concrete <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span> subclass that handles a single connection pin located at the center of a node bounding box is presented here. This class, called <span class="code">CenterPin</span>, is declared as follows:</div><div id="ww121969" class="NormalCode">#include &lt;ilviews/grapher/pin.h&gt;</div><div id="ww121974" class="NormalCode">&nbsp;</div><div id="ww121975" class="NormalCode">class CenterPin</div><div id="ww121947" class="NormalCode">: public IlvGrapherPin</div><div id="ww121948" class="NormalCode">{</div><div id="ww121949" class="NormalCode">public:</div><div id="ww121950" class="NormalCode">    CenterPin() {}</div><div id="ww121951" class="NormalCode">    </div><div id="ww121953" class="NormalCode">    virtual IlUInt getCardinal(const IlvGraphic*,</div><div id="ww121970" class="NormalCode">                                const IlvTransformer*) const;</div><div id="ww121955" class="NormalCode">    </div><div id="ww121973" class="NormalCode">    virtual IlBoolean getLocation(IlUInt, </div><div id="ww121956" class="NormalCode">                                   const IlvGraphic*,</div><div id="ww121957" class="NormalCode">                                   const IlvTransformer* t,</div><div id="ww121958" class="NormalCode">                                   IlvPoint&amp;) const;</div><div id="ww121959" class="NormalCode">    DeclarePropertyInfoRO();</div><div id="ww121960" class="NormalCode">    DeclarePropertyIOConstructors(CenterPin);</div><div id="ww121961" class="LastNormalCode">};</div><div id="ww121978" class="Body">The constructor of the <span class="code">CenterPin</span> class does nothing since this class does not store any information. The <span class="code">DeclarePropertyInfoRO</span> and <span class="code">DeclarePropertyIOConstructors</span> macros are used to make the <span class="code">CenterPin</span> class persistent. Only the <span class="code">getCardinal</span> and <span class="code">getLocation</span> methods are overloaded since the implementation of the other <span class="ClassName"><a href="../RefMan/refcppgrapher/classIlvGrapherPin.html">IlvGrapherPin</a></span> methods does not need to be changed. The source file for the <span class="code">CenterPin</span> class defines the following methods:</div><div id="ww121943" class="NormalCode">#include &lt;centerpin.h&gt;</div><div id="ww122101" class="NormalCode">&nbsp;</div><div id="ww117477" class="NormalCode">// -------------------------------------------------------------------------</div><div id="ww121995" class="NormalCode">// - IO Constructors</div><div id="ww122105" class="NormalCode">CenterPin::CenterPin(IlvInputFile&amp; input, IlvSymbol* s)</div><div id="ww122072" class="NormalCode">: IlvGrapherPin(input, s) {}</div><div id="ww122002" class="NormalCode">&nbsp;</div><div id="ww122083" class="NormalCode">CenterPin::CenterPin(const CenterPin&amp; src)</div><div id="ww122003" class="NormalCode">: IlvGrapherPin(src) {}</div><div id="ww122007" class="NormalCode">// -------------------------------------------------------------------------</div><div id="ww122009" class="NormalCode">IlUInt</div><div id="ww122010" class="NormalCode">CenterPin::getCardinal(const IlvGraphic*,</div><div id="ww122011" class="NormalCode">                       const IlvTransformer*) const</div><div id="ww122012" class="NormalCode">{</div><div id="ww122013" class="NormalCode">    return 1;</div><div id="ww122014" class="NormalCode">}</div><div id="ww122015" class="NormalCode">&nbsp;</div><div id="ww122086" class="NormalCode">// -------------------------------------------------------------------------</div><div id="ww122019" class="NormalCode">IlBoolean</div><div id="ww122020" class="NormalCode">CenterPin::getLocation(IlUInt,</div><div id="ww122021" class="NormalCode">                       const IlvGraphic* node,</div><div id="ww122022" class="NormalCode">                       const IlvTransformer* t,</div><div id="ww122023" class="NormalCode">                       IlvPoint&amp; where) const</div><div id="ww122024" class="NormalCode">{</div><div id="ww122026" class="NormalCode">    IlvRect bbox;</div><div id="ww122027" class="NormalCode">    node-&gt;boundingBox(bbox, t);</div><div id="ww122028" class="NormalCode">    where.move(bbox.centerx(), bbox.centery());</div><div id="ww122029" class="NormalCode">    return IlTrue;</div><div id="ww122030" class="NormalCode">}</div><div id="ww122031" class="NormalCode">&nbsp;</div><div id="ww122032" class="NormalCode">// -------------------------------------------------------------------------</div><div id="ww122043" class="NormalCode">// - Macros to register the class and make it persistent</div><div id="ww122650" class="NormalCode">IlvPredefinedPropertyIOMembers(CenterPin)</div><div id="ww124951" class="LastNormalCode">IlvRegisterPropertyClass(CenterPin, IlvGrapherPin);</div><div id="ww125247" class="Body">The implementation of the <span class="code">getCardinal</span> method is straightforward and returns 1 for any node and transformer. The <span class="code">getLocation</span> method simply queries the transformed bounding box of the node and returns its center. (The index of the connection pin is not used since this class defines only one connection pin.) The declaration of the <span class="code">CenterPin</span> class is provided in the file <span class="code">&lt;ILVHOME&gt;/samples/grapher/include/centerpin.h</span>. Its implementation can be found in the file <span class="code">&lt;ILVHOME&gt;/samples/grapher/src/centerpin.cpp</span>.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>