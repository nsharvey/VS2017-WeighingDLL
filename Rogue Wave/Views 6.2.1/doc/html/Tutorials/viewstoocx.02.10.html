<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Step 3: Adding Custom Properties to the ActiveX Control</title><link rel="Prev" href="viewstoocx.02.09.html" title="Previous" /><link rel="Next" href="viewstoocx.02.11.html" title="Next" /><link rel="StyleSheet" href="css/viewstoocx.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/viewstoocx_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Tutorials/viewstoocx.02.10.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pMUw9QtBNawMONUwnaxd82w" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Tutorials/viewstoocx.02.10.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/foundtutfrontcover.html#wwconnect_header">Views Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.01.html#wwconnect_header">Creating an ActiveX Control from Existing Rogue Wave&nbsp;Views Code</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.07.html#wwconnect_header">Creating an ActiveX Control with the MFC Library</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Step 3: Adding Custom Properties to the ActiveX Control</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww1002187" class="Heading2"><span></span>Step 3: Adding Custom Properties to the ActiveX Control</div><div id="ww1002188" class="Body">This step shows how to add a file name and a background color to the ActiveX control. The file name is that of the file read by the manager. By default, this file is <span class="code">data/browse.ilv</span>, which we included in the <span class="code">.rc</span> file in Step 2. The background color is that of the manager view.</div><div id="ww1007455" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002189" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the FileName property.</a></div><div id="ww1007460" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002197" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the Background property.</a></div><div id="ww1007465" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002204" title="Step 3: Adding Custom Properties to the ActiveX Control">Add new private member variables.</a></div><div id="ww1007470" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002208" title="Step 3: Adding Custom Properties to the ActiveX Control">Modify the CDemoMFCCtrl constructor.</a></div><div id="ww1007475" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002217" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the setFileName member function.</a></div><div id="ww1007480" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002240" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the setBackground member function.</a></div><div id="ww1007485" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002269" title="Step 3: Adding Custom Properties to the ActiveX Control">Modify the member functions generated by the wizard.</a></div><div id="ww1007490" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1002324" title="Step 3: Adding Custom Properties to the ActiveX Control">Modify the CDemoMFCCtrl::OnCreate member function.</a></div><div id="ww1007495" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.10.html#ww1012739" title="Step 3: Adding Custom Properties to the ActiveX Control">Test the properties.</a></div><div id="ww1002189" class="Heading4">Add the FileName property.</div><div id="ww1002190" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, expand <span class="code">DemoMFCLib</span> and click <span class="code">_DDemoMFC</span> with the right mouse button and select Add &gt; Add Property.</div><div id="ww1002191" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Enter <span class="code">FileName</span> in the Property Name field.</div><div id="ww1002775" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Select the “Get/Set methods” option.</div><div id="ww1002192" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Choose <span class="code">BSTR</span> from the Property Type drop-down list.</div><div id="ww1002193" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>Be sure the Parameters list is empty.</div><div id="ww1002197" class="Heading4">Add the Background property.</div><div id="ww1002198" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, expand <span class="code">DemoMFCLib</span> and click <span class="code">_DDemoMFC</span> with the right mouse button and select Add &gt; Add Property.</div><div id="ww1002199" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Enter <span class="code">Background</span> in the Property Name field.</div><div id="ww1002796" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Select the option “Get/Set methods”.</div><div id="ww1002200" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Choose <span class="code">OLE_COLOR</span> from the Property Type drop-down list.</div><div id="ww1002201" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>Leave the Parameters field empty.</div><div id="ww1002204" class="Heading4">Add new private member variables. </div><div id="ww1002205" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click <span class="code">CDemoMFCCtrl</span> with the right mouse button.</div><div id="ww1002206" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Choose Add &gt; Add Variable from the menu that appears.</div><div id="ww1004012" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Enter <span class="code">CString</span> in Variable Type and <span class="code">m_FileName</span> in Variable Name and click OK.</div><div id="ww1004018" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Choose Add &gt; Add Variable again.</div><div id="ww1002207" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>Enter <span class="code">OLE_COLOR </span>in Variable Type and name <span class="code">m_Background</span> in Variable Name and click OK.</div><div id="ww1002208" class="Heading4">Modify the CDemoMFCCtrl constructor. </div><div id="ww1002209" class="Body">In the file <span class="code">DemoMFCCtl.cpp</span>, modify the <span class="code">CDemoMFCCtrl</span> constructor as follows to initialize the member variables <span class="code">m_FileName</span> and <span class="code">m_Background</span>: </div><div id="ww1002816" class="NormalCode">CDemoMFCCtrl()</div><div id="ww1002817" class="NormalCode">// Added for Rogue Wave&nbsp;Views.</div><div id="ww1002818" class="NormalCode">: m_Ctrl(0), m_FileName(), m_Background(-1)</div><div id="ww1002819" class="NormalCode">// End Added for Rogue Wave&nbsp;Views.</div><div id="ww1002820" class="NormalCode">{</div><div id="ww1002821" class="NormalCode">        InitializeIIDs(&amp;IID_DDemoMFC, &amp;IID_DDemoMFCEvents);</div><div id="ww1002822" class="NormalCode">&nbsp;</div><div id="ww1002823" class="NormalCode">        // TODO: Initialize your control’s instance data here.</div><div id="ww1002814" class="LastNormalCode">}</div><div id="ww1002217" class="Heading4">Add the setFileName member function. </div><div id="ww1002218" class="Body">This member function must be added to the <span class="code">DemoCtrl</span> class. It has one parameter of type <span class="code">const char*</span> that represents the new file name. Its purpose is to load the corresponding file. </div><div id="ww1002219" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add the declaration of <span class="code">DemoCtrl::setFileName</span> to the file <span class="code">DemoCtrl.h</span>: </div><div id="ww1002220" class="IndentedL1"><span class="code">void setFileName(const char*);</span></div><div id="ww1002221" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add the definition <span class="code">DemoCtrl::setFileName</span> to the file <span class="code">DemoCtrl.cpp</span>: </div><div id="ww1002853" class="NormalCodeL1">void</div><div id="ww1002854" class="NormalCodeL1">DemoCtrl::setFileName(const char* filename)</div><div id="ww1002855" class="NormalCodeL1">{</div><div id="ww1002856" class="NormalCodeL1">    if (!filename || !*filename)</div><div id="ww1002857" class="NormalCodeL1">        return;</div><div id="ww1002858" class="NormalCodeL1">    IlvManager* manager = getManager();</div><div id="ww1002859" class="NormalCodeL1">    if (!manager)</div><div id="ww1002860" class="NormalCodeL1">        return;</div><div id="ww1002861" class="NormalCodeL1">    manager-&gt;initReDraws();</div><div id="ww1002862" class="NormalCodeL1">    manager-&gt;deleteAll(IlvTrue, IlvFalse);</div><div id="ww1002863" class="NormalCodeL1">    manager-&gt;read(filename);</div><div id="ww1002864" class="NormalCodeL1">    manager-&gt;fitTransformerToContents(getManagerView());</div><div id="ww1002865" class="NormalCodeL1">    manager-&gt;reDrawViews();</div><div id="ww1002239" class="LastNormalCodeL1">}</div><div id="ww1002240" class="Heading4">Add the setBackground member function.</div><div id="ww1002241" class="Body">This member function must be added to the <span class="code">DemoCtrl</span> class. It has one parameter of type <span class="code">OLE_COLOR</span> that represents the new color. Its purpose is to convert the <span class="code">OLE_COLOR</span> into an <span class="code">IlvColor*</span> that Rogue Wave&nbsp;Views can interpret and to redraw the view. </div><div id="ww1002242" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add the declaration of <span class="code">DemoCtrl::setBackground</span> to the file <span class="code">DemoCtrl.h</span>: </div><div id="ww1002243" class="IndentedL1"><span class="code">void setBackground(OLE_COLOR);</span></div><div id="ww1002244" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add the definition of <span class="code">DemoCtrl::setBackground</span> to the file <span class="code">DemoCtrl.cpp</span>: </div><div id="ww1002878" class="NormalCodeL1">void</div><div id="ww1002879" class="NormalCodeL1">DemoCtrl::setBackground(OLE_COLOR oleColor)</div><div id="ww1002880" class="NormalCodeL1">{</div><div id="ww1002881" class="NormalCodeL1">     if (oleColor == -1)</div><div id="ww1002882" class="NormalCodeL1">         return;</div><div id="ww1002883" class="NormalCodeL1">     IlvManager* manager = getManager();</div><div id="ww1002884" class="NormalCodeL1">     if (!manager)</div><div id="ww1002885" class="NormalCodeL1">         return;</div><div id="ww1002886" class="NormalCodeL1">     COLORREF colRef;</div><div id="ww1002887" class="NormalCodeL1">     HPALETTE hPal = NULL;</div><div id="ww1002888" class="NormalCodeL1">     if (getDisplay()-&gt;screenDepth() &lt;= 8)</div><div id="ww1002891" class="NormalCodeL1">          hPal = HPALETTE(getDisplay()-&gt;getPaletteHandle());</div><div id="ww1002892" class="NormalCodeL1">     if (S_OK != OleTranslateColor(oleColor, hPal, &amp;colRef))</div><div id="ww1002893" class="NormalCodeL1">         return;</div><div id="ww1002894" class="NormalCodeL1">     IlvIntensity red, blue, green;</div><div id="ww1002895" class="NormalCodeL1">     getDisplay()-&gt;pixelToRGB((unsigned long)(colRef), red, blue, green);</div><div id="ww1002896" class="NormalCodeL1">     IlvColor* color = getDisplay()-&gt;getColor(red, blue, green);</div><div id="ww1002897" class="NormalCodeL1">     manager-&gt;initReDraws();</div><div id="ww1002898" class="NormalCodeL1">     manager-&gt;setBackground(getManagerView(), color);</div><div id="ww1002899" class="NormalCodeL1">     manager-&gt;reDraw();</div><div id="ww1002900" class="NormalCodeL1">     manager-&gt;reDrawViews();</div><div id="ww1002268" class="LastNormalCodeL1">}</div><div id="ww1002269" class="Heading4">Modify the member functions generated by the wizard.</div><div id="ww1002965" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Modify the member functions <span class="code">CDemoMFCCtrl::SetFileName</span> and <span class="code">CDemoMFCCtrl::GetFileName</span> generated by the wizard in the file <span class="code">DemoMFCCtl.cpp</span> as follows: </div><div id="ww1012601" class="NormalCodeL1">BSTR CDemoMFCCtrl::GetFileName()</div><div id="ww1012602" class="NormalCodeL1">{</div><div id="ww1012603" class="NormalCodeL1">   AFX_MANAGE_STATE(AfxGetStaticModuleState());</div><div id="ww1012604" class="NormalCodeL1">   CString strResult;</div><div id="ww1012605" class="NormalCodeL1">   // TODO: Add your property handler here</div><div id="ww1012606" class="NormalCodeL1">   strResult = m_FileName;</div><div id="ww1012607" class="NormalCodeL1"><span style="color: #0000ff">   </span>return<span style="color: #0000ff"> </span>strResult.AllocSysString();</div><div id="ww1003035" class="NormalCodeL1">}</div><div id="ww1012617" class="NormalCodeL1">void CDemoMFCCtrl::SetFileName(LPCTSTR lpszNewValue)</div><div id="ww1012618" class="NormalCodeL1">{</div><div id="ww1012619" class="NormalCodeL1">   AFX_MANAGE_STATE(AfxGetStaticModuleState());</div><div id="ww1012620" class="NormalCodeL1">   // TODO: Add your property handler here</div><div id="ww1012621" class="NormalCodeL1">   // Added for Rogue Wave Views.</div><div id="ww1012622" class="NormalCodeL1">   if (!lpszNewValue || !*lpszNewValue)</div><div id="ww1012623" class="NormalCodeL1">   return;</div><div id="ww1012624" class="NormalCodeL1">   if (m_FileName != lpszNewValue) {</div><div id="ww1012625" class="NormalCodeL1">   m_FileName = lpszNewValue;</div><div id="ww1012626" class="NormalCodeL1">   if (m_Ctrl &amp;&amp; m_FileName.GetLength())</div><div id="ww1012627" class="NormalCodeL1">   m_Ctrl-&gt;setFileName(lpszNewValue);</div><div id="ww1012628" class="NormalCodeL1">   }</div><div id="ww1012629" class="NormalCodeL1">   // End Added for Rogue Wave Views.</div><div id="ww1012630" class="NormalCodeL1">   SetModifiedFlag();</div><div id="ww1012615" class="NormalCodeL1">}</div><div id="ww1003026" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Modify the member functions <span class="code">CDemoMFCCtrl::SetBackground</span> and <span class="code">CDemoMFCCtrl::GetBackground</span> generated by the wizard in the file <span class="code">DemoMFCCtl.cpp</span>: </div><div id="ww1012654" class="NormalCodeL1">OLE_COLOR CDemoMFCCtrl::GetBackground()</div><div id="ww1012655" class="NormalCodeL1">{</div><div id="ww1012668" class="NormalCodeL1">    <span style="font-size: 9.0pt">AFX_MANAGE_STATE(AfxGetStaticModuleState());</span></div><div id="ww1012669" class="NormalCodeL1">    // TODO: Add your dispatch handler code here</div><div id="ww1012656" class="NormalCodeL1"><span style="color: #0000ff">    </span>return<span style="color: #0000ff"> </span>m_Background;</div><div id="ww1003053" class="NormalCodeL1">}</div><div id="ww1012661" class="NormalCodeL1">&nbsp;</div><div id="ww1012662" class="NormalCodeL1">void CDemoMFCCtrl::SetBackground(OLE_COLOR nNewValue)</div><div id="ww1003054" class="NormalCodeL1">{</div><div id="ww1012677" class="NormalCodeL1">    <span style="font-size: 9.0pt">AFX_MANAGE_STATE(AfxGetStaticModuleState());</span></div><div id="ww1012678" class="NormalCodeL1">    // TODO: Add your property handler code here</div><div id="ww1012679" class="NormalCodeL1"><span style="color: #0000ff">    </span>if<span style="color: #0000ff"> </span>(m_Background != nNewValue) {</div><div id="ww1012680" class="NormalCodeL1">      m_Background = nNewValue;</div><div id="ww1012681" class="NormalCodeL1"><span style="color: #0000ff">      </span>if<span style="color: #0000ff"> </span>(m_Ctrl &amp;&amp; (m_Background != -1))</div><div id="ww1012682" class="NormalCodeL1">          m_Ctrl-&gt;setBackground(m_Background);</div><div id="ww1012683" class="NormalCodeL1">    }</div><div id="ww1003055" class="NormalCodeL1">    SetModifiedFlag();</div><div id="ww1012690" class="LastNormalCodeL1">}</div><div id="ww1002324" class="Heading4">Modify the CDemoMFCCtrl::OnCreate member function.</div><div id="ww1002325" class="Body">Modify the member function <span class="code">CDemoMFCCtrl::OnCreate</span> in the file <span class="code">DemoMFCCtl.cpp</span> to set the file name and/or the background color when the corresponding properties are defined: </div><div id="ww1012705" class="NormalCodeL1">int CDemoMFCCtrl::OnCreate(LPCREATESTRUCT lpCreateStruct)</div><div id="ww1012706" class="NormalCodeL1">{</div><div id="ww1012707" class="NormalCodeL1">    if (COleControl::OnCreate(lpCreateStruct) == -1)</div><div id="ww1012708" class="NormalCodeL1">      return -1;</div><div id="ww1012709" class="NormalCodeL1">    // TODO: Add your specialized creation code here</div><div id="ww1012710" class="NormalCodeL1">    // Added for Views.</div><div id="ww1012711" class="NormalCodeL1">    try {</div><div id="ww1012712" class="NormalCodeL1">     m_Ctrl = new DemoCtrl(m_hWnd);</div><div id="ww1012713" class="NormalCodeL1">     // Added for the FileName property.</div><div id="ww1012714" class="NormalCodeL1">     m_Ctrl-&gt;setFileName(m_FileName);</div><div id="ww1012715" class="NormalCodeL1">     // Added for the Background property.</div><div id="ww1012716" class="NormalCodeL1">     m_Ctrl-&gt;setBackground(m_Background);</div><div id="ww1012738" class="NormalCodeL1">&nbsp;</div><div id="ww1012717" class="NormalCodeL1">    } catch (...) {</div><div id="ww1012718" class="NormalCodeL1">      if (m_Ctrl) {</div><div id="ww1012719" class="NormalCodeL1">         delete m_Ctrl;</div><div id="ww1012720" class="NormalCodeL1">         m_Ctrl = 0;</div><div id="ww1012721" class="NormalCodeL1">      }</div><div id="ww1012722" class="NormalCodeL1">    }</div><div id="ww1012723" class="NormalCodeL1">    // End Added for Views.</div><div id="ww1012724" class="NormalCodeL1">    return 0;</div><div id="ww1002344" class="LastNormalCodeL1">}</div><div id="ww1012741" class="Heading4">Modify the project settings.</div><div id="ww1012742" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Open the project property pages.</div><div id="ww1002345" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>In the Project Settings dialog box, select All Configurations and click the General tab.</div><div id="ww1012762" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>For <span class="code">Character Set</span>, select <span class="code">use Multi-byte Character Set</span>.</div><div id="ww1012739" class="Heading4">Test the properties.</div><div id="ww1002347" class="Body">With Internet Explorer, you can modify the file <span class="code">test.htm</span> and use the JavaScript language. To test the <span class="code">FileName</span> property, we use a combo box that has three predefined choices.</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1013370" class="Note"><span class="flag">Note:&nbsp;</span>This example assumes that the Rogue Wave Views data files are</div><div id="ww1013363" class="Note"><span class="flag">Note:&nbsp;</span>installed the ILVHOME or ILVPATH environment variable path.</div></td></tr></table></div><div id="ww1013379" class="NormalCode">&lt;HTML&gt;</div><div id="ww1013380" class="NormalCode">&lt;HEAD&gt;</div><div id="ww1013381" class="NormalCode">&lt;TITLE&gt;Test page for object DemoMFCCtl&lt;/TITLE&gt;</div><div id="ww1013382" class="NormalCode">&lt;/HEAD&gt;</div><div id="ww1013392" class="NormalCode">&nbsp;</div><div id="ww1013383" class="NormalCode">&lt;SCRIPT LANGUAGE = JavaScript&gt;</div><div id="ww1013393" class="NormalCode">&nbsp;</div><div id="ww1013384" class="NormalCode">function load(value)</div><div id="ww1013385" class="NormalCode">{</div><div id="ww1013386" class="NormalCode">     DemoMFCCtrl.FileName = value;</div><div id="ww1013387" class="NormalCode">}</div><div id="ww1013394" class="NormalCode">&nbsp;</div><div id="ww1013388" class="NormalCode">&lt;/SCRIPT&gt;</div><div id="ww1012785" class="NormalCode">&lt;BODY&gt;</div><div id="ww1013395" class="NormalCode">&nbsp;</div><div id="ww1013377" class="NormalCode">&lt;SELECT NAME=Files onchange = "load(value)" &gt;</div><div id="ww1012786" class="NormalCode">&lt;OPTION Selected Value="data/browse.ilv"&gt;World</div><div id="ww1012787" class="NormalCode">&lt;OPTION Value="europe.ilv"&gt; Europe</div><div id="ww1012788" class="NormalCode">&lt;OPTION Value="africa.ilv"&gt; Africa</div><div id="ww1002381" class="NormalCode">&lt;/SELECT&gt;</div><div id="ww1013401" class="NormalCode">&lt;P&gt;</div><div id="ww1013413" class="NormalCode">&nbsp;</div><div id="ww1013402" class="NormalCode">&lt;OBJECT WIDTH=400 HEIGHT=400 ID="DemoMFCCtrl"</div><div id="ww1013403" class="NormalCode">CLASSID="CLSID:3D31E7B8-400B-</div><div id="ww1013404" class="NormalCode">11D3-B74F-00C04F68A89D"&gt;&lt;/OBJECT&gt;</div><div id="ww1013405" class="NormalCode">&lt;/BODY&gt;</div><div id="ww1013399" class="LastNormalCode">&lt;/HTML&gt;</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1013426" class="Note"><span class="flag">Note:&nbsp;</span>Since the class id is generated, the class id in your file may be different from the one in this example.</div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>