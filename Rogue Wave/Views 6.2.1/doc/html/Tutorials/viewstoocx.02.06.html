<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Step 4: Adding a Custom Event to The ActiveX Control</title><link rel="Prev" href="viewstoocx.02.05.html" title="Previous" /><link rel="Next" href="viewstoocx.02.07.html" title="Next" /><link rel="StyleSheet" href="css/viewstoocx.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/viewstoocx_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Tutorials/viewstoocx.02.06.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pNnba4WaMQK5Ls_002bBDXQzICw" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Tutorials/viewstoocx.02.06.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/foundtutfrontcover.html#wwconnect_header">Views Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.01.html#wwconnect_header">Creating an ActiveX Control from Existing Rogue Wave&nbsp;Views Code</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.02.html#wwconnect_header">Creating an ActiveX Control with the ATL Library</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Step 4: Adding a Custom Event to The ActiveX Control</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww998794" class="Heading2"><span></span>Step 4: Adding a Custom Event to The ActiveX Control</div><div id="ww1001136" class="Body">This step demonstrates how to add a custom event (<span class="code">PointerPosition</span>) to the ActiveX control. Each time the user moves the mouse pointer, the member function <span class="code">handleEvent</span> of the view interactor will fire this event and send it to the container. This event has three parameters: </div><div id="ww1001169" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>A <span class="code">BSTR</span> parameter, which represents the name of the object underneath the mouse, if any.</div><div id="ww998800" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><span class="code">OLE_XPOS_PIXELS</span> and <span class="code">OLE_YPOS_PIXELS</span> parameters, which represent the position of the mouse relative to the <span class="code">IlvManagerView</span>. </div><div id="ww1007347" class="Body">You are going to:</div><div id="ww1007348" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww1001205" title="Step 4: Adding a Custom Event to The ActiveX Control">Define the new custom event.</a></div><div id="ww1007353" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww998807" title="Step 4: Adding a Custom Event to The ActiveX Control">Compile the file DemoATL.idl or rebuild your project.</a></div><div id="ww1007358" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww998808" title="Step 4: Adding a Custom Event to The ActiveX Control">Implement a connection point interface.</a></div><div id="ww1007363" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww1001277" title="Step 4: Adding a Custom Event to The ActiveX Control">Check the parameter of the CONNECTION_POINT_ENTRY macro.</a></div><div id="ww1007368" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww998814" title="Step 4: Adding a Custom Event to The ActiveX Control">Modify the constructor of the class DemoCtrl.</a></div><div id="ww1007373" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww1001334" title="Step 4: Adding a Custom Event to The ActiveX Control">Modify the member function CDemoATLCtrl::onCreate.</a></div><div id="ww1007378" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww1003884" title="Step 4: Adding a Custom Event to The ActiveX Control">Define the class TrackInteractor.</a></div><div id="ww1007383" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww1013154" title="Step 4: Adding a Custom Event to The ActiveX Control">Add the private m_Inter variable to the DemoCtrl class.</a></div><div id="ww1007388" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww998859" title="Step 4: Adding a Custom Event to The ActiveX Control">Initialize the m_Inter to the DemoCtrl constructor and attach it to the view through the manager.</a></div><div id="ww1007397" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww998869" title="Step 4: Adding a Custom Event to The ActiveX Control">Modify the destructor to delete the interactor stored in m_Inter.</a></div><div id="ww1007401" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.06.html#ww998881" title="Step 4: Adding a Custom Event to The ActiveX Control">Test the properties.</a></div><div id="ww1001205" class="Heading4">Define the new custom event. </div><div id="ww1013011" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click the <span class="code">DemoATLLib</span> to expand its content and then click the <span class="code">_IDemoATLCtrlEvents</span> interface with the right mouse button. </div><div id="ww1001224" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Choose Add &gt; Add Function from the menu that appears. </div><div id="ww1001233" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>In the dialog box, enter the following values: <span class="code">HRESULT</span> as the Return Type, <span class="code">PointerPosition</span> as the Method Name, and <span class="code">BSTR name</span>, <span class="code">OLE_XPOS_PIXELS x</span>, <span class="code">OLE_YPOS_PIXELS y</span> as the parameters. </div><div id="ww998807" class="Heading4">Compile the file DemoATL.idl or rebuild your project. </div><div id="ww998808" class="Heading4">Implement a connection point interface.</div><div id="ww998809" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click the class <span class="code">CDemoATLCtrl </span>with the right mouse button.</div><div id="ww1001267" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Choose Add &gt; Add Connection Point from the menu that appears.</div><div id="ww998810" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>In the <span class="code">Implement connection points</span>, select the <span class="code">_IDemoATLCtrlEvents</span> interface and click OK. </div><div id="ww1001277" class="Heading4">Check the parameter of the CONNECTION_POINT_ENTRY macro.</div><div id="ww1001278" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Open <span class="code">DemoATLCtrl.h</span> and replace the 2 occurrences of __<span class="code">uuidof(_IDemoATLCtrlEvents)</span> </div><div id="ww1013052" class="IndentedL1">by</div><div id="ww1013056" class="IndentedL1" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 3.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">DIID__IDemoATLCtrlEvents</span></div><div id="ww1013072" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>In the ClassView tab of the Project Workspace window, click the class <span class="code">Cproxy_IDemoATLCtrlEvents&lt;T&gt;</span> with the right mouse button.</div><div id="ww1013091" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Choose <span class="code">Go To Definition</span> from the menu that appears.</div><div id="ww1013107" class="IndentedL1">The <span class="code">_DemoATLCtrlEvents_CP.h</span> file gets open.</div><div id="ww1013100" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Replace</div><div id="ww1013126" class="IndentedL1" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 3.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">&amp;__uuidof(_IDemoATLCtrlEvents)</span></div><div id="ww1013127" class="IndentedL1">by</div><div id="ww1013121" class="IndentedL1" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 3.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">&amp;DIID__IDemoATLCtrlEvents</span></div><div id="ww998814" class="Heading4">Modify the constructor of the class DemoCtrl. </div><div id="ww1001295" class="Body">Modify this constructor so that it accepts a reference to the class <span class="code">CDemoATLCtrl</span> as its second parameter. Add a forward declaration for the class <span class="code">CDemoATLCtrl</span> to the file <span class="code">DemoCtrl.h</span> and include the files <span class="code">stdafx.h</span> and <span class="code">DemoATLCtrl.h</span> into the file <span class="code">DemoCtrl.cpp</span>. </div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1001319" class="Note"><span class="flag">Note:&nbsp;</span>You must include these files before the Rogue Wave&nbsp;Views header files because, although both Rogue Wave&nbsp;Views and the ATL force the definition of the <span class="code">STRICT</span> macro, ATL does not check whether the macro is already defined.</div></td></tr></table></div><div id="ww1001334" class="Heading4">Modify the member function CDemoATLCtrl::onCreate.</div><div id="ww1001337" class="Body">In the member function <span class="code">CDemoATLCtrl::OnCreate</span> (file<span class="code"> DemoATLCtrl.h</span>), add <span class="code">*this</span> as the second parameter to the call to the <span class="code">DemoCtrl</span> constructor.</div><div id="ww1003884" class="Heading4">Define the class TrackInteractor.</div><div id="ww998823" class="Body">In the file <span class="code">DemoCtrl.cpp</span>, define a new class <span class="code">TrackInteractor</span> deriving from <span class="code">IlvViewManagerInteractor</span>: </div><div id="ww998826" class="NormalCode">class TrackInteractor : public IlvManagerViewInteractor</div><div id="ww998827" class="NormalCode">    {</div><div id="ww998828" class="NormalCode">    public:</div><div id="ww998829" class="NormalCode">        TrackInteractor(IlvManager* m, IlvView* v, CDemoATLCtrl&amp; ATLCtrl)</div><div id="ww998830" class="NormalCode">        : IlvManagerViewInteractor(m, v), m_ATLCtrl(ATLCtrl)</div><div id="ww998831" class="NormalCode">        {</div><div id="ww998832" class="NormalCode">        }</div><div id="ww998833" class="NormalCode">        ~TrackInteractor() {}</div><div id="ww1013856" class="NormalCode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IlBoolean handleEvent(IlvEvent&amp; event)</div><div id="ww1013857" class="NormalCode">        {</div><div id="ww1013858" class="NormalCode">            IlBoolean consumed = ilFalse;</div><div id="ww1013859" class="NormalCode">            if (event.getType() == IlvPointerMoved) {</div><div id="ww1013860" class="NormalCode">                consumed = IlTrue;</div><div id="ww1013861" class="NormalCode">                IlvGraphic* obj =</div><div id="ww1013862" class="NormalCode">                    getManager()-&gt;lastContains(IlvPoint(event.x(), event.y()), </div><div id="ww1013863" class="NormalCode">                                               getView());</div><div id="ww1013864" class="NormalCode">                CComBSTR bstrName("");</div><div id="ww1013865" class="NormalCode">                if (obj) {</div><div id="ww1013866" class="NormalCode">                    const char* name = getManager()-&gt;getObjectName(obj);</div><div id="ww1013867" class="NormalCode">                    bstrName = name;</div><div id="ww1013868" class="NormalCode">                }</div><div id="ww1013869" class="NormalCode">                m_ATLCtrl.Fire_PointerPosition(bstrName.Detach(),</div><div id="ww1013870" class="NormalCode">                                               OLE_XPOS_PIXELS(event.x()),</div><div id="ww1013871" class="NormalCode">                                               OLE_XPOS_PIXELS(event.y()));</div><div id="ww1013872" class="NormalCode">            }</div><div id="ww1013873" class="NormalCode">            if (!getManager()-&gt;dispatchToObjects(event, getView())) {</div><div id="ww1013874" class="NormalCode">                consumed |= getManager()-&gt;shortCut(event, getView());</div><div id="ww1013875" class="NormalCode">            } else {</div><div id="ww1013876" class="NormalCode">                consumed = IlTrue;</div><div id="ww1013877" class="NormalCode">            }</div><div id="ww1013878" class="NormalCode">            return consumed;</div><div id="ww998834" class="NormalCode">        }</div><div id="ww998852" class="NormalCode">private:</div><div id="ww998853" class="NormalCode">    CDemoATLCtrl&amp; m_ATLCtrl;</div><div id="ww998854" class="LastNormalCode">};</div><div id="ww1003893" class="Heading4">Implement the Fire_PointerPosition function.</div><div id="ww1013171" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click the class <span class="code">Cproxy_IDemoATLCtrlEvents&lt;T&gt;</span> with the right mouse button.</div><div id="ww1013173" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add the <span class="code">Fire_PointerPosition</span> public function to the <span class="code">Cproxy_IDemoATLCtrlEvents</span> class.</div><div id="ww1013207" class="NormalCodeL1">HRESULT Fire_PointerPosition(BSTR name, OLE_XPOS_PIXELS x, OLE_YPOS_PIXELS       y)</div><div id="ww1013209" class="NormalCodeL1">    {</div><div id="ww1013210" class="NormalCodeL1">            CComVariant varResult;</div><div id="ww1013211" class="NormalCodeL1">            T* pT = static_cast&lt;T*&gt;(this);</div><div id="ww1013212" class="NormalCodeL1"><span style="color: #0000ff">            </span>int<span style="color: #0000ff"> </span>nConnectionIndex;</div><div id="ww1013213" class="NormalCodeL1">            CComVariant* pvars = new<span style="color: #0000ff"> </span>CComVariant[3];</div><div id="ww1013214" class="NormalCodeL1"><span style="color: #0000ff">            </span>int<span style="color: #0000ff"> </span>nConnections = m_vec.GetSize();</div><div id="ww1013257" class="NormalCodeL1">&nbsp;</div><div id="ww1013215" class="NormalCodeL1"><span style="color: #0000ff">            </span>for<span style="color: #0000ff"> </span>(nConnectionIndex = 0; nConnectionIndex &lt; nConnections;</div><div id="ww1013706" class="NormalCodeL1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nConnectionIndex++)</div><div id="ww1013217" class="NormalCodeL1">            {</div><div id="ww1013218" class="NormalCodeL1">                    pT-&gt;Lock();</div><div id="ww1013219" class="NormalCodeL1">                    CComPtr&lt;IUnknown&gt; sp =</div><div id="ww1013220" class="NormalCodeL1">                                      m_vec.GetAt(nConnectionIndex);</div><div id="ww1013221" class="NormalCodeL1">                   pT-&gt;Unlock();</div><div id="ww1013222" class="NormalCodeL1">                   IDispatch* pDispatch =</div><div id="ww1013223" class="NormalCodeL1"><span style="color: #0000ff">                              </span>reinterpret_cast&lt;IDispatch*&gt;(sp.p);</div><div id="ww1013224" class="NormalCodeL1"><span style="color: #0000ff">                   </span>if<span style="color: #0000ff"> </span>(pDispatch != NULL)</div><div id="ww1013225" class="NormalCodeL1">                   {</div><div id="ww1013226" class="NormalCodeL1">                        VariantClear(&amp;varResult);</div><div id="ww1013227" class="NormalCodeL1">                        pvars[2] = name;</div><div id="ww1013228" class="NormalCodeL1">                        pvars[1] = x;</div><div id="ww1013229" class="NormalCodeL1">                        pvars[0] = y;</div><div id="ww1013230" class="NormalCodeL1">                        DISPPARAMS disp = { pvars, NULL, 3, 0 };</div><div id="ww1013232" class="NormalCodeL1">                        pDispatch-&gt;Invoke(0x1, IID_NULL,</div><div id="ww1013713" class="NormalCodeL1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCALE_USER_DEFAULT, DISPATCH_METHOD, &amp;disp,</div><div id="ww1013720" class="NormalCodeL1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;varResult, NULL, NULL);</div><div id="ww1013202" class="NormalCodeL1">                   }</div><div id="ww1013243" class="NormalCodeL1">            }</div><div id="ww1013244" class="NormalCodeL1"><span style="color: #0000ff">            </span>delete[] pvars;</div><div id="ww1013245" class="NormalCodeL1"><span style="color: #0000ff">            </span>return<span style="color: #0000ff"> </span>varResult.scode;</div><div id="ww1013241" class="LastNormalCodeL1">    }</div><div id="ww1013154" class="Heading4">Add the private m_Inter variable to the DemoCtrl class.</div><div id="ww998856" class="Body">The <span class="code">m_Inter</span> variable must be of the type <span class="code">TrackInteractor*</span>.</div><div id="ww998857" class="Body">To add this variable you can use the wizard as explained in <span class="Emphasis" style="font-style: italic"><a href="../Tutorials/viewstoocx.02.05.html#ww998570" title="Step 3: Adding Custom Properties to the ActiveX Control">Step 3: Adding Custom Properties to the ActiveX Control</a></span>. Do not forget to include a forward declaration for the <span class="code">TrackInteractor</span> class in the <span class="code">DemoCtrl.h</span> file. </div><div id="ww998859" class="Heading4">Initialize the m_Inter to the DemoCtrl constructor and attach it to the view through the manager. </div><div id="ww998862" class="NormalCode">DemoCtrl::DemoCtrl(HWND hWnd, CDemoATLCtrl&amp; ATLCtrl)</div><div id="ww998863" class="NormalCode">: Ctrl(_Display, reinterpret_cast&lt;IlvSystemView&gt;(hWnd)), m_Inter(0)</div><div id="ww998864" class="NormalCode">{</div><div id="ww998865" class="NormalCode">    m_Inter = new TrackInteractor(getManager(), getManagerView(), ATLCtrl);</div><div id="ww998866" class="NormalCode">    getManager()-&gt;setInteractor(m_Inter, getManagerView());</div><div id="ww998867" class="LastNormalCode">}</div><div id="ww998869" class="Heading4">Modify the destructor to delete the interactor stored in m_Inter.</div><div id="ww998871" class="NormalCode">DemoCtrl::~DemoCtrl()</div><div id="ww998872" class="NormalCode">{</div><div id="ww998873" class="NormalCode">    if (m_Inter) {</div><div id="ww998874" class="NormalCode">        getManager()-&gt;setInteractor(0, getManagerView());</div><div id="ww998875" class="NormalCode">        delete m_Inter;</div><div id="ww998876" class="NormalCode">         m_Inter = 0;</div><div id="ww998877" class="NormalCode">    }</div><div id="ww998878" class="NormalCode">&nbsp;</div><div id="ww998879" class="LastNormalCode">}</div><div id="ww998881" class="Heading4">Test the properties. </div><div id="ww1001433" class="Body">To test the properties, you can use Internet Explorer. With Internet Explorer, you can modify the file <span class="code">DemoATLCtrl.html</span> to use the VBScript language.</div><div id="ww998883" class="Body">The function <span class="code">DemoATLCtrl_PointerPosition</span> is called each time a <span class="code">PointerPosition</span> event is fired. It displays the coordinates of the object which the mouse is over, if any, and its name, if defined: </div><div id="ww998887" class="NormalCode">&lt;HTML&gt;</div><div id="ww998888" class="NormalCode">&lt;HEAD&gt;</div><div id="ww998889" class="NormalCode">&lt;TITLE&gt;ATL 3.0 test page for object DemoATLCtrl&lt;/TITLE&gt;</div><div id="ww998890" class="NormalCode">&lt;/HEAD&gt;</div><div id="ww998891" class="NormalCode">&nbsp;</div><div id="ww998892" class="NormalCode">&lt;SCRIPT LANGUAGE = "javascript"&gt;</div><div id="ww998893" class="NormalCode">&nbsp;</div><div id="ww998894" class="NormalCode">&lt;!--</div><div id="ww998895" class="NormalCode">function load(value)</div><div id="ww998896" class="NormalCode">{</div><div id="ww998897" class="NormalCode">    DemoATLCtrl.FileName = value;</div><div id="ww998898" class="NormalCode">}</div><div id="ww998899" class="NormalCode">&nbsp;</div><div id="ww998900" class="NormalCode">--&gt;</div><div id="ww998901" class="NormalCode">&lt;/SCRIPT&gt;</div><div id="ww998902" class="NormalCode">&nbsp;</div><div id="ww998903" class="NormalCode">&lt;SCRIPT LANGUAGE = "VBScript"&gt;</div><div id="ww998904" class="NormalCode">&nbsp;</div><div id="ww998905" class="NormalCode">&lt;!--</div><div id="ww998906" class="NormalCode">Sub DemoATLCtrl_PointerPosition(name, x, y)</div><div id="ww998907" class="NormalCode">    text1.innerText = name &amp; " (" &amp; x &amp; ", " &amp; y &amp; ")"</div><div id="ww998908" class="NormalCode">End Sub</div><div id="ww998909" class="NormalCode">&nbsp;</div><div id="ww998910" class="NormalCode">--&gt;</div><div id="ww998911" class="NormalCode">&lt;/SCRIPT&gt;</div><div id="ww998912" class="NormalCode">&nbsp;</div><div id="ww998913" class="NormalCode">&lt;BODY&gt;</div><div id="ww998914" class="NormalCode">&nbsp;</div><div id="ww1013271" class="NormalCode">&lt;SELECT NAME=Files onchange = "load(value)" &gt;</div><div id="ww1013272" class="NormalCode">&lt;OPTION Selected Value="data/browse.ilv"&gt;World</div><div id="ww1013273" class="NormalCode">&lt;OPTION Value="europe.ilv"&gt; Europe</div><div id="ww1013274" class="NormalCode">&lt;OPTION Value="africa.ilv"&gt; Africa</div><div id="ww998919" class="NormalCode">&lt;/SELECT&gt;</div><div id="ww998920" class="NormalCode">&nbsp;</div><div id="ww998921" class="NormalCode">&lt;P&gt;</div><div id="ww998922" class="NormalCode">&lt;OBJECT WIDTH=400 HEIGHT=400 ID="DemoATLCtrl" CLASSID="CLSID:3B10417D-3E6C-</div><div id="ww1005292" class="NormalCode">11D3-B74F-00C04F68A89D"&gt;&lt;/OBJECT&gt;</div><div id="ww998923" class="NormalCode">&lt;P&gt;</div><div id="ww998924" class="NormalCode">&nbsp;</div><div id="ww998925" class="NormalCode">&lt;INPUT id=text1 name=text1&gt;</div><div id="ww998926" class="NormalCode">&lt;/P&gt;</div><div id="ww998927" class="NormalCode">&nbsp;</div><div id="ww998928" class="NormalCode">&lt;/BODY&gt;</div><div id="ww998929" class="NormalCode">&nbsp;</div><div id="ww998930" class="LastNormalCode">&lt;/HTML&gt;</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1005923" class="Note"><span class="flag">Note:&nbsp;</span>Since the class id is generated, the class id in your file may be different from the one in this example. </div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>