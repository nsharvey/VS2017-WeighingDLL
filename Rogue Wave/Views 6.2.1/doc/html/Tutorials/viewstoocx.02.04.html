<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Step 2: Creating an ActiveX Control with ATL</title><link rel="Prev" href="viewstoocx.02.03.html" title="Previous" /><link rel="Next" href="viewstoocx.02.05.html" title="Next" /><link rel="StyleSheet" href="css/viewstoocx.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/viewstoocx_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Tutorials/viewstoocx.02.04.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pXooJ7WuYDuHx7Di57ndqBA" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Tutorials/viewstoocx.02.04.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/foundtutfrontcover.html#wwconnect_header">Views Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.01.html#wwconnect_header">Creating an ActiveX Control from Existing Rogue Wave&nbsp;Views Code</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.02.html#wwconnect_header">Creating an ActiveX Control with the ATL Library</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Step 2: Creating an ActiveX Control with ATL</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww998406" class="Heading2"><span></span>Step 2: Creating an ActiveX Control with ATL</div><div id="ww998408" class="Body">This step shows how to create an ActiveX control with the <span class="code">Ctrl</span> class defined in <span class="Emphasis" style="font-style: italic"><a href="../Tutorials/viewstoocx.02.03.html#ww999127" title="Step 1: Preparing the Program">Step 1: Preparing the Program</a></span>. The ActiveX control you will obtain once this step is completed has a minimal interface.</div><div id="ww1007228" class="Body">You are going to:</div><div id="ww1007229" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww999526" title="Step 2: Creating an ActiveX Control with ATL">Create a new project.</a></div><div id="ww1007234" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww999527" title="Step 2: Creating an ActiveX Control with ATL">Add a new ATL object.</a></div><div id="ww1007239" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww999528" title="Step 2: Creating an ActiveX Control with ATL">Add files to the project.</a></div><div id="ww1007244" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww1005769" title="Step 2: Creating an ActiveX Control with ATL">Add the initialization and destruction of the display in the DllMain function.</a></div><div id="ww1007254" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww998504" title="Step 2: Creating an ActiveX Control with ATL">Add a private member variable for CDemoATLCtrl.</a></div><div id="ww1013292" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww1011902" title="Step 2: Creating an ActiveX Control with ATL">Add a new windows message handler to the CDemoATLCtrl class.</a></div><div id="ww1007259" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww1000013" title="Step 2: Creating an ActiveX Control with ATL">Modify the DemoATLCtrl.h file generated by the wizard.</a></div><div id="ww1007264" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww998533" title="Step 2: Creating an ActiveX Control with ATL">Modify the DemoATL.rc file.</a></div><div id="ww1007269" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww1000143" title="Step 2: Creating an ActiveX Control with ATL">Modify the project settings.</a></div><div id="ww1007274" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.04.html#ww1000396" title="Step 2: Creating an ActiveX Control with ATL">Build the ActiveX control.</a></div><div id="ww999526" class="Heading4">Create a new project.</div><div id="ww998411" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In Visual C++, choose New &gt; Project from the File menu and select ATL Project template to create a new project.</div><div id="ww999419" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Type <span class="code">DemoATL</span> in the Project name text field and click OK.</div><div id="ww999402" class="IndentedL1">The ATL Project Wizard is displayed. </div><div id="ww999423" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Select the Dynamic Link Library (DLL) option and leave Allow merging of proxy/stub code, Support MFC, and Support of MTS unchecked. </div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1005788" class="Note"><span class="flag">Note:&nbsp;</span>These options are not required for this tutorial. But you might have to select them for your own purposes later, depending on what you want to obtain. </div></td></tr></table></div><div id="ww999442" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Click Finish and OK.</div><div id="ww999527" class="Heading4">Add a new ATL object.</div><div id="ww998414" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Click the ClassView tab of the Project Workspace window to activate it, if necessary, and click the DemoATL classes label with the right mouse button. </div><div id="ww999546" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Select Add &gt; Class from the menu that appears. In the dialog box choose ATL Control.</div><div id="ww999458" class="IndentedL1">An ATL Control Wizard is displayed.</div><div id="ww999468" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Type <span class="code">DemoATLCtrl</span> in the Short Name text field.</div><div id="ww999475" class="IndentedL1">The other fields are automatically filled with labels. Leave these as they are. </div><div id="ww998418" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Click the Options tab, select Apartment as Threading model, the Dual Interface, and select Yes in Aggregation. Also check the Support Connection Points option. </div><div id="ww999487" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>Click the Appearance tab and select Opaque, Solid Background, NormalizeDC, Insertable and Windowed Only.</div><div id="ww999488" class="IndentedL1">Leave the other options unchecked. No Stock Properties are declared. </div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1005761" class="Note"><span class="flag">Note:&nbsp;</span>The selected options may be different, depending on what you want to obtain.</div></td></tr></table></div><div id="ww999528" class="Heading4">Add files to the project.</div><div id="ww1009289" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add the files <span class="code">ctrl.cpp</span> and <span class="code">ctrl.h</span> to the project. </div><div id="ww1009292" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Create the <span class="code">DemoCtrl.h</span> file and add it to the project.</div><div id="ww1009293" class="IndentedL1">This file should contain the declaration of the <span class="code">DemoCtrl</span> class that follows. This class initializes the control. It also provides an interface between the code generated by the wizard and the Rogue Wave&nbsp;Views code and/or the <span class="code">Ctrl</span> class.</div><div id="ww999559" class="NormalCodeL1">class DemoCtrl : public Ctrl</div><div id="ww999560" class="NormalCodeL1">{</div><div id="ww999561" class="NormalCodeL1">public:</div><div id="ww999562" class="NormalCodeL1">    DemoCtrl(HWND parent);</div><div id="ww999563" class="NormalCodeL1">    ~DemoCtrl();</div><div id="ww999564" class="NormalCodeL1">    static IlvDisplay* getDisplay()throw() { return _Display; }</div><div id="ww999565" class="NormalCodeL1">    static bool InitDisplay(HINSTANCE hInstance) throw();</div><div id="ww999566" class="NormalCodeL1">    static void CleanDisplay();</div><div id="ww999567" class="NormalCodeL1">&nbsp;</div><div id="ww999568" class="NormalCodeL1">private:</div><div id="ww999569" class="NormalCodeL1">    DemoCtrl(const DemoCtrl&amp;); // Not defined to avoid</div><div id="ww999664" class="NormalCodeL1">                               // default copy constructor.</div><div id="ww1011778" class="NormalCodeL1">    DemoCtrl(); // Not defined to avoid default constructor.</div><div id="ww999570" class="NormalCodeL1">    static IlvDisplay* _Display;</div><div id="ww999571" class="LastNormalCodeL1">};</div><div id="ww998443" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Create the <span class="code">DemoCtrl.cpp</span> file and add it to the project. </div><div id="ww999589" class="IndentedL1">This file defines the member functions of the <span class="code">DemoCtrl</span> class that are not declared inline and the static class variable <span class="code">_Display</span>.</div><div id="ww998445" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The constructor <span class="code">DemoCtrl(HWND parent)</span> calls the corresponding constructor of the <span class="code">Ctrl</span> class: </div><div id="ww998448" class="NormalCodeL1">DemoCtrl::DemoCtrl(HWND hWnd)</div><div id="ww998449" class="NormalCodeL1">: Ctrl(_Display, reinterpret_cast&lt;IlvSystemView&gt;(hWnd))</div><div id="ww998450" class="NormalCodeL1">{</div><div id="ww998451" class="LastNormalCodeL1">}</div><div id="ww998453" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The static member function <span class="code">InitDisplay</span> creates an instance of <span class="code">IlvDisplay</span> and stores it into <span class="code">_Display</span>. </div><div id="ww999689" class="NormalCodeL1">bool</div><div id="ww998457" class="NormalCodeL1">DemoCtrl::InitDisplay(HINSTANCE hInstance) throw ()</div><div id="ww998458" class="NormalCodeL1">{</div><div id="ww998459" class="NormalCodeL1">    try {</div><div id="ww998460" class="NormalCodeL1">        _Display = new IlvDisplay(hInstance, "ATL Views Sample");</div><div id="ww998461" class="NormalCodeL1">        if (!_Display || _Display-&gt;isBad()) {</div><div id="ww998462" class="NormalCodeL1">            IlvFatalError("Can’t initialize IlvDisplay.");</div><div id="ww998463" class="NormalCodeL1">            if (_Display) {</div><div id="ww999721" class="NormalCodeL1">                delete _Display;</div><div id="ww999722" class="NormalCodeL1">                _Display = 0;</div><div id="ww999723" class="NormalCodeL1">           }</div><div id="ww999724" class="NormalCodeL1">        }</div><div id="ww998468" class="NormalCodeL1">    }</div><div id="ww998469" class="NormalCodeL1">    catch(...) {</div><div id="ww998470" class="NormalCodeL1">        CleanDisplay();</div><div id="ww998471" class="NormalCodeL1">    }</div><div id="ww998472" class="NormalCodeL1">     return _Display ? true : false;</div><div id="ww998473" class="LastNormalCodeL1">}</div><div id="ww999802" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The static function <span class="code">CleanDisplay</span> releases the instance of <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvDisplay.html">IlvDisplay</a></span> stored in <span class="code">_Display</span>. </div><div id="ww999803" class="NormalCodeL1">void</div><div id="ww999804" class="NormalCodeL1">DemoCtrl::CleanDisplay()</div><div id="ww999805" class="NormalCodeL1">{</div><div id="ww999806" class="NormalCodeL1">    if (_Display) {</div><div id="ww999807" class="NormalCodeL1">        delete _Display;</div><div id="ww999808" class="NormalCodeL1">        _Display = 0;</div><div id="ww999809" class="NormalCodeL1">    }</div><div id="ww1005768" class="LastNormalCodeL1">}</div><div id="ww1005769" class="Heading4">Add the initialization and destruction of the display in the DllMain function.</div><div id="ww1005772" class="Body">Use the static member functions of the <span class="code">DemoCtrl</span> class as follows:</div><div id="ww998489" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Locate the <span class="code">DllMain</span> function and add the following code to its implementation:</div><div id="ww1011849" class="NormalCodeL1">switch (dwReason) {</div><div id="ww1011819" class="NormalCodeL1">        case DLL_PROCESS_ATTACH:</div><div id="ww1011847" class="NormalCodeL1">        if (!DemoCtrl::InitDisplay(hInstance))</div><div id="ww1011820" class="NormalCodeL1">            return FALSE;</div><div id="ww1011821" class="NormalCodeL1">        break;</div><div id="ww1011822" class="NormalCodeL1">      case DLL_PROCESS_DETACH:</div><div id="ww1011823" class="NormalCodeL1">        DemoCtrl::CleanDisplay();</div><div id="ww1011824" class="NormalCodeL1">        break;</div><div id="ww1011825" class="NormalCodeL1">      default:</div><div id="ww1011826" class="NormalCodeL1">        break;</div><div id="ww1011814" class="LastNormalCodeL1">}</div><div id="ww998490" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Include the header file <span class="code">DemoCtrl.h</span>.</div><div id="ww998504" class="Heading4">Add a private member variable for CDemoATLCtrl. </div><div id="ww1005775" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Expand DemoATL classes and select <span class="code">CDemoATLCtrl</span>.</div><div id="ww1001693" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Press the right mouse button and choose Add &gt; Variable.</div><div id="ww999959" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Enter <span class="code">DemoCtrl*</span> in the Variable Type field.</div><div id="ww1005781" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Enter <span class="code">m_Ctrl</span> in Variable Name field and click OK.</div><div id="ww1011902" class="Heading4">Add a new windows message handler to the CDemoATLCtrl class.</div><div id="ww1011903" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the <span class="code">CDemoATLCtrl</span> constructor (file <span class="code">DemoATLCtrl.h</span>) add the following line to make control windowed</div><div id="ww1011905" class="LastNormalCodeL1">m_bWindowOnly = TRUE;</div><div id="ww1011906" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Locate the <span class="code">BEGIN_MSG_MAP</span> declaration in <span class="code">DemoATLCtrl.h</span>.</div><div id="ww1011897" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>In the <span class="code">BEGIN_MSG_MAP</span> declarations, add the following code:</div><div id="ww1011914" class="LastNormalCodeL1">MESSAGE_HANDLER(WM_CREATE, OnCreate)</div><div id="ww1011921" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Add the following public function to the <span class="code">CDemoATLCtrl</span> class (file <span class="code">DemoATLCtrl.h</span><span style="font-size: 11.0pt">):</span></div><div id="ww1011923" class="NormalCodeL1">LRESULT OnCreate (UINT uMsg, WPARAM wParam, LPARAM</div><div id="ww1011924" class="NormalCodeL1">lParam, BOOL&amp; bHandled) {</div><div id="ww1011925" class="NormalCodeL1">      try {</div><div id="ww1011926" class="NormalCodeL1">        m_Ctrl = new DemoCtrl(m_hWnd);</div><div id="ww1011927" class="NormalCodeL1">      } catch (...) {</div><div id="ww1011928" class="NormalCodeL1">        if (m_Ctrl) {</div><div id="ww1011929" class="NormalCodeL1">           delete m_Ctrl;</div><div id="ww1011930" class="NormalCodeL1">           m_Ctrl = 0;</div><div id="ww1011931" class="NormalCodeL1">        }</div><div id="ww1011932" class="NormalCodeL1">      }</div><div id="ww1011933" class="NormalCodeL1">      return 0;</div><div id="ww1011919" class="LastNormalCodeL1">} </div><div id="ww1000013" class="Heading4">Modify the DemoATLCtrl.h file generated by the wizard.</div><div id="ww1000011" class="Body">Modify the file <span class="code">DemoATLCtrl.h</span> generated by the wizard to create the instance of the class <span class="code">DemoCtrl</span> used by the application as follows:</div><div id="ww998509" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Include the header file <span class="code">DemoCtrl.h</span> in the file <span class="code">DemoATLCtrl.h</span>. </div><div id="ww1000052" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Initialize the variable <span class="code">m_Ctrl</span> to <span class="code">0</span> in the constructor (file <span class="code">DemoATLCtrl.h</span>): </div><div id="ww1000053" class="NormalCodeL1">CDemoATLCtrl()</div><div id="ww1000054" class="NormalCodeL1">// Added for Rogue Wave&nbsp;Views.</div><div id="ww1000055" class="NormalCodeL1">: m_Ctrl(0)</div><div id="ww1000056" class="NormalCodeL1">// End Added for Rogue Wave&nbsp;Views.</div><div id="ww1000057" class="NormalCodeL1">{</div><div id="ww1000058" class="NormalCodeL1">        m_bWindowOnly = TRUE;</div><div id="ww1000059" class="LastNormalCodeL1">}</div><div id="ww998533" class="Heading4">Modify the DemoATL.rc file.</div><div id="ww1000127" class="Body">Add the following line at the end of the file <span class="code">DemoATL.rc</span>.</div><div id="ww998535" class="LastNormalCode">#include "viewsdata.rc"</div><div id="ww1000143" class="Heading4">Modify the project settings.</div><div id="ww1001727" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Open the project property pages.</div><div id="ww1012030" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>In the Project Settings dialog box, select the Debug configuration and click the C/C++ tab.</div><div id="ww1000150" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Select the General or Preprocessor option in the Category drop-down list and replace the preprocessor definition <span class="code">_DEBUG</span> by <span class="code">NDEBUG</span>. </div><div id="ww1000159" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Select All Configurations and click the C/C++ tab if necessary.</div><div id="ww1000166" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>Select the General or Preprocessor option in the Category drop-down list and add <span class="code">ILVSTD</span> in the “Preprocessor definitions” text field. </div><div id="ww1012043" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">6.	</span></span>Select <span class="code">Code Generation</span> in the C/C++ category and select <span class="code">Yes</span> <span class="code">(/EHSC) </span>for Enable C++ Exceptions and select <span class="code">Multi-threaded(/MT)</span> for Runtime Library. </div><div id="ww998547" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">7.	</span></span>Select <span class="code">Language</span> in the C/C++ category drop-down list Enable Run-Time Type Information (RTTI).</div><div id="ww1012089" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">8.	</span></span>Select <span class="code">General</span> in the C/C++ category and type the following line in the Additional include directories text field:</div><div id="ww1000271" class="IndentedL1"><span class="code">".;c:\Rogue Wave\views\include</span>"</div><div id="ww998552" class="IndentedL1">Here we assume that Rogue Wave&nbsp;Views is installed in <span class="code">C:\Rogue Wave\views\</span>.</div><div id="ww998553" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">9.	</span></span>Select “Precompiled headers” in the Category drop-down list and select the option “Not using precompiled headers” for the files <span class="code">ctrl.cpp</span> and <span class="code">DemoCtrl.cpp</span>.</div><div id="ww1000318" class="IndentedL1">Because of the initialization mechanism of Rogue Wave&nbsp;Views, most of the Rogue Wave&nbsp;Views headers cannot be precompiled. </div><div id="ww1012120" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">10.	</span></span>In the Linker category, select <span class="code">General</span> in the category and add the path to the Rogue Wave Views <span class="code">stat_mta</span> libraries to the "Additional library path" text field:</div><div id="ww1000365" class="LastNormalCodeL1">Ex: c:\Rogue Wave\views\lib\x86_.net2010_10.0\stat_mta</div><div id="ww1012179" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">11.	</span></span>Select <span class="code">Input</span> in the <span class="code">Linker</span> category and add the Rogue Wave Views libraries (that is, <span class="code">winviews.lib</span>, <span class="code">views.lib</span>, and <span class="code">ilvgadgt.lib</span>) and also the <span class="code">wsock32.lib</span> and <span class="code">imm32.lib</span> libraries in additional dependencies. </div><div id="ww1003783" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">12.	</span></span>Select all the Release configurations and remove <span class="code">_ATL_MIN_CRT</span> from the “Preprocessor definitions” text field. </div><div id="ww1012153" class="IndentedL1">This option must be removed because the standard C++ runtime library is used. However, this option may not be present in your generated ATL project as this option is deprecated since Microsoft Visual Studio 2008 (9.0).</div><div id="ww1000396" class="Heading4">Build the ActiveX control. </div><div id="ww998563" class="Body">Now you can build the ActiveX control and test it. The wizard generates an html file, <span class="code">DemoATLCtrl.htm</span>, that you can use to load the ActiveX control in Internet Explorer. </div><div id="ww1000407" class="Body">Since the default size of the ActiveX control is small, you can modify its width and height as follows: </div><div id="ww1005282" class="NormalCode">&lt;OBJECT WIDTH=400 HEIGHT=400 ID="DemoATLCtrl"  CLASSID="CLSID:3B10417D-3E6C-</div><div id="ww1005283" class="LastNormalCode">11D3-B74F-00C04F68A89D"&gt;&lt;/OBJECT&gt;</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1005286" class="Note"><span class="flag">Note:&nbsp;</span>Since the class id is generated, the class id in your file can be different from the one in this example. </div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>