<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Step 3: Adding Custom Properties to the ActiveX Control</title><link rel="Prev" href="viewstoocx.02.04.html" title="Previous" /><link rel="Next" href="viewstoocx.02.06.html" title="Next" /><link rel="StyleSheet" href="css/viewstoocx.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/viewstoocx_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Tutorials/viewstoocx.02.05.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="peTUgbG47DG3cqAjiTOHL4Q" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Tutorials/viewstoocx.02.05.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/foundtutfrontcover.html#wwconnect_header">Views Foundation</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.01.html#wwconnect_header">Creating an ActiveX Control from Existing Rogue Wave&nbsp;Views Code</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Tutorials/viewstoocx.02.02.html#wwconnect_header">Creating an ActiveX Control with the ATL Library</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Step 3: Adding Custom Properties to the ActiveX Control</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww998570" class="Heading2"><span></span>Step 3: Adding Custom Properties to the ActiveX Control</div><div id="ww998572" class="Body">This step shows how to add a file name and a background color to the ActiveX control. The file name is that of the file read by the manager. By default, this file is <span class="code">data/browse.ilv</span>, which we included in the <span class="code">.rc</span> file in Step 2. The background color is that of the manager view.</div><div id="ww1007281" class="Body">You are going to:</div><div id="ww1007282" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1007325" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the FileName property.</a></div><div id="ww1007287" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1000490" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the Background property.</a></div><div id="ww1007292" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1000549" title="Step 3: Adding Custom Properties to the ActiveX Control">Add new private member variables.</a></div><div id="ww1007297" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1000595" title="Step 3: Adding Custom Properties to the ActiveX Control">Modify the CDemoAtlCtrl constructor.</a></div><div id="ww1007319" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1005822" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the setFileName member function.</a></div><div id="ww1007323" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1000728" title="Step 3: Adding Custom Properties to the ActiveX Control">Add the setBackground member function.</a></div><div id="ww1007328" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww1000832" title="Step 3: Adding Custom Properties to the ActiveX Control">Modify the member functions generated by the wizard.</a></div><div id="ww1007332" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww998727" title="Step 3: Adding Custom Properties to the ActiveX Control">Add lines to the property map macro.</a></div><div id="ww1007337" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww998734" title="Step 3: Adding Custom Properties to the ActiveX Control">Modify the CDemoATLCtrl::OnCreate member function.</a></div><div id="ww1007342" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Tutorials/viewstoocx.02.05.html#ww998757" title="Step 3: Adding Custom Properties to the ActiveX Control">Test the properties.</a></div><div id="ww1007325" class="Heading4">Add the FileName property. </div><div id="ww1000469" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click <span class="code">IDemoAtlCtrl</span> with the right mouse button and select Add &gt; Add Property.</div><div id="ww1001742" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Enter <span class="code">FileName</span> in the Property Name field.</div><div id="ww1000479" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Choose <span class="code">BSTR</span> from the Property Type drop-down list.</div><div id="ww1000493" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Be sure the Parameters field is empty.</div><div id="ww1000494" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>If necessary, select Get Function, Put Function, and PropPut.</div><div id="ww998577" class="IndentedL1">Leave PropPutRef unchecked. The attributes are <span class="code">id</span> and <span class="code">helpstring</span>.</div><div id="ww1000508" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">6.	</span></span>Click OK.</div><div id="ww1000490" class="Heading4">Add the Background property. </div><div id="ww1000507" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click <span class="code">IDemoAtlCtrl</span> with the right mouse button and select Add &gt; Add Property.</div><div id="ww1001751" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Enter <span class="code">Background</span> in the Property Name field.</div><div id="ww998582" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Choose <span class="code">OLE_COLOR</span> in the Property Type drop-down list.</div><div id="ww1000528" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Leave the Parameters field empty.</div><div id="ww1000532" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>If necessary, select Get Function, Put Function, and PropPut.</div><div id="ww1000533" class="IndentedL1">Leave PropPutRef unckecked. The attributes are <span class="code">id</span> (value 2) and <span class="code">helpstring</span>.</div><div id="ww1004158" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">6.	</span></span>Click OK.</div><div id="ww1000549" class="Heading4">Add new private member variables.</div><div id="ww1000550" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>In the ClassView tab of the Project Workspace window, click <span class="code">CDemoATLCtrl</span> with the right mouse button.</div><div id="ww1003831" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Choose Add &gt; Add Variable from the menu that appears. </div><div id="ww1000559" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>Enter <span class="code">CComBSTR</span> in Variable Type and <span class="code">m_FileName</span> in Variable Name and click OK.</div><div id="ww1004016" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Choose Add &gt; Add Variable again. </div><div id="ww998586" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>Enter <span class="code">OLE_COLOR</span> in Variable Type and <span class="code">m_Background</span> in Variable Name and click OK.</div><div id="ww1000595" class="Heading4">Modify the CDemoAtlCtrl constructor. </div><div id="ww1000596" class="Body">In the file <span class="code">DemoATLCtrl.h</span>, modify the <span class="code">CDemoATLCtrl</span> constructor as follows to initialize the member variables <span class="code">m_FileName</span> and <span class="code">m_Background</span>: </div><div id="ww998594" class="NormalCode">CDemoATLCtrl()</div><div id="ww998595" class="NormalCode">// Added for Rogue Wave&nbsp;Views.</div><div id="ww998596" class="NormalCode">: m_Ctrl(0), m_FileName(), m_Background(-1)</div><div id="ww998597" class="NormalCode">// End Added for Rogue Wave&nbsp;Views.</div><div id="ww998599" class="NormalCode">{</div><div id="ww1001784" class="NormalCode">    m_bWindowOnly = TRUE;</div><div id="ww998600" class="LastNormalCode">}</div><div id="ww1005822" class="Heading4">Add the setFileName member function. </div><div id="ww1005823" class="Body">This member function must be added to the <span class="code">DemoCtrl</span> class. It has one parameter of type <span class="code">const char*</span> that represents the new file name. Its purpose is to load the corresponding file. </div><div id="ww1005826" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add the declaration of <span class="code">DemoCtrl::setFileName</span> to the file <span class="code">DemoCtrl.h</span>: </div><div id="ww1005827" class="LastNormalCodeL1"><span class="code">void setFileName(</span>CComBSTR&amp; fileName<span class="code">);</span></div><div id="ww1005830" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add the definition <span class="code">DemoCtrl::setFileName</span> to the file <span class="code">DemoCtrl.cpp</span>: </div><div id="ww1012828" class="NormalCodeL1">void</div><div id="ww1012829" class="NormalCodeL1">DemoCtrl::setFileName(CComBSTR&amp; fileName)</div><div id="ww1012830" class="NormalCodeL1">{</div><div id="ww1012831" class="NormalCodeL1">    if (!fileName || !fileName.Length())</div><div id="ww1012832" class="NormalCodeL1">      return;</div><div id="ww1012833" class="NormalCodeL1">    IlvManager* manager = getManager();</div><div id="ww1012834" class="NormalCodeL1">    if (!manager)</div><div id="ww1012835" class="NormalCodeL1">      return;</div><div id="ww1012836" class="NormalCodeL1">    manager-&gt;initReDraws();</div><div id="ww1012837" class="NormalCodeL1">    manager-&gt;deleteAll(IlvTrue, IlvFalse);</div><div id="ww1012838" class="NormalCodeL1">    size_t len = wcstombs(0, fileName.m_str, 10000) + 1;</div><div id="ww1012839" class="NormalCodeL1">    char* path = new char[len];</div><div id="ww1012840" class="NormalCodeL1">    wcstombs(path, fileName.m_str, len);</div><div id="ww1012841" class="NormalCodeL1">    manager-&gt;read(path);</div><div id="ww1012842" class="NormalCodeL1">    delete [] path;</div><div id="ww1012843" class="NormalCodeL1">    manager-&gt;fitTransformerToContents(getManagerView());</div><div id="ww1012844" class="NormalCodeL1">    manager-&gt;reDrawViews();</div><div id="ww1005844" class="LastNormalCodeL1">}</div><div id="ww1000728" class="Heading4">Add the setBackground member function.</div><div id="ww1000731" class="Body">This member function must be added to the <span class="code">DemoCtrl</span> class. It has one parameter of type <span class="code">OLE_COLOR</span> that represents the new color. Its purpose is to convert the <span class="code">OLE_COLOR</span> into an <span class="code">IlvColor*</span> that Rogue Wave&nbsp;Views can interpret and to redraw the view. </div><div id="ww998635" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add the declaration of <span class="code">DemoCtrl::setBackground</span> to the file <span class="code">DemoCtrl.h</span>: </div><div id="ww998637" class="IndentedL1"><span class="code">void setBackground(OLE_COLOR);</span></div><div id="ww998639" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add the definition of <span class="code">DemoCtrl::setBackground</span> to the file <span class="code">DemoCtrl.cpp</span>: </div><div id="ww998641" class="NormalCodeL1">void</div><div id="ww998642" class="NormalCodeL1">DemoCtrl::setBackground(OLE_COLOR oleColor)</div><div id="ww998643" class="NormalCodeL1">{</div><div id="ww998644" class="NormalCodeL1">    if (oleColor == -1)</div><div id="ww998645" class="NormalCodeL1">        return;</div><div id="ww998646" class="NormalCodeL1">    IlvManager* manager = getManager();</div><div id="ww998647" class="NormalCodeL1">    if (!manager)</div><div id="ww998648" class="NormalCodeL1">        return;</div><div id="ww998649" class="NormalCodeL1">    COLORREF colRef;</div><div id="ww998650" class="NormalCodeL1">    HPALETTE hPal = NULL;</div><div id="ww998651" class="NormalCodeL1">    if (getDisplay()-&gt;screenDepth() &lt;= 8)</div><div id="ww998654" class="NormalCodeL1">        hPal = HPALETTE(getDisplay()-&gt;getPaletteHandle());</div><div id="ww998655" class="NormalCodeL1">     if (S_OK != OleTranslateColor(oleColor, hPal, &amp;colRef))</div><div id="ww998656" class="NormalCodeL1">         return;</div><div id="ww998657" class="NormalCodeL1">     IlvIntensity red, blue, green;</div><div id="ww998658" class="NormalCodeL1">     getDisplay()-&gt;pixelToRGB((unsigned long)(colRef), red, blue, green);</div><div id="ww998659" class="NormalCodeL1">     IlvColor* color = getDisplay()-&gt;getColor(red, blue, green);</div><div id="ww998660" class="NormalCodeL1">      manager-&gt;initReDraws();</div><div id="ww998661" class="NormalCodeL1">      manager-&gt;setBackground(getManagerView(), color);</div><div id="ww998662" class="NormalCodeL1">      manager-&gt;reDraw();</div><div id="ww998663" class="NormalCodeL1">      manager-&gt;reDrawViews();</div><div id="ww998664" class="LastNormalCodeL1">}</div><div id="ww1000832" class="Heading4">Modify the member functions generated by the wizard.</div><div id="ww998666" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Modify the member functions <span class="code">CDemoATLCtrl::put_FileName</span> and <span class="code">CDemoATLCtrl::get_FileName</span> generated by the wizard in the file <span class="code">DemoATLCtrl.cpp</span> as follows: </div><div id="ww998670" class="NormalCodeL1">STDMETHODIMP CDemoATLCtrl::put_FileName(BSTR newVal)</div><div id="ww998671" class="NormalCodeL1">{</div><div id="ww998672" class="NormalCodeL1">    // TODO: Add your implementation code here</div><div id="ww998673" class="NormalCodeL1">    // Added for Rogue Wave&nbsp;Views.</div><div id="ww998674" class="NormalCodeL1">    if (!newVal)</div><div id="ww998675" class="NormalCodeL1">        return S_OK;</div><div id="ww998676" class="NormalCodeL1">    if (m_FileName != newVal) {</div><div id="ww998677" class="NormalCodeL1">        m_FileName = newVal;</div><div id="ww998678" class="NormalCodeL1">        if (!m_FileName.Length())</div><div id="ww998679" class="NormalCodeL1">            m_FileName.Empty();</div><div id="ww998680" class="NormalCodeL1">        if (m_Ctrl &amp;&amp; !!m_FileName)</div><div id="ww998681" class="NormalCodeL1">            m_Ctrl-&gt;setFileName(m_FileName);</div><div id="ww998682" class="NormalCodeL1">    }</div><div id="ww998683" class="NormalCodeL1">     // End Added for Rogue Wave&nbsp;Views.</div><div id="ww998684" class="NormalCodeL1">    return S_OK;</div><div id="ww998685" class="LastNormalCodeL1">}</div><div id="ww998689" class="NormalCodeL1">STDMETHODIMP CDemoATLCtrl::get_FileName(BSTR *pVal)</div><div id="ww998690" class="NormalCodeL1">{</div><div id="ww998691" class="NormalCodeL1">    // TODO: Add your implementation code here</div><div id="ww998692" class="NormalCodeL1">     // Added for Rogue Wave&nbsp;Views.</div><div id="ww998693" class="NormalCodeL1">    return m_FileName.CopyTo(pVal);</div><div id="ww998694" class="NormalCodeL1">    // End Added for Rogue Wave&nbsp;Views.</div><div id="ww998695" class="NormalCodeL1">    return S_OK;</div><div id="ww998696" class="LastNormalCodeL1">}</div><div id="ww998698" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Modify the member functions <span class="code">CDemoATLCtrl::put_Background</span> and <span class="code">CDemoATLCtrl::get_Background</span> generated by the wizard in the file <span class="code">DemoATLCtrl.cpp</span>: </div><div id="ww998702" class="NormalCodeL1">STDMETHODIMP CDemoATLCtrl::put_Background(OLE_COLOR newVal)</div><div id="ww998703" class="NormalCodeL1">{</div><div id="ww998704" class="NormalCodeL1">    // TODO: Add your implementation code here</div><div id="ww998705" class="NormalCodeL1">    // Added for Rogue Wave&nbsp;Views.</div><div id="ww998706" class="NormalCodeL1">    if (m_Background != newVal) {</div><div id="ww998707" class="NormalCodeL1">        m_Background = newVal;</div><div id="ww998708" class="NormalCodeL1">        if (m_Ctrl &amp;&amp; (m_Background != -1))</div><div id="ww998710" class="NormalCodeL1">            m_Ctrl-&gt;setBackground(m_Background);</div><div id="ww998711" class="NormalCodeL1">   }</div><div id="ww998712" class="NormalCodeL1">    // End Added for Rogue Wave&nbsp;Views.</div><div id="ww998713" class="NormalCodeL1">    return S_OK;</div><div id="ww998714" class="LastNormalCodeL1">}</div><div id="ww998718" class="NormalCodeL1">STDMETHODIMP CDemoATLCtrl::get_Background(OLE_COLOR *pVal)</div><div id="ww998719" class="NormalCodeL1">{</div><div id="ww998720" class="NormalCodeL1">    // TODO: Add your implementation code here</div><div id="ww998721" class="NormalCodeL1">    // Added for Rogue Wave&nbsp;Views.</div><div id="ww998722" class="NormalCodeL1">    *pVal = m_Background;</div><div id="ww998723" class="NormalCodeL1">    // End Added for Rogue Wave&nbsp;Views.</div><div id="ww998724" class="NormalCodeL1">    return S_OK;</div><div id="ww998725" class="LastNormalCodeL1">}</div><div id="ww998727" class="Heading4">Add lines to the property map macro. </div><div id="ww1003852" class="Body">Add the following lines to the <span class="code">BEGIN_PROP_MAP/END_PROP_MAP</span> macro declaration block in the <span class="code">DemoATLCtrl.h</span> file.</div><div id="ww1012860" class="NormalCode">// Added for Rogue Wave Views.</div><div id="ww1012861" class="NormalCode">    PROP_ENTRY_TYPE("FileName", 1, CLSID_NULL, VT_BSTR)</div><div id="ww1012862" class="NormalCode">    PROP_ENTRY_TYPE("Background", 2, CLSID_NULL, VT_COLOR)</div><div id="ww998732" class="LastNormalCode">// End Added for Rogue Wave Views.</div><div id="ww998734" class="Heading4">Modify the CDemoATLCtrl::OnCreate member function.</div><div id="ww1000941" class="Body">Modify the member function <span class="code">CDemoATLCtrl::OnCreate</span> in the file <span class="code">DemoATLCtrl.h</span> to set the file name and/or the background color when the corresponding properties are defined: </div><div id="ww998737" class="NormalCode">LRESULT OnCreate(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL&amp; bHandled)</div><div id="ww998738" class="NormalCode">{</div><div id="ww998739" class="NormalCode">    // TODO : Add Code for message handler. Call DefWindowProc if necessary.</div><div id="ww998740" class="NormalCode">    // Added for Rogue Wave&nbsp;Views.</div><div id="ww998741" class="NormalCode">    try {</div><div id="ww998742" class="NormalCode">        m_Ctrl = new DemoCtrl(m_hWnd);</div><div id="ww998743" class="NormalCode">        // Added for the FileName property.</div><div id="ww998744" class="NormalCode">        m_Ctrl-&gt;setFileName(m_FileName);</div><div id="ww998745" class="NormalCode">        // Added for the Background property.</div><div id="ww998746" class="NormalCode">        m_Ctrl-&gt;setBackground(m_Background);</div><div id="ww998747" class="NormalCode">    } catch (...) {</div><div id="ww998748" class="NormalCode">        if (m_Ctrl) {</div><div id="ww998749" class="NormalCode">            delete m_Ctrl;</div><div id="ww998750" class="NormalCode">            m_Ctrl = 0;</div><div id="ww998751" class="NormalCode">    }</div><div id="ww998752" class="NormalCode">}</div><div id="ww998753" class="NormalCode">    // End Added for Rogue Wave&nbsp;Views.</div><div id="ww998754" class="NormalCode">    return 0;</div><div id="ww998755" class="LastNormalCode">}</div><div id="ww998757" class="Heading4">Test the properties.</div><div id="ww1000974" class="Body">To test the properties, you can use Internet Explorer. With Internet Explorer, you can modify the file <span class="code">DemoATLCtrl.html</span> and use the JavaScript language. </div><div id="ww1001011" class="Body">To test the <span class="code">FileName</span> property, we use a combo box that has three predefined choices. </div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1001024" class="Note"><span class="flag">Note:&nbsp;</span>This example assumes that the Rogue Wave&nbsp;Views data files are installed in the <span class="code">ILVHOME</span> or <span class="code">ILVPATH</span> environment variable paths. </div></td></tr></table></div><div id="ww998765" class="NormalCode">&lt;HEAD&gt;</div><div id="ww998766" class="NormalCode">&lt;TITLE&gt;ATL 3.0 test page for object DemoATLCtrl&lt;/TITLE&gt;</div><div id="ww998767" class="NormalCode">&lt;/HEAD&gt;</div><div id="ww998768" class="NormalCode">&nbsp;</div><div id="ww998769" class="NormalCode">&lt;SCRIPT LANGUAGE = JavaScript&gt;</div><div id="ww998770" class="NormalCode">&nbsp;</div><div id="ww998771" class="NormalCode">function load(value)</div><div id="ww998772" class="NormalCode">{</div><div id="ww998773" class="NormalCode">    DemoATLCtrl.FileName = value;</div><div id="ww998774" class="NormalCode">}</div><div id="ww998775" class="NormalCode">&nbsp;</div><div id="ww998776" class="NormalCode">&lt;/SCRIPT&gt;</div><div id="ww998777" class="NormalCode">&lt;BODY&gt;</div><div id="ww998778" class="NormalCode">&nbsp;</div><div id="ww1012888" class="NormalCode">&lt;SELECT NAME=Files onchange = "load(value)" &gt;</div><div id="ww1012889" class="NormalCode">&lt;OPTION Selected Value="data/browse.ilv"&gt;World</div><div id="ww1012890" class="NormalCode">&lt;OPTION Value="europe.ilv"&gt; Europe</div><div id="ww1012891" class="NormalCode">&lt;OPTION Value="africa.ilv"&gt; Africa</div><div id="ww998783" class="NormalCode">&lt;/SELECT&gt;</div><div id="ww998784" class="NormalCode">&lt;P&gt;</div><div id="ww998785" class="NormalCode">&nbsp;</div><div id="ww998786" class="NormalCode">&lt;OBJECT WIDTH=400 HEIGHT=400 ID="DemoATLCtrl" CLASSID="CLSID:3B10417D-3E6C-</div><div id="ww1006553" class="NormalCode">11D3-B74F-00C04F68A89D"&gt;&lt;/OBJECT&gt;</div><div id="ww998787" class="NormalCode">&lt;/BODY&gt;</div><div id="ww998788" class="LastNormalCode">&lt;/HTML&gt;</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1005906" class="Note"><span class="flag">Note:&nbsp;</span>Since the class id is generated, the class id in your file may be different from the one in this example. </div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>