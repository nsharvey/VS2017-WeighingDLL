<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Implementing Load-on-Demand for a New Data Source</title><link rel="Prev" href="loadondemand.57.13.html" title="Previous" /><link rel="Next" href="readers.58.01.html" title="Next" /><link rel="StyleSheet" href="css/loadondemand.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/loadondemand_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/loadondemand.57.14.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pvw35YpSOhI3tfj37KdxR4Q" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/loadondemand.57.14.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/docfrontcover.html#wwconnect_header">Maps</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/loadondemand.57.01.html#wwconnect_header">Using Load-On-Demand</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current"> Implementing Load-on-Demand for a New Data Source</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww999204" class="Heading1"><span></span> Implementing Load-on-Demand for a New Data Source</div><div id="ww1004470" class="Body">To implement load-on-demand for a new data source, all you have to do is write a specific tile loader that implements the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvTileLoader.html">IlvTileLoader</a></span> abstract class. Notice, however, that for the predefined map formats supplied with Rogue Wave®&nbsp;Views, such as CADRG, load-on-demand has been implemented in a subclass of <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvTiledLayer.html">IlvTiledLayer</a></span> that defines both the tile loader (as a private class) and the tiling parameters appropriate for the concerned format. As far as CADRG is concerned, load-on-demand has been implemented so that tiles are aligned with frames. Predefined formats are described in <a href="../Options/readers.58.01.html#ww1000266" title="Predefined Readers">Predefined Readers</a>.</div><div id="ww999512" class="Body">For your tile loader to be fully efficient, the following requirements should be satisfied:</div><div id="ww999480" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>You should be able to determine which objects are to be loaded on the tile. These objects can be read from a file whose name is known, or be the result of a query to a cartographic database. </div><div id="ww999485" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>You should be able to have a direct random access to data.</div><div id="ww999486" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The size of the data to be loaded should be in proportion to the size of the tiles to allow fast loading. For example, raster images with a size of 100x100 are faster to load than images with a size of 6000x6000. </div><div id="ww999536" class="Body">The following example of a tile loader simulates the loading of two graphic objects, a rectangle, and a label. </div><div id="ww999594" class="Body">The <span class="code">load</span> method takes the tile to be loaded as its parameter. It generates the graphic objects to be displayed within the tile and adds them to the tiled layer by calling the <span class="MethodName"><a href="../RefMan/refcppmaps/classIlvTile.html#ae8430a81df51f522190d29a8781e7ddb">addObject</a></span> method. When loading is complete, it calls the <span class="MethodName"><a href="../RefMan/refcppmaps/classIlvTile.html#a5f1b24192b2f968bf03ebcf1d3c5df35">loadComplete</a></span> method to notify the listeners that the data in the tile is ready for use. </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1007260" class="CodeInTable">&nbsp;</div><div id="ww1007261" class="CodeInTable">class TileLoader</div><div id="ww1007262" class="CodeInTable">    :public IlvTileLoader</div><div id="ww1007263" class="CodeInTable">{</div><div id="ww1007264" class="CodeInTable">public:</div><div id="ww1007265" class="CodeInTable">    TileLoader(IlvDisplay*);</div><div id="ww1007266" class="CodeInTable">    virtual IlvMapsError load(IlvTile* tile);</div><div id="ww1007267" class="CodeInTable">    virtual void release(IlvTile* tile);</div><div id="ww1007268" class="CodeInTable">    virtual IlvBoolean isPersistent() const;</div><div id="ww1007269" class="CodeInTable">private:</div><div id="ww1007270" class="CodeInTable">    IlvDisplay* _display;</div><div id="ww1007271" class="CodeInTable">};</div><div id="ww1007275" class="CodeInTable">&nbsp;</div><div id="ww1007276" class="CodeInTable">IlvMapsError</div><div id="ww1007277" class="CodeInTable">TileLoader::load(IlvTile* tile)</div><div id="ww1007278" class="CodeInTable">{</div><div id="ww1007279" class="CodeInTable">    IlvRect rbbox;</div><div id="ww1007280" class="CodeInTable">    tile-&gt;boundingBox(rbbox);</div><div id="ww1007281" class="CodeInTable">    IlvRectangle *rect = new IlvRectangle(_display, rbbox);</div><div id="ww1007282" class="CodeInTable">    tile-&gt;addObject(rect);</div><div id="ww1007283" class="CodeInTable">&nbsp;</div><div id="ww1007284" class="CodeInTable">    IlString str;</div><div id="ww1007285" class="CodeInTable">    str += "(";</div><div id="ww1007286" class="CodeInTable">    str += tile-&gt;getColumn();</div><div id="ww1007287" class="CodeInTable">    str += ", ";</div><div id="ww1007288" class="CodeInTable">    str += tile-&gt;getRow();</div><div id="ww1007289" class="CodeInTable">    str += ")";</div><div id="ww1007290" class="CodeInTable">    </div><div id="ww1007291" class="CodeInTable">    IlvMapLabel* label = new IlvMapLabel(_display,</div><div id="ww1007292" class="CodeInTable">                                      IlvPoint(),</div><div id="ww1007293" class="CodeInTable">                                      IlvPoint(),</div><div id="ww1007294" class="CodeInTable">                                      IlvCenter,</div><div id="ww1007295" class="CodeInTable">                                      10,</div><div id="ww1007296" class="CodeInTable">                                      str.getValue());    </div><div id="ww1007297" class="CodeInTable">    IlvRect lbbox;</div><div id="ww1007298" class="CodeInTable">    label-&gt;boundingBox(lbbox);</div><div id="ww1007299" class="CodeInTable">    IlvPos cx = rbbox.x() + rbbox.w() / 2;</div><div id="ww1007300" class="CodeInTable">    IlvPos cy = rbbox.y() + rbbox.h() / 2;</div><div id="ww1007301" class="CodeInTable">    label-&gt;move(cx - lbbox.w() / 2,</div><div id="ww1007302" class="CodeInTable">                cy - lbbox.h() / 2);</div><div id="ww1007303" class="CodeInTable">    tile-&gt;addObject(label);</div><div id="ww1007304" class="CodeInTable">     </div><div id="ww1007305" class="CodeInTable">    tile-&gt;loadComplete();</div><div id="ww1007306" class="CodeInTable">    return IlvMaps::NoError();</div><div id="ww1007307" class="CodeInTable">}</div><div id="ww1007008" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1002932" class="Body">Its <span class="code">release</span> method is invoked when the tile cache releases a tile. The <span class="code">tile.deleteAll</span> method clears the tile.</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1007311" class="CodeInTable">&nbsp;</div><div id="ww1007312" class="CodeInTable">void</div><div id="ww1007313" class="CodeInTable">TileLoader::release(IlvTile* tile) {   </div><div id="ww1007314" class="CodeInTable">    tile-&gt;deleteAll();      </div><div id="ww1007315" class="CodeInTable">}</div><div id="ww1007018" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1002933" class="Body"> </div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>