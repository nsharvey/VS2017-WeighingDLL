<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Writing a New Reader</title><link rel="Prev" href="programmingmaps.56.13.html" title="Previous" /><link rel="Next" href="programmingmaps.56.15.html" title="Next" /><link rel="StyleSheet" href="css/programmingmaps.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/programmingmaps_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/programmingmaps.56.14.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pqmhtGWBwuaART1pKSkDrNw" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/programmingmaps.56.14.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/docfrontcover.html#wwconnect_header">Maps</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/programmingmaps.56.01.html#wwconnect_header">Rogue Wave&nbsp;Views Maps Reader Framework </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/programmingmaps.56.12.html#wwconnect_header">Feature Iterators</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Writing a New Reader</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww1008123" class="Heading2"><span></span>Writing a New Reader</div><div id="ww1008126" class="Body">In this section, you will find an example of an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> that you can use to read polylines that were saved in an ASCII file. </div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1008129" class="Note"><span class="flag">Note:&nbsp;</span>The classes that implement the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> abstract class are not necessarily file readers. They can also iterate, for example, the result of a query to a map server. </div></td></tr></table></div><div id="ww1008130" class="Heading3"><span></span>The File to Be Read</div><div id="ww1008131" class="Body">The ASCII file to be read has been created especially for this example. Its format is very simple and its specifications are as follows:</div><div id="ww1010281" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>It has a header specifying its format.</div><div id="ww1008132" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>There is one pair of coordinates (latitude and longitude) per line. These coordinates are expressed in degrees. </div><div id="ww1008133" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Lines can contain comments. These comments, when they exist, are merged to form an attribute.</div><div id="ww1008134" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Polylines are separated by a blank line.</div><div id="ww1008135" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>The file has the <span class="code">.pol</span> extension.</div><div id="ww1008136" class="Body">The ASCII file is shown below:</div><div id="ww1010282" class="NormalCode">#ascii polylines</div><div id="ww1008137" class="NormalCode">-1.0 40.0   A 1x1 degree rectangle centered on the </div><div id="ww1008138" class="NormalCode"> 1.0 40.0    (0,39) point</div><div id="ww1008139" class="NormalCode"> 1.0 38.0</div><div id="ww1008140" class="NormalCode">-1.0 38.0</div><div id="ww1008141" class="NormalCode">-1.0 40.0</div><div id="ww1008142" class="NormalCode">&nbsp;</div><div id="ww1008143" class="NormalCode">0.0  90.0   A meridian extending from the North pole to the South pole</div><div id="ww1008144" class="LastNormalCode">0.0 -90.0</div><div id="ww1008145" class="Heading3"><span></span>The Reader</div><div id="ww1010287" class="Body">This section shows how you can use the reader to read this polyline file.</div><div id="ww1014404" class="Body">The complete source code for this example can be found in the following file:</div><div id="ww1010293" class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; text-transform: none; vertical-align: baseline"><span class="code">&lt;installdir&gt;/samples/maps/userman/src/simplePolylineReader.cpp</span></div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1010292" class="Note"><span class="flag">Note:&nbsp;</span>Only the portions of code that require explanation are here.</div></td></tr></table></div><div id="ww1023923" class="Body">As shown below, the <span class="code">SimplePolylineReader</span> implements the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> abstract class:</div><div id="ww1037282" class="Body">#ifdef IL_STD</div><div id="ww1037283" class="Body">#include &lt;fstream&gt;</div><div id="ww1037284" class="Body">using namespace std;</div><div id="ww1037285" class="Body">#else</div><div id="ww1037286" class="Body">#include &lt;fstream.h&gt;</div><div id="ww1037287" class="Body">#endif</div><div id="ww1037289" class="Body">#include &lt;ilviews/maps/mapfeature.h&gt;</div><div id="ww1037290" class="Body">#include &lt;ilviews/maps/format/mapinput.h&gt;</div><div id="ww1037291" class="Body">#include &lt;ilviews/maps/rendering/curverdr.h&gt;</div><div id="ww1037293" class="Body">class ILVMAPSEXPORTED SimplePolylineReader</div><div id="ww1037294" class="Body">    :public IlvMapFeatureIterator</div><div id="ww1037295" class="Body">{</div><div id="ww1037296" class="Body">public:</div><div id="ww1037297" class="Body">    SimplePolylineReader(IlvDisplay* display,</div><div id="ww1037298" class="Body">                         const char* filename);</div><div id="ww1037299" class="Body">    virtual ~SimplePolylineReader();</div><div id="ww1037300" class="Body">    </div><div id="ww1037301" class="Body">    virtual IlvMapsError getInitStatus() const;</div><div id="ww1037303" class="Body">    virtual const IlvMapFeature* getNextFeature(IlvMapsError&amp; status);</div><div id="ww1037305" class="Body">    virtual IlvBoolean getLowerRightCorner(IlvCoordinate&amp; coordinate) const;</div><div id="ww1037307" class="Body">    virtual IlvBoolean getUpperLeftCorner(IlvCoordinate&amp;) const;</div><div id="ww1037309" class="Body">    IlvFeatureRenderer* getDefaultFeatureRenderer(IlvDisplay *);</div><div id="ww1037311" class="Body">    const IlvProjection* getProjection() const;</div><div id="ww1037313" class="Body">    IlvBoolean emptyLine(const char* line);</div><div id="ww1037315" class="Body">    IlvBoolean readHeader(const char* line);</div><div id="ww1037317" class="Body">    int parseLine(const char* line,</div><div id="ww1037318" class="Body">                  IlvDouble* lng,</div><div id="ww1037319" class="Body">                  IlvDouble* lat,</div><div id="ww1037320" class="Body">                  char* comment);</div><div id="ww1037321" class="Body">    </div><div id="ww1037322" class="Body">    IlvFeatureAttributeProperty* attributes(IlString&amp; buffer,</div><div id="ww1037323" class="Body">                                            IlvMapsError&amp; status);</div><div id="ww1037324" class="Body">    </div><div id="ww1037325" class="Body">    IlvMapFeatureIteratorDeclareClassInfo();</div><div id="ww1037326" class="Body">    </div><div id="ww1037327" class="Body">private:</div><div id="ww1037328" class="Body">    static IlvMapsError _formatError;</div><div id="ww1037329" class="Body">    ifstream _stream;</div><div id="ww1037330" class="Body">    IlvMapLineString* _geometry;</div><div id="ww1037331" class="Body">    IlvMapFeature* _feature;</div><div id="ww1037332" class="Body">    IlvProjection* _projection;</div><div id="ww1037334" class="Body">    IlvDisplay* _display;</div><div id="ww1037335" class="Body">    IlvMapsError _status;</div><div id="ww1037336" class="Body">    static IlvMapsError FormatError();</div><div id="ww1037337" class="Body">    static void Init();</div><div id="ww1037338" class="Body">    const IlvMapFeature* readPolyline(IlvMapsError&amp; status);</div><div id="ww1037339" class="Body">};</div><div id="ww1035445" class="NormalCode" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline">&nbsp;</div><div id="ww1027933" class="Heading3"><span></span>The IlvClassInfo Registration</div><div id="ww1023993" class="Body">The <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvClassInfo.html">IlvClassInfo</a></span> registration is needed to determine the class of an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> (like the one returned by the <span class="MethodName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html#a286a07f9ebf47f0399bdbcfe758eaad1">makeFeatureIterator</a></span> method). To register a new reader class, use the predefined macro:</div><div id="ww1021350" class="LastNormalCode" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 11.0pt; text-transform: none; vertical-align: baseline"><span class="code">IlvMapFeatureIteratorDefineClassInfo(className,superClassName);</span></div><div id="ww1021355" class="Body">where <span class="code">className</span> is the name of the new reader class (<span class="code">SimplePolygonReader</span> in the present example) and <span class="code">superClassName</span> is the name of the superclass (<span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> the present example).</div><div id="ww1021361" class="Body">The <span class="code">IlvMapFeatureIterator</span> class can then be checked in this way:</div><div id="ww1021363" class="NormalCode">IlvMapFeatureIterator* reader; </div><div id="ww1021370" class="NormalCode">......</div><div id="ww1021371" class="NormalCode">IlvClassInfo* readerClass = reader-&gt;getClassInfo();</div><div id="ww1021375" class="NormalCode">if (readerClass-&gt;isSubtypeOf(SimplePolygonReader::ClassInfo())) {</div><div id="ww1021377" class="NormalCode">...</div><div id="ww1021380" class="LastNormalCode">}</div><div id="ww1021333" class="Heading3"><span></span>The Georeferencing Methods</div><div id="ww1021137" class="Body">Since the latitude and the longitude in the polyline file are expressed in degrees, we know that the projection is geographic. This is why the <span class="code">getProjection</span> method returns <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvGeographicProjection.html">IlvGeographicProjection</a></span>. The method <span class="code">getProjection</span> would return <span class="code">null</span> if the projection of the file to be read was unknown. </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1037035" class="Body">SimplePolylineReader::SimplePolylineReader(IlvDisplay* display,</div><div id="ww1037036" class="Body">                                           const char* filename)</div><div id="ww1037037" class="Body">    :_display(display),</div><div id="ww1037038" class="Body">     _status(IlvMaps::NoError()),</div><div id="ww1037039" class="Body">     _stream(filename),</div><div id="ww1037040" class="Body">     _geometry(0),</div><div id="ww1037041" class="Body">     _feature(0),</div><div id="ww1037042" class="Body">     _projection(new IlvGeographicProjection())</div><div id="ww1037043" class="Body">{</div><div id="ww1037044" class="Body">    char line[1024];</div><div id="ww1037045" class="Body">    _stream.getline(line, 1024);</div><div id="ww1037046" class="Body">    if(readHeader(line) == IlvFalse)</div><div id="ww1037047" class="Body">        _status = _formatError;</div><div id="ww1037048" class="Body">}</div><div id="ww1037052" class="Body">const IlvProjection*</div><div id="ww1037053" class="Body">SimplePolylineReader::getProjection() const {</div><div id="ww1037054" class="Body">    return _projection;</div><div id="ww1037055" class="Body">}</div><div id="ww1035134" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1023677" class="Heading3"><span></span>Bounding Box Methods</div><div id="ww1023855" class="Body">Because of the data format, we cannot retrieve the bounding box of the polyline until the whole data has been read. Here, the methods <span class="code">getUpperLeftCorner</span> and <span class="code">getLowerRightCorner</span> return <span class="code">IlvFalse</span> to indicate that these points are not known. Another option we could have taken is to read the whole data, place it in an array, and then compute the bounding box. </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1036926" class="Body">IlvBoolean</div><div id="ww1036927" class="Body">SimplePolylineReader::getLowerRightCorner(IlvCoordinate&amp; c) const {</div><div id="ww1036928" class="Body">    return IlvFalse;</div><div id="ww1036929" class="Body">}</div><div id="ww1036931" class="Body">IlvBoolean</div><div id="ww1036932" class="Body">SimplePolylineReader::getUpperLeftCorner(IlvCoordinate&amp; c) const {</div><div id="ww1036933" class="Body">    return IlvFalse;</div><div id="ww1036934" class="Body">}</div><div id="ww1034992" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1023861" class="Heading3"><span></span>Rendering Methods</div><div id="ww1008181" class="Body">The <span class="code">getDefaultFeatureRenderer</span> method must return a renderer able to transform into graphic objects all the map features read by this feature iterator. The <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvDefaultCurveRenderer.html">IlvDefaultCurveRenderer</a></span> can process map features whose geometry is of type <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLineString.html">IlvMapLineString</a></span>. </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1037173" class="Body">IlvFeatureRenderer*</div><div id="ww1037174" class="Body">SimplePolylineReader::getDefaultFeatureRenderer(IlvDisplay *display) {</div><div id="ww1037175" class="Body">    return new IlvDefaultCurveRenderer(display);</div><div id="ww1037176" class="Body">}</div><div id="ww1035267" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1024524" class="Body">If the geometries of the returned map features are not predefined, but instead, are instances of a derived class, or, if the map feature attributes store drawing parameters to be used in rendering operations such as color or line width, it is necessary to provide renderers whose rendering styles that can process these attributes or derived geometries. See the section <a href="../Options/programmingmaps.56.09.html#ww1008913" title="Creating a Colored Line Renderer">Creating a Colored Line Renderer</a>.</div><div id="ww1008187" class="Heading3"><span></span>The getNextFeature Method</div><div id="ww1008192" class="Body">The <span class="ClassName"></span><span class="code">IlvMapFeatureIterator::getNextFeature</span> method reads the geometry of a map feature and creates an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeature.html">IlvMapFeature</a></span> object that will hold all the information required to process the geometry. The geometry read in the code example that follows is an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLineString.html">IlvMapLineString</a></span>, which is the class to define polyline geometries. </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1036919" class="Body"><span style="font-family: &quot;Microsoft Sans Serif&quot;; font-size: 8.0pt"> </span>const IlvMapFeature*</div><div id="ww1036920" class="Body">SimplePolylineReader::getNextFeature(IlvMapsError&amp; status) {</div><div id="ww1036921" class="Body">    return readPolyline(status);</div><div id="ww1036922" class="Body">}</div></td></tr></table></div><div id="ww1008198" class="Body">The polyline points are read by the private method <span class="code">readPolyline</span>. This method reads each line in the file to extract the coordinates of the points and the related comments, if any. </div><div id="ww1008640" class="Body">It is broken up as follows: </div><div id="ww1019629" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>A geometry of the type <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLineString.html">IlvMapLineString</a></span> is created or reset, which will be associated with the map feature. Notice that, to improve performance, the reader always returns the same instance of <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeature.html">IlvMapFeature</a></span> The geometry will also be allocated only once—when these points are read for the first time, and emptied at each call of <span class="code">getNextFeaure</span>. The map feature returned by the <span class="code">getNextFeature</span> method is volatile, meaning that its geometry and attributes must be used before the method is called again. All the readers provided in the Rogue Wave&nbsp;Views&nbsp;Maps library that implement the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> interface work this way.</div><div id="ww1025958" class="Body"> </div><div class="ww_skin_page_overflow"><table class="CodeL1Table" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 354.33042519685pt"><div id="ww1037014" class="Body">const IlvMapFeature*</div><div id="ww1037015" class="Body">SimplePolylineReader::readPolyline(IlvMapsError&amp; status) {   </div><div id="ww1037017" class="Body">    if(_stream.eof())</div><div id="ww1037018" class="Body">        return 0;</div><div id="ww1037019" class="Body">    </div><div id="ww1037020" class="Body">    if(!_geometry)</div><div id="ww1037021" class="Body">        _geometry = new IlvMapLineString();</div><div id="ww1037022" class="Body">    else</div><div id="ww1037023" class="Body">        _geometry-&gt;removeAll();</div><div id="ww1037024" class="Body">            </div><div id="ww1037025" class="Body">    if(!_feature) {</div><div id="ww1037026" class="Body">        _feature = new IlvMapFeature();</div><div id="ww1037027" class="Body">        _feature-&gt;setGeometry(_geometry);</div><div id="ww1037028" class="Body">        const IlvProjection* proj = getProjection();</div><div id="ww1037029" class="Body">        if(proj)</div><div id="ww1037030" class="Body">            _feature-&gt;setProjection(proj-&gt;copy());</div><div id="ww1037031" class="Body">    }</div><div id="ww1035090" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1019602" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>The line then is read. If end of file is reached, or if an empty line is reached, we return the last feature read.</div><div class="ww_skin_page_overflow"><table class="CodeL1Table" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 354.33042519685pt"><div id="ww1036992" class="Body">char line[1024];</div><div id="ww1036993" class="Body">int first = 1;</div><div id="ww1036994" class="Body">IlString buffer;</div><div id="ww1036995" class="Body">    </div><div id="ww1036996" class="Body">IlvCoordinate c;</div><div id="ww1036998" class="Body">while (1) {        </div><div id="ww1036999" class="Body">    _stream.getline(line, 1024);</div><div id="ww1037001" class="Body">    if(_stream.eof() || emptyLine(line)) {</div><div id="ww1037002" class="Body">        status = IlvMaps::NoError();</div><div id="ww1037003" class="Body">        IlvFeatureAttributeProperty* prop =</div><div id="ww1037004" class="Body">            attributes(buffer, status);</div><div id="ww1037005" class="Body">        if(status != IlvMaps::NoError())</div><div id="ww1037006" class="Body">            IlvWarning(IlvMaps::GetErrorMessage(status, _display));</div><div id="ww1037007" class="Body">        _feature-&gt;setAttributes(prop);</div><div id="ww1037008" class="Body">        buffer = 0;</div><div id="ww1037009" class="Body">        return _feature;       </div><div id="ww1037010" class="Body">    }</div><div id="ww1035065" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1018390" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">3.	</span></span>In the following code, the longitude and latitude points are read with the <span class="code">parseLine</span> method. If a comment is found, it is added to the comment buffer. This buffer is processed by the <span class="code">attributes</span> method described later.</div><div class="ww_skin_page_overflow"><table class="CodeL1Table" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 354.33042519685pt"><div id="ww1036975" class="Body">double x, y;</div><div id="ww1036976" class="Body">char comment[1024];</div><div id="ww1036977" class="Body">int i = parseLine(line, &amp;x, &amp;y, comment);</div><div id="ww1036979" class="Body">if(i &lt; 2) {</div><div id="ww1036980" class="Body">    status = _formatError;</div><div id="ww1036981" class="Body">    return 0;</div><div id="ww1036982" class="Body">}</div><div id="ww1036984" class="Body">c.x(x);</div><div id="ww1036985" class="Body">c.y(y);</div><div id="ww1036987" class="Body">if(i == 3)</div><div id="ww1036988" class="Body">    buffer += comment;</div><div id="ww1035045" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1023683" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">4.	</span></span>Each point read from the file is added to the line string geometry.</div><div class="ww_skin_page_overflow"><table class="CodeL1Table" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 354.33042519685pt"><div id="ww1036895" class="Body"> if(first) {</div><div id="ww1036896" class="Body">            first = 0;</div><div id="ww1036897" class="Body">           _geometry-&gt;setStartPoint(c);</div><div id="ww1036898" class="Body">        } else {</div><div id="ww1036899" class="Body">            _geometry-&gt;lineTo(c);</div><div id="ww1036900" class="Body">        }</div><div id="ww1036901" class="Body">    }</div><div id="ww1036902" class="Body">}</div><div id="ww1034961" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1020026" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">5.	</span></span>The comments are extracted to form attributes, which are associated with the map feature. This is the <span class="code">attributes</span> method.</div><div id="ww1025965" class="Body"> </div><div class="ww_skin_page_overflow"><table class="CodeL1Table" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 355.181102362205pt"><div id="ww1036938" class="Body"><span style="font-family: &quot;Microsoft Sans Serif&quot;; font-size: 8.0pt"> </span>IlvFeatureAttributeProperty*</div><div id="ww1036939" class="Body">SimplePolylineReader::attributes(IlString&amp; buffer, IlvMapsError&amp; status)</div><div id="ww1036940" class="Body">{</div><div id="ww1036941" class="Body">    if(buffer.getLength() == 0)</div><div id="ww1036942" class="Body">        return 0;</div><div id="ww1036944" class="Body">    IlvUInt count = 1;</div><div id="ww1036945" class="Body">    </div><div id="ww1036946" class="Body">    const char* name = "Comment";</div><div id="ww1036948" class="Body">    const IlvMapClassInfo* attClass = IlvStringAttribute::ClassInfo();</div><div id="ww1036949" class="Body">    </div><div id="ww1036950" class="Body">    const IlvBoolean nullable = IlvTrue;</div><div id="ww1036952" class="Body">    IlvFeatureAttributeInfo* info =</div><div id="ww1036953" class="Body">        new IlvFeatureAttributeInfo( count,</div><div id="ww1036954" class="Body">                                     &amp;name,</div><div id="ww1036955" class="Body">                                     &amp;attClass,</div><div id="ww1036956" class="Body">                                     &amp;nullable);</div><div id="ww1036958" class="Body">    const char* val = buffer.getValue();</div><div id="ww1036959" class="Body">    IlvStringAttribute* att =</div><div id="ww1036960" class="Body">        new IlvStringAttribute();</div><div id="ww1036961" class="Body">    att-&gt;setValue(val);</div><div id="ww1036963" class="Body">    IlvFeatureAttributeProperty* prop = </div><div id="ww1036964" class="Body">        new IlvFeatureAttributeProperty(info,</div><div id="ww1036965" class="Body">                                        (IlvFeatureAttribute**)&amp;att,</div><div id="ww1036966" class="Body">                                        status);</div><div id="ww1036968" class="Body">    return prop;</div><div id="ww1036969" class="Body">}</div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>