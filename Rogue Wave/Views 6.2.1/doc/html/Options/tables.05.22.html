<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Subclassing Example</title><link rel="Prev" href="tables.05.21.html" title="Previous" /><link rel="Next" href="tables.05.23.html" title="Next" /><link rel="StyleSheet" href="css/tables.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/tables_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/tables.05.22.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="prPaqtD4Yb5WY3OUuos8cpw" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/tables.05.22.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/dausrfrontcover.html#wwconnect_header">Data Access User Manual</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/dausrpart1.html#ww144909">Rogue Wave&nbsp;Views Data Access Common Framework</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/tables.05.01.html#wwconnect_header">Tables</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/tables.05.20.html#wwconnect_header">Subclassing IliTable </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Subclassing Example</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww999439" class="Heading2"><span></span>Subclassing Example</div><div id="ww999446" class="Body">Here is an example that defines a <span class="code">DirectoryTable</span> class. This class manages files in a directory. Within this example, the member functions that are used to notify the Data Access library when certain events occur appear in bold type.</div><div id="ww1000194" class="NormalCode">#include &lt;dirent.h&gt;</div><div id="ww1002393" class="NormalCode">#include &lt;string.h&gt;</div><div id="ww1002394" class="NormalCode">#include &lt;stdio.h&gt;</div><div id="ww1002395" class="NormalCode">#include &lt;limits.h&gt;</div><div id="ww1002396" class="NormalCode">#include &lt;ilviews/dataccess/table.h&gt;</div><div id="ww1002397" class="NormalCode">&nbsp;</div><div id="ww1002398" class="NormalCode">class DirectoryTable : public IliTable {</div><div id="ww1002399" class="NormalCode">public:</div><div id="ww1002400" class="NormalCode">   enum ColumnTags { FileName = 0 };</div><div id="ww1002401" class="NormalCode">   DirectoryTable(IlvDisplay* dpy, const char* directory) </div><div id="ww1002402" class="NormalCode">     : IliTable(dpy)</div><div id="ww1002403" class="NormalCode">   {</div><div id="ww1002404" class="NormalCode">      _rowsCount = 0;</div><div id="ww1002405" class="NormalCode">      _files = NULL;</div><div id="ww1002406" class="NormalCode">      _directory = dupString(directory);</div><div id="ww1002410" class="NormalCode">      insertColumn(FileName, “FileName”, IliStringType);</div><div id="ww1002411" class="NormalCode">   }</div><div id="ww1002412" class="NormalCode">   ~DirectoryTable() {</div><div id="ww1002413" class="NormalCode">      tidy();</div><div id="ww1002414" class="NormalCode">      delete [] _directory;</div><div id="ww1002415" class="NormalCode">   }</div><div id="ww1002416" class="NormalCode">   void clearRows() { </div><div id="ww1004121" class="NormalCode">      tidy();</div><div id="ww1004151" class="NormalCode">      <span class="codebold" style="font-weight: bold">allRowsDeleted();</span> </div><div id="ww1004175" class="NormalCode">      <span class="codebold" style="font-weight: bold">tableChanged(); </span></div><div id="ww1004177" class="NormalCode">   }</div><div id="ww1002420" class="NormalCode">   IlvBoolean select() {</div><div id="ww1002421" class="NormalCode">      readDir();</div><div id="ww1002422" class="NormalCode">   }</div><div id="ww1002423" class="NormalCode">   IlvBoolean isSelectDone() const {</div><div id="ww1002424" class="NormalCode">      return _files != NULL;</div><div id="ww1002425" class="NormalCode">   }</div><div id="ww1002426" class="NormalCode">   IlvInt getRowsCount() const { </div><div id="ww1002427" class="NormalCode">      return _rowsCount;</div><div id="ww1002428" class="NormalCode">   }</div><div id="ww1002429" class="NormalCode">   IlvBoolean getValue(IlInt rowno, IlvInt colno,</div><div id="ww1002430" class="NormalCode">                       IliValue&amp; value) const {</div><div id="ww1002431" class="NormalCode">      if (rowno &gt;= 0 &amp;&amp; rowno &lt; _rowsCount &amp;&amp; colno == 0) {</div><div id="ww1002432" class="NormalCode">         value = _files[rowno];</div><div id="ww1002433" class="NormalCode">         return IlTrue;</div><div id="ww1002434" class="NormalCode">      }</div><div id="ww1002435" class="NormalCode">      return IlFalse;</div><div id="ww1002436" class="NormalCode">   }</div><div id="ww1002437" class="NormalCode">   IlvBoolean updateRow(IlInt rowno,</div><div id="ww1002438" class="NormalCode">                        IliTableBuffer* buf) {</div><div id="ww1002439" class="NormalCode">      const IliValue&amp; value = buf-&gt;at(FileName);</div><div id="ww1002440" class="NormalCode">      if (rowno &gt;= 0 &amp;&amp; rowno &lt; _rowsCount </div><div id="ww1002441" class="NormalCode">          &amp;&amp; !value.isNull() &amp;&amp; value.getType() == IliStringType) {</div><div id="ww1002442" class="NormalCode">         const char* newname = value.asString();</div><div id="ww1002443" class="NormalCode">         char oldpath[_POSIX_MAX_PATH];</div><div id="ww1002444" class="NormalCode">         char newpath[_POSIX_MAX_PATH];</div><div id="ww1002445" class="NormalCode">         sprintf(oldpath, “%s/%s”, _directory, _files[rowno]);</div><div id="ww1002446" class="NormalCode">         sprintf(newpath, “%s/%s”, _directory, newname);</div><div id="ww1002447" class="NormalCode">         if (rename(oldpath, newpath) == 0) {</div><div id="ww1002448" class="NormalCode">           delete _files[rowno];</div><div id="ww1002449" class="NormalCode">           _files[rowno] = dupString(newname);</div><div id="ww1004186" class="NormalCode">           <span class="codebold" style="font-weight: bold">rowChanged(rowno);</span> </div><div id="ww1002451" class="NormalCode">           return IlTrue;</div><div id="ww1002452" class="NormalCode">         } else {</div><div id="ww1002453" class="NormalCode">&nbsp;</div><div id="ww1002454" class="NormalCode">           IliErrorMessage msg;</div><div id="ww1002455" class="NormalCode">           msg.setApplicationError(strerror(errno));</div><div id="ww1004189" class="NormalCode">           <span class="codebold" style="font-weight: bold">raiseError(msg);</span> </div><div id="ww1002457" class="NormalCode">         }</div><div id="ww1002458" class="NormalCode">      }</div><div id="ww1002459" class="NormalCode">      return IlFalse;</div><div id="ww1002460" class="NormalCode">   }</div><div id="ww1002461" class="NormalCode">   IlvBoolean insertRow(IlInt rowno,</div><div id="ww1002462" class="NormalCode">                        IliTableBuffer* buf) {</div><div id="ww1002463" class="NormalCode">      IliErrorMessage msg;</div><div id="ww1002464" class="NormalCode">      msg.setApplicationError(“Insertion not supported in “</div><div id="ww1002465" class="NormalCode">                              “DirectoryTables”);</div><div id="ww1004192" class="NormalCode">      <span class="codebold" style="font-weight: bold">raiseError(msg);</span> </div><div id="ww1002467" class="NormalCode">      return IlFalse;</div><div id="ww1002468" class="NormalCode">   }</div><div id="ww1002469" class="NormalCode">   IlvBoolean deleteRow (IlInt rowno) {</div><div id="ww1002470" class="NormalCode">      IliErrorMessage msg;</div><div id="ww1002471" class="NormalCode">      msg.setApplicationError(“Deletion not supported in “</div><div id="ww1002472" class="NormalCode">                              “DirectoryTables”);</div><div id="ww1004197" class="NormalCode">      <span class="codebold" style="font-weight: bold">raiseError(msg);</span> </div><div id="ww1002474" class="NormalCode">      return IlFalse;</div><div id="ww1002475" class="NormalCode">   }</div><div id="ww1002476" class="NormalCode">&nbsp;</div><div id="ww1002477" class="NormalCode">private:</div><div id="ww1002478" class="NormalCode">   IlInt _rowsCount;</div><div id="ww1002479" class="NormalCode">   char* _directory;</div><div id="ww1002480" class="NormalCode">   char** _files;</div><div id="ww1002481" class="NormalCode">&nbsp;</div><div id="ww1002482" class="NormalCode">   char* dupString(const char* str) const {</div><div id="ww1002483" class="NormalCode">      char* d = new char[strlen(str) + 1];</div><div id="ww1002484" class="NormalCode">      strcpy(d, str);</div><div id="ww1002485" class="NormalCode">      return d;</div><div id="ww1002486" class="NormalCode">   }</div><div id="ww1002487" class="NormalCode">   void tidy() {</div><div id="ww1002488" class="NormalCode">     for (IlInt i = 0; i &lt; _rowsCount; ++i) </div><div id="ww1002489" class="NormalCode">        delete [] _files[i];</div><div id="ww1002490" class="NormalCode">     delete [] _files;</div><div id="ww1002491" class="NormalCode">     _files = NULL;</div><div id="ww1002492" class="NormalCode">     _rowsCount = 0;</div><div id="ww1002493" class="NormalCode">   }</div><div id="ww1002494" class="NormalCode">   IlBoolean readDir() {</div><div id="ww1002495" class="NormalCode">     DIR *dir = opendir(_directory);</div><div id="ww1002496" class="NormalCode">     if (dir != NULL) {</div><div id="ww1002497" class="NormalCode">       tidy();</div><div id="ww1002498" class="NormalCode">       struct dirent* entry;</div><div id="ww1002499" class="NormalCode">       while ((entry = readdir(dir)) != NULL)</div><div id="ww1002500" class="NormalCode">          _rowsCount++;</div><div id="ww1002501" class="NormalCode">       _files = new char*[_rowsCount];</div><div id="ww1002502" class="NormalCode">       rewinddir(dir);</div><div id="ww1002503" class="NormalCode">       _rowsCount = 0;</div><div id="ww1002504" class="NormalCode">       while ((entry = readdir(dir)) != NULL)</div><div id="ww1002505" class="NormalCode">          _files[_rowsCount++] = dupString(entry-&gt;d_name);</div><div id="ww1002506" class="NormalCode">       closedir(dir);</div><div id="ww1004204" class="NormalCode">       <span class="codebold" style="font-weight: bold">tableChanged(); </span></div><div id="ww1002508" class="NormalCode">       return IlTrue;</div><div id="ww1002509" class="NormalCode">     }</div><div id="ww1002510" class="NormalCode">     IliErrorMessage msg;</div><div id="ww1002511" class="NormalCode">     msg.setApplicationError(strerror(errno));</div><div id="ww1004209" class="NormalCode">     <span class="codebold" style="font-weight: bold">raiseError(msg);</span> </div><div id="ww1002513" class="NormalCode">     IlFalse;</div><div id="ww1002514" class="NormalCode">   }</div><div id="ww1005988" class="LastNormalCode">};</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1005991" class="Note"><span class="flag">Note:&nbsp;</span>This example applies only to systems where the <span class="code">opendir</span>, <span class="code">readdir</span>, and <span class="code">closedir</span> functions are defined. For other systems, you may have to make some changes in order to call the appropriate functions.</div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>