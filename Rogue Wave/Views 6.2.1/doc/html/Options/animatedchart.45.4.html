<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Improving Performance When Adding Data Points to a Chart</title><link rel="Prev" href="animatedchart.45.3.html" title="Previous" /><link rel="Next" href="animatedchart.45.5.html" title="Next" /><link rel="StyleSheet" href="css/animatedchart.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/animatedchart_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/animatedchart.45.4.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pNMpONcBssGlpUrLb6yW39A" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/animatedchart.45.4.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/chusrfrontcover.html#wwconnect_header">Charts</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/chusrpart2.html#ww145481">Using the Charts Library </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/animatedchart.45.1.html#wwconnect_header">Using Charts to Display Real-Time Data</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Improving Performance When Adding Data Points to a Chart </span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww1026509" class="Heading1"><span></span>Improving Performance When Adding Data Points to a Chart </div><div id="ww1026503" class="Body">By default, each time a data point is added to a data set, the chart is updated immediately. The area of the chart where the graphical representation of the new data point should be displayed is first invalidated and then redrawn by the holder of the chart. The holder is an instance of the <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvGraphicHolder.html">IlvGraphicHolder</a></span> class and can be retrieved for a given graphic object by the <span class="code">getHolder</span> method.</div><div id="ww1026813" class="Body">If you look at our example, the redrawing of the chart that is required by adding the data points will be performed three times (one time for each data set that is modified) since we add a data point to three data sets at each period of the timer. </div><div id="ww1026577" class="Body">There are several methods that you can use to improve performance when adding data points to a chart:</div><div id="ww1026579" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Use the <span class="code">initReDraws</span> and <span class="code">reDrawViews</span> methods of the holder of the chart.</div><div id="ww1026578" class="IndentedL1">This allows you to perform the redraw operation for all the data sets at one time instead of performing the redraw operation for each data set to which a data point is added.</div><div id="ww1026583" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Use the fast scroll mode of the chart.</div><div id="ww1026584" class="IndentedL1">This allows you to draw the graphical representation of the newly added data point directly in the drawing port without going through the holder of the chart.</div><div id="ww1026585" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Batch the modifications when adding new data points to a data set.</div><div id="ww1035244" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Use an <span class="ClassName"><a href="../RefMan/refcppcharts/classIlvChartCyclicPointSet.html">IlvChartCyclicPointSet</a></span> data set.</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1026617" class="Note"><span class="flag">Note:&nbsp;</span>Batching modifications can be used alone or can be used in conjunction with the use of the fast scroll mode. </div></td></tr></table></div><div id="ww1026586" class="Heading3"><span></span>Using initReDraws and reDrawViews Methods</div><div id="ww1026492" class="Body">The <span class="code">initReDraws</span> and <span class="code">reDrawViews</span> methods allow you to specify that the redraw operation required by adding data points should be performed only one time. To use these methods, you need to do the following:</div><div id="ww1026497" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add a call to the <span class="code">initReDraws</span> method of the chart holder before the loop that adds a data point to each data set.</div><div id="ww1026498" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add a call to the <span class="code">reDrawViews</span> method of the chart holder after the loop that adds a data point to each data set.</div><div id="ww1026499" class="Body">In our scrolling example, each time a data point is added to a data set, the area of the chart that must be redrawn is simply invalidated and the redrawing required for the newly added data points for a given period of the timer will be performed one time when the <span class="code">reDrawViews</span> method is called.</div><div id="ww1026501" class="Body">In our example, the method that is called at each period of the timer is now: </div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1036617" class="CodeInTable">static void</div><div id="ww1036618" class="CodeInTable">AddPoints(IlvTimer* timer, IlAny arg)</div><div id="ww1036619" class="CodeInTable">    // Timer callback to add points.</div><div id="ww1036620" class="CodeInTable">{</div><div id="ww1036621" class="CodeInTable">    IlvChartGraphic* chart = (IlvChartGraphic*)arg;</div><div id="ww1036622" class="CodeInTable">    chart-&gt;getHolder()-&gt;initReDraws();</div><div id="ww1036623" class="CodeInTable">&nbsp;</div><div id="ww1036624" class="CodeInTable">    IlvDisplay* display = timer-&gt;getDisplay();</div><div id="ww1036625" class="CodeInTable">    IlUInt count;</div><div id="ww1036626" class="CodeInTable">    IlvDoublePoint previousPoint;</div><div id="ww1036627" class="CodeInTable">    IlvDoublePoint nextPoint;</div><div id="ww1036628" class="CodeInTable">    IlvChartDataSet* dataSet;</div><div id="ww1036629" class="CodeInTable">    // Add one point on each dataSet.</div><div id="ww1036630" class="CodeInTable">    for (IlvUInt i = 0; i &lt; chart-&gt;getDataSetsCount(); i++) {</div><div id="ww1036631" class="CodeInTable">        dataSet = chart-&gt;getDataSet(i);</div><div id="ww1036632" class="CodeInTable">        count = dataSet-&gt;getDataCount();</div><div id="ww1036633" class="CodeInTable">        // Get the previous data point to have a smooth random creation.</div><div id="ww1036634" class="CodeInTable">        if (count != 0) {</div><div id="ww1036635" class="CodeInTable">            dataSet-&gt;getPoint(count-1, previousPoint);</div><div id="ww1036636" class="CodeInTable">&nbsp;</div><div id="ww1036637" class="CodeInTable">            // Create a new data point.</div><div id="ww1036638" class="CodeInTable">            GeneratePoint(previousPoint, nextPoint);</div><div id="ww1036639" class="CodeInTable">        }</div><div id="ww1036640" class="CodeInTable">        else {</div><div id="ww1036641" class="CodeInTable">            nextPoint.x(0);</div><div id="ww1036642" class="CodeInTable">            nextPoint.y(i+0.5);</div><div id="ww1036643" class="CodeInTable">        }</div><div id="ww1036644" class="CodeInTable">&nbsp;</div><div id="ww1036645" class="CodeInTable">        // Add the data point to the data set.</div><div id="ww1036646" class="CodeInTable">        dataSet-&gt;addPoint(nextPoint);</div><div id="ww1036647" class="CodeInTable">    }</div><div id="ww1036648" class="CodeInTable">&nbsp;</div><div id="ww1036649" class="CodeInTable">    chart-&gt;getHolder()-&gt;reDrawViews();</div><div id="ww1036499" class="CodeInTable">}</div></td></tr></table></div><div id="ww1026816" class="Body">The complete source code can be found in the <span class="code">scroll2.cpp</span> file located in the <span class="code">$ILVHOME/samples/charts/userman/src</span> directory.</div><div id="ww1026590" class="Heading3"><span></span>Using the Fast Scroll Mode </div><div id="ww1026603" class="Body">Using the fast scroll mode is another way to improve performance. This is done by calling the method <span class="ClassName"><a href="../RefMan/refcppcharts/classIlvChartGraphic.html">IlvChartGraphic</a></span><span class="code">::enableFastScroll</span> with <span class="code">IlvTrue</span> as a parameter. Each time a data point is added to a data set, the graphical representation of the newly added data point is drawn directly in the drawing port without going through the holder of the chart. </div><div id="ww1030905" class="Body">Although fast scroll mode speeds the drawing operations, it has several limitations:</div><div id="ww1026658" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>There must be no other graphic objects underneath the chart object.</div><div id="ww1026880" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>Using displayers that display filled polygonal representations, such as polygon and stair displayers, should be avoided since an additional vertical line is drawn for each polygonal representation of an added data point.</div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1026638" class="Note"><span class="flag">Note:&nbsp;</span>The fast scroll mode can be used only with the <span class="code">IlvScrollModeShift</span> scroll mode.</div></td></tr></table></div><div id="ww1026593" class="Heading3"><span></span>Batching Modifications </div><div id="ww1026595" class="Body">You can drastically improve performance by using a batch operation when adding new data points to a data set. This is especially useful when it is not necessary to see the updates resulting from adding the new data points one by one as they occur. To batch the modifications, do the following:</div><div id="ww1026686" class="Numbered1"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">1.	</span></span>Add a call to the <span class="ClassName"><a href="../RefMan/refcppcharts/classIlvChartDataSet.html">IlvChartDataSet</a></span><span class="code">::startBatch</span> method on the data set before a set of additions of data points is performed on the data set.</div><div id="ww1026688" class="IndentedL1">Once the <span class="code">IlvChartDataSet::startBatch</span> method has been called, the updates resulting from adding new data points are no longer performed.</div><div id="ww1026687" class="Numbered"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span class="number">2.	</span></span>Add a call to the <span class="code">IlvChartDataSet::endBatch</span> method on the data set after a set of additions of data points has been performed on the data set.</div><div id="ww1026708" class="IndentedL1">When the <span class="code">IlvChartDataSet::endBatch</span> method is called, all the data points that have been added since the call to the <span class="code">IlvChartDataSet::startBatch</span> method are processed at one time. The update resulting from the addition of all these data points is performed at one time. The newly added data points are drawn all at one time, instead of being drawn one by one as is the case when the modifications are not batched.</div><div id="ww1026724" class="Body">In our example, the method that is called at each period of the timer is now:</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1036654" class="CodeInTable">static void</div><div id="ww1036655" class="CodeInTable">AddPoints(IlvTimer* timer, IlAny arg)</div><div id="ww1036656" class="CodeInTable">    // Timer callback to add points.</div><div id="ww1036657" class="CodeInTable">{</div><div id="ww1036658" class="CodeInTable">    IlvChartGraphic* chart = (IlvChartGraphic*)arg;</div><div id="ww1036659" class="CodeInTable">&nbsp;</div><div id="ww1036660" class="CodeInTable">    IlvDisplay* display = timer-&gt;getDisplay();</div><div id="ww1036661" class="CodeInTable">    IlUInt count;</div><div id="ww1036662" class="CodeInTable">    IlvDoublePoint previousPoint;</div><div id="ww1036663" class="CodeInTable">    IlvDoublePoint nextPoint;</div><div id="ww1036664" class="CodeInTable">    IlvChartDataSet* dataSet;</div><div id="ww1036665" class="CodeInTable">    // Add one point on each dataSet.</div><div id="ww1036666" class="CodeInTable">    for (IlUInt i = 0; i &lt; chart-&gt;getDataSetsCount(); i++) {</div><div id="ww1036667" class="CodeInTable">        dataSet = chart-&gt;getDataSet(i);</div><div id="ww1036668" class="CodeInTable">&nbsp;</div><div id="ww1036669" class="CodeInTable">        dataSet-&gt;startBatch();</div><div id="ww1036670" class="CodeInTable">&nbsp;</div><div id="ww1036671" class="CodeInTable">        count = dataSet-&gt;getDataCount();</div><div id="ww1036672" class="CodeInTable">        for (IlUInt k = 0; k &lt; NbAddedPts; k++, count++) {</div><div id="ww1036673" class="CodeInTable">            // Get the previous data point to have a smooth random creation.</div><div id="ww1036674" class="CodeInTable">            if (count != 0) {</div><div id="ww1036675" class="CodeInTable">                dataSet-&gt;getPoint(count-1, previousPoint);</div><div id="ww1036676" class="CodeInTable">&nbsp;</div><div id="ww1036677" class="CodeInTable">                // Create a new data point.</div><div id="ww1036678" class="CodeInTable">                GeneratePoint(previousPoint, nextPoint);</div><div id="ww1036679" class="CodeInTable">            }</div><div id="ww1036680" class="CodeInTable">            else {</div><div id="ww1036681" class="CodeInTable">                nextPoint.x(0);</div><div id="ww1036682" class="CodeInTable">                nextPoint.y(i+0.5);</div><div id="ww1036683" class="CodeInTable">            }</div><div id="ww1036684" class="CodeInTable">&nbsp;</div><div id="ww1036685" class="CodeInTable">            // Add the data point to the data set.</div><div id="ww1036686" class="CodeInTable">            dataSet-&gt;addPoint(nextPoint);</div><div id="ww1036687" class="CodeInTable">        }</div><div id="ww1036688" class="CodeInTable">&nbsp;</div><div id="ww1036689" class="CodeInTable">        dataSet-&gt;endBatch();</div><div id="ww1036690" class="CodeInTable">    }</div><div id="ww1036541" class="CodeInTable">}</div></td></tr></table></div><div id="ww1026823" class="Body">The complete source code can be found in the <span class="code">scroll3.cpp</span> file located in the <span class="code">$ILVHOME/samples/charts/userman/src</span> directory. In this source code, we use both the fast scroll mode and the batching modifications method when adding new data points.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>