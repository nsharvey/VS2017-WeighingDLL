<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Query Mode</title><link rel="Prev" href="sqldatasources.11.1.html" title="Previous" /><link rel="Next" href="sqldatasources.11.3.html" title="Next" /><link rel="StyleSheet" href="css/sqldatasources.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/sqldatasources_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/sqldatasources.11.2.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pIi23uJqmrRnvbjWLh9Nruw" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/sqldatasources.11.2.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/dausrfrontcover.html#wwconnect_header">Data Access User Manual</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/dausrpart2.html#ww144909">Data Access and SQL</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/sqldatasources.11.1.html#wwconnect_header">SQL Data Sources </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Query Mode</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww999644" class="Heading1"><span></span>Query Mode</div><div id="ww999614" class="Body">The <span class="ClassName"><a href="../RefMan/refcppdataccess/classIliDataSource.html">IliDataSource</a></span> and <span class="ClassName"><a href="../RefMan/refcppdataccess/classIliSQLTable.html">IliSQLTable</a></span> classes support query mode. </div><div id="ww999615" class="Body">When query mode is entered, the data source substitutes a memory table for the SQL table (see <span class="MethodName"><a href="../RefMan/refcppdataccess/classIliDataSource.html#a3c151f18440f9af4fb7b5786b32ffcd0">switchToQueryMode</a></span>). This memory table has the same number of columns as the SQL table, but it differs in that all columns in the memory table have a String type. The user can then edit the contents of the memory table through the same set of gadgets that are used to edit the SQL table in regular (nonquery) mode.</div><div id="ww999617" class="Body">Each column of a memory table can contain: </div><div id="ww999618" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>A literal value (implying the = relational operator)</div><div id="ww999619" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>A value containing the SQL wildcard character  % or the underscore character “_” (implying the LIKE SQL operator)</div><div id="ww999621" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>An SQL condition such as:</div><div id="ww999622" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>NULL or IS NULL </div><div id="ww999623" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>NOT NULL or IS NOT NULL </div><div id="ww999624" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>LIKE ‘a pattern’</div><div id="ww999625" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>NOT LIKE ‘a pattern’</div><div id="ww999626" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>BETWEEN _literal_value AND another_literal_value</div><div id="ww999627" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>= a_literal_value</div><div id="ww999628" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>&lt;&gt; a_literal_value</div><div id="ww999629" class="Bulleted"><span class="WebWorks_Number" style="width: 11.338582677165192pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span>&lt; _literal_value</div><div id="ww999630" class="Body">A memory table can contain more than one row. All conditions that appear on the same line will be combined with an AND operator when the query is applied. Conditions that appear on different lines will be combined with an OR operator.</div><div id="ww999631" class="Body">Then, the user can apply the query (see <span class="MethodName"><a href="../RefMan/refcppdataccess/classIliDataSource.html#ae49c7b7a4a0a9e7d270b8807e32c2e14">applyQueryMode</a></span>), which will synthesize a portion of the WHERE clause based on the contents of the memory table. This WHERE clause will then be assigned to the SQL table by calling the <span class="MethodName"><a href="../RefMan/refcppdataccess/classIliSQLTable.html#a1891a417bb0e79c750e652db69155d14">setQueryConjunct</a></span> member function. The <span class="ClassName"><a href="../RefMan/refcppdataccess/classIliTable.html">IliTable</a></span><span class="code">::select</span> member function will be called and the data source will revert to using the SQL table instead of the memory table so that all connected gadgets show the contents of the SQL table.</div><div id="ww999632" class="Body">Alternatively, the user can cancel the query (see <span class="MethodName"><a href="../RefMan/refcppdataccess/classIliDataSource.html#a3d1da788570a63ff37e3947835977d7f">cancelQueryMode</a></span>), which simply reverts to using the SQL table instead of the memory table so that all connected gadgets show the contents of the SQL table.</div><div id="ww999633" class="Body">The <span class="ClassName"><a href="../RefMan/refcppdataccess/classIliDbNavigator.html">IliDbNavigator</a></span> gadget has been upgraded to optionally contain a QueryMode button. </div><div class="ww_skin_page_overflow"><div id="ww999660" class="Startplain"><img class="Default" src="../Options/images/NavigQueryMode.gif" width="100%" style="display: block; left: 0.0pt; max-height: 48px; max-width: 93px; top: 0.0pt" alt="" /></div></div><div id="ww999661" class="Body">The QueryMode button is labelled with a question mark (?). When the QueryMode button is clicked, the SQL data source switches to query mode. When in query mode, the Validate (V) and Cancel (X) buttons of the navigator behave differently than when in regular mode. Clicking on the Validate navigator button applies query mode and clicking on the Cancel navigator button cancels query mode.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>