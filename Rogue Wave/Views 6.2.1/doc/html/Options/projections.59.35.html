<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>Defining the Sample Class, the Main Function, and the Constructor</title><link rel="Prev" href="projections.59.34.html" title="Previous" /><link rel="Next" href="projections.59.36.html" title="Next" /><link rel="StyleSheet" href="css/projections.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/projections_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/projections.59.35.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pN7deNjvWIXIZ5iZSx_002btik_002bQ" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/projections.59.35.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/docfrontcover.html#wwconnect_header">Maps</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/projections.59.01.html#wwconnect_header">Map Projections</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/projections.59.33.html#wwconnect_header">Adding Graphic Objects on Top of an Imported Map</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">Defining the Sample Class, the Main Function, and the Constructor</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww1013772" class="Heading2"><span></span>Defining the Sample Class, the Main Function, and the Constructor</div><div id="ww1013857" class="Heading3"><span></span>The Class</div><div id="ww1013858" class="Body">The sample is implemented as a class, <span class="code">SimpleMapViewer</span>, that will load the map and create the cities.</div><div id="ww1013835" class="Body">It contains the following fields:</div><div id="ww1013836" class="NormalCode">  private:</div><div id="ww1013839" class="NormalCode">    IlvGadgetContainer* _container;</div><div id="ww1013840" class="NormalCode">    IlvSCManagerRectangle* _managerRectangle;</div><div id="ww1013841" class="NormalCode">    IlvMapInfo* _mapInfo;</div><div id="ww1013842" class="LastNormalCode">    IlvTextField* _statusBar;</div><div id="ww1013849" class="Body">Where <span class="code">_container</span> is the top window of this application.  <span class="code">_managerRectangle</span> combines an <span class="ClassName"><a href="../RefMan/refcppmanager/classIlvManager.html">IlvManager</a></span> and an <span class="code">IlvView.</span> <span class="code">_mapinfo</span> field is an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapInfo.html">IlvMapInfo</a></span> instance that stores the informations to convert coordinates from cartographic coordinate system to the manager coordinate system. As map information is saved along with <span class="code">.ilv</span> files, this field is initialized when our map file is loaded so that we can use it to place cities on the map and display the geographic coordinates corresponding to the position of the mouse pointer on the map. These geographic coordinates are stored in an <span class="ClassName"><a href="../RefMan/refcppgadgets/classIlvTextField.html">IlvTextField</a></span> that acts as a status bar.</div><div id="ww1013861" class="Heading3"><span></span>The Main Function</div><div id="ww1013866" class="Body">The main function initialize the <span class="ClassName"><a href="../RefMan/refcppfoundation/classIlvDisplay.html">IlvDisplay</a></span>, creates an instance of our <span class="code">SimpleMapViewer</span> class, then goes into the main loop of Rogue Wave&nbsp;Views.</div><div id="ww1013868" class="NormalCode">int main(int, char**)</div><div id="ww1013871" class="NormalCode">{</div><div id="ww1013872" class="NormalCode">    IlvDisplay* display = new IlvDisplay("Map Viewer");</div><div id="ww1013874" class="NormalCode">    if (display-&gt;isBad()) {</div><div id="ww1013875" class="NormalCode">        IlvPrint("Cannot create the display");</div><div id="ww1013876" class="NormalCode">        return 1;</div><div id="ww1013877" class="NormalCode">    }</div><div id="ww1013879" class="NormalCode">    SimpleMapViewer*  viewer = new SimpleMapViewer(display,</div><div id="ww1013888" class="NormalCode">                                                   "../data/usa.ilv");</div><div id="ww1013881" class="NormalCode">    IlvMainLoop();</div><div id="ww1013883" class="NormalCode">    return 0;</div><div id="ww1013884" class="LastNormalCode">}</div><div id="ww1013865" class="Heading3"><span></span>The Constructor</div><div id="ww1013862" class="Body">The constructor of <span class="code">SimpleMapViewer</span> performs two actions: it creates the interface components of our class, then loads the map data.</div><div id="ww1013863" class="NormalCode">SimpleMapViewer::SimpleMapViewer(IlvDisplay* display,</div><div id="ww1013913" class="NormalCode">                                 const char* fileName)</div><div id="ww1013896" class="NormalCode">    :_managerRectangle(0),</div><div id="ww1013897" class="NormalCode">     _statusBar(0),</div><div id="ww1013898" class="NormalCode">     _container(0),</div><div id="ww1013899" class="NormalCode">     _mapInfo(0)</div><div id="ww1013900" class="NormalCode">   </div><div id="ww1013901" class="NormalCode">{</div><div id="ww1013902" class="NormalCode">    createGUI(display);</div><div id="ww1013903" class="NormalCode">    loadMap(fileName);</div><div id="ww1013904" class="LastNormalCode">}</div><div id="ww1013893" class="Body">The <span class="code">createGUI</span> method creates an instance of <span class="ClassName"><a href="../RefMan/refcppgadgets/classIlvGadgetContainer.html">IlvGadgetContainer</a></span> that is the top view of our application, then call the methods to create the manager rectangle containing the map and to create the tool bar:</div><div id="ww1013914" class="NormalCode">void</div><div id="ww1013917" class="NormalCode">SimpleMapViewer::createGUI(IlvDisplay* display)</div><div id="ww1013918" class="NormalCode">{</div><div id="ww1013919" class="NormalCode">    _container = new IlvGadgetContainer(display,</div><div id="ww1013939" class="NormalCode">                                        â€œSimpleMapViewer",</div><div id="ww1013938" class="NormalCode">                                        "Integrating projections and graphics",</div><div id="ww1013953" class="NormalCode">                                        IlvRect(50, 50, 450, 450),</div><div id="ww1013961" class="NormalCode">                                        IlFalse);</div><div id="ww1013925" class="NormalCode">    _container-&gt;setDestroyCallback(_exit, this);</div><div id="ww1013926" class="NormalCode">    createManagerRectangle(_container);</div><div id="ww1013927" class="NormalCode">    createStatusBar(_container);</div><div id="ww1013928" class="LastNormalCode">}</div><div id="ww1013864" class="Body">The <span class="code">createManagerRectangle</span> method creates the manager to store the map, and initialize the view:</div><div id="ww1013962" class="NormalCode">void</div><div id="ww1013964" class="NormalCode">SimpleMapViewer::createManagerRectangle(IlvGadgetContainer* container)</div><div id="ww1013965" class="NormalCode">{</div><div id="ww1013966" class="NormalCode">    _managerRectangle = new IlvSCManagerRectangle(container-&gt;getDisplay(),</div><div id="ww1013986" class="NormalCode">                                                  IlvRect(0, 0, 450, 435));</div><div id="ww1013991" class="NormalCode">    container-&gt;addObject(_managerRectangle);</div><div id="ww1013992" class="NormalCode">&nbsp;</div><div id="ww1013993" class="NormalCode">    // Attachments.</div><div id="ww1013972" class="NormalCode">    container-&gt;getHolder()-&gt;attach(_managerRectangle, IlvHorizontal);</div><div id="ww1013973" class="NormalCode">    container-&gt;getHolder()-&gt;attach(_managerRectangle, IlvVertical);</div><div id="ww1013974" class="NormalCode">&nbsp;</div><div id="ww1013975" class="NormalCode">    IlvManager* manager = _managerRectangle-&gt;getManager();</div><div id="ww1013976" class="NormalCode">    IlvView* view = _managerRectangle-&gt;getView();</div><div id="ww1013977" class="NormalCode">&nbsp;</div><div id="ww1013978" class="NormalCode">    manager-&gt;setKeepingAspectRatio(view, IlTrue);</div><div id="ww1013979" class="NormalCode">    manager-&gt;setDoubleBuffering(view, IlTrue);</div><div id="ww1013980" class="LastNormalCode">}</div><div id="ww1013996" class="Body">Then the <span class="code">createStatusBar</span> method creates and attach the <span class="ClassName"><a href="../RefMan/refcppgadgets/classIlvTextField.html">IlvTextField</a></span>, used as a status bar:</div><div id="ww1013998" class="NormalCode">void</div><div id="ww1014001" class="NormalCode">SimpleMapViewer::createStatusBar(IlvGadgetContainer* container)</div><div id="ww1014002" class="NormalCode">{</div><div id="ww1014003" class="NormalCode">    _statusBar = new IlvTextField(container-&gt;getDisplay(),</div><div id="ww1014023" class="NormalCode">                                  "",</div><div id="ww1014028" class="NormalCode">                                  IlvRect(0, 435, 450, 15));</div><div id="ww1014006" class="NormalCode">    container-&gt;addObject(_statusBar, IlTrue);</div><div id="ww1014007" class="NormalCode">&nbsp;</div><div id="ww1014008" class="NormalCode">    _statusBar-&gt;setEditable(IlFalse);</div><div id="ww1014009" class="NormalCode">&nbsp;</div><div id="ww1014010" class="NormalCode">    // Attachments.</div><div id="ww1014011" class="NormalCode">    container-&gt;getHolder()-&gt;attach(_statusBar, IlvHorizontal);</div><div id="ww1014012" class="NormalCode">    container-&gt;getHolder()-&gt;attach(_statusBar, IlvVertical, 1, 0, 0);</div><div id="ww1014014" class="LastNormalCode">}</div><div id="ww1013997" class="Body">When the graphic interface is ready, we can load the map.</div><div id="ww1014032" class="NormalCode">void</div><div id="ww1014034" class="NormalCode">SimpleMapViewer::loadMap(const char* fileName)</div><div id="ww1014035" class="NormalCode">{</div><div id="ww1014036" class="NormalCode">    IlvManager* manager = _managerRectangle-&gt;getManager();</div><div id="ww1014037" class="NormalCode">    IlvView* view = _managerRectangle-&gt;getView();</div><div id="ww1014038" class="NormalCode">    manager-&gt;read(fileName);</div><div id="ww1014039" class="NormalCode">    _mapInfo = IlvMapInfo::Get(manager);</div><div id="ww1014040" class="NormalCode">    if (_mapInfo) {</div><div id="ww1014050" class="NormalCode">        view-&gt;setInputCallback(_showMousePosition, this);</div><div id="ww1014055" class="NormalCode">        addCities();</div><div id="ww1014043" class="NormalCode">    }</div><div id="ww1014044" class="NormalCode">    manager-&gt;fitTransformerToContents(view, IlTrue);</div><div id="ww1014045" class="LastNormalCode">}</div><div id="ww1014056" class="Body">After the map has been loaded, we store the map info that was stored in the <span class="code">.ilv</span> file in our <span class="code">_mapinfo</span> field, install an input callback to show mouse position, then add the cities.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright Â© 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>