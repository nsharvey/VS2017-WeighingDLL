<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- RW Customization - favicon file --><link rel="shortcut icon" href="connect/favicon.ico" /><title>The Map Loader</title><link rel="Prev" href="programmingmaps.56.17.html" title="Previous" /><link rel="Next" href="programmingmaps.56.19.html" title="Next" /><link rel="StyleSheet" href="css/programmingmaps.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/programmingmaps_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../views.html#page/Options/programmingmaps.56.18.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-111257570-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body id="pOnn4QHmP3fNJ8jPYlvKd6Q" class="ww_skin_page_body" onload="Page.OnLoad('../views.html#page/Options/programmingmaps.56.18.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Options/docfrontcover.html#wwconnect_header">Maps</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/programmingmaps.56.01.html#wwconnect_header">Rogue Wave&nbsp;Views Maps Reader Framework </a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_parent"><a href="../Options/programmingmaps.56.16.html#wwconnect_header">Loading Maps into Rogue Wave&nbsp;Views</a></span><span class="ww_skin_breadcrumbs_divider"> &gt; </span><span class="ww_skin_breadcrumbs_current">The Map Loader</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="ww1010343" class="Heading2"><span></span>The Map Loader</div><div id="ww1007737" class="Body">The package <span class="code">format</span> provides the class <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html">IlvMapLoader</a></span> that you can use to load in a very simple way any file format for which Rogue Wave&nbsp;Views provides a predefined reader (Shapefile, DTED, CADRG, and so on). These predefined readers are described in the <a href="../Options/readers.58.01.html#ww1000266" title="Predefined Readers">Predefined Readers</a>. </div><div id="ww1010413" class="Body">This section covers the following topics:</div><div id="ww1010414" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Options/programmingmaps.56.18.html#ww1010410" title="The Map Loader">Loading a Predefined Map Format</a></div><div id="ww1010419" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Options/programmingmaps.56.18.html#ww1024605" title="The Map Loader">Loading Nongeoreferenced Files</a></div><div id="ww1010423" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Options/programmingmaps.56.18.html#ww1008040" title="The Map Loader">Specifying a Renderer</a></div><div id="ww1010428" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Options/programmingmaps.56.18.html#ww1008747" title="The Map Loader">Extending the IlvMapLoader Class</a></div><div id="ww1010433" class="Itemize"><span class="WebWorks_Number" style="width: 14.173228346456696pt"><span><img src="bullet.gif" alt="*" border="0" width="8" height="8" /></span></span><a href="../Options/programmingmaps.56.18.html#ww1008747" title="The Map Loader">Extending the IlvMapLoader Class</a></div><div id="ww1010410" class="Heading3"><span></span>Loading a Predefined Map Format</div><div id="ww1026119" class="Body">To load a predefined map format, use the following method:</div><div id="ww1026133" class="Body"><span class="code">load(const char* fileName, IlvMapsError&amp; status)</span> </div><div id="ww1026124" class="Body">This method first tries to determine the file format according to the naming rules set forth in the specifications of the different formats, and initializes the appropriate reader. The method then loads the map into the manager associated with the map loader. </div><div id="ww1007801" class="Body">The following example shows how to import a map file into a Rogue Wave&nbsp;Views manager using the map loader. This file can be either a Shapefile file, a CADRG file, or a DTED file:</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1037196" class="Body">IlvMapLoader* loader = new IlvMapLoader(&amp;manager);</div><div id="ww1037197" class="Body">IlvMapsError status = IlvMaps::NoError();</div><div id="ww1037198" class="Body">loader-&gt;load(filename, status);</div><div id="ww1037199" class="Body">if(status != IlvMaps::NoError())</div><div id="ww1037200" class="Body">   IlvWarning(IlvMaps::GetErrorMessage(status, display));        </div><div id="ww1035296" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1024605" class="Heading3"><span></span>Loading Nongeoreferenced Files</div><div id="ww1007998" class="Body">When you load a map into a Rogue Wave&nbsp;Views manager using the map loader, this map is automatically displayed in the projection system associated with the manager provided that the format of the source data is georeferenced. The <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> abstract class has a <span class="code">getProjection</span> method that you can use to know whether a file is georeferenced. If the <span class="code">getProjection</span> method returns 0 or <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvUnknownProjection.html">IlvUnknownProjection</a></span>, the file is not georeferenced. Otherwise, the file is georeferenced. See the section Feature Iterators for more information.</div><div id="ww1008003" class="Body">Most of the cartographic files are georeferenced. This is the case for files of the DTED and CADRG formats. Some other cartographic formats, such as Shapefile, are not georeferenced.</div><div id="ww1008004" class="Body">When loading data from a file that is not georeferenced, and in the absence of any other indications, the map loader is unable to reproject the source data within the target projection system (the one associated with the manager). See the section <a href="../Options/programmingmaps.56.15.html#ww1020089" title="Selecting a Target Projection">Selecting a Target Projection</a>. </div><div class="ww_skin_page_overflow"><table class="NoteTable" cellspacing="0" summary=""><tr><td style="padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top"><div id="ww1008010" class="Note"><span class="flag">Note:&nbsp;</span>If you load several source files of the Shapefile format whose projection is unknown in the same manager, objects can be positioned correctly if the data is expressed in the same coordinate system. However, if you try to import data of another format in the manager, the relative position of objects from different source formats will be inaccurate. </div></td></tr></table></div><div id="ww1008011" class="Body">If you read a file whose format is not georeferenced, but you know the projection system in which the data is expressed, you can provide this information to the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html">IlvMapLoader</a></span> using the <span class="MethodName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html#a81e502f8916ca63dbee108b31e888e7c">setDefaultSourceProjection</a></span> method. </div><div id="ww1008013" class="Body">The following example shows how to import a Shapefile whose projection is known to be geographic into a manager that is in a Mercator projection:</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1036864" class="Body">// Initialize the manager for the mercator projection.</div><div id="ww1036865" class="Body">IlvProjection* projection = new IlvMercatorProjection();</div><div id="ww1036866" class="Body">IlvMapInfo* mapinfo = new IlvMapInfo(projection, 0, IlvFalse);</div><div id="ww1036867" class="Body">mapinfo-&gt;attach(manager);</div><div id="ww1036869" class="Body">// Create a map loader.</div><div id="ww1036870" class="Body">IlvMapLoader mapLoader = new IlvMapLoader(manager);</div><div id="ww1036872" class="Body">// Load other data.</div><div id="ww1036873" class="Body">....</div><div id="ww1036875" class="Body">// Load a shape file that is in the geographic projection.</div><div id="ww1036876" class="Body">IlvProjection* geographic = new IlvGeographicProjection();</div><div id="ww1036877" class="Body">mapLoader-&gt;setDefaultSourceProjection(geographic);</div><div id="ww1036878" class="Body">mapLoader-&gt;load("myShapeFile.shp");</div><div id="ww1034921" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1008040" class="Heading3"><span></span>Specifying a Renderer</div><div id="ww1008042" class="Body">If you want an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html">IlvMapLoader</a></span> object to use a specific renderer, specify it as the second argument of its <span class="code">load(IlvMapFeatureIterator* featureIterator, IlvFeatureRenderer* renderer, IlvMapsError&amp; status)</span> method, as shown below:</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1036825" class="Body">IlvMapLoader* loader = new IlvMapLoader(&amp;manager);</div><div id="ww1036826" class="Body">IlvMapsError status = IlvMaps::NoError();</div><div id="ww1036827" class="Body">IlvMapFeatureIterator* iterator =</div><div id="ww1036828" class="Body">    loader-&gt;makeFeatureIterator(filename);</div><div id="ww1036829" class="Body">IlvDefaultCurveRenderer* renderer =</div><div id="ww1036830" class="Body">    new IlvDefaultCurveRenderer(display);</div><div id="ww1036831" class="Body">IlvMapLineRenderingStyle* style =</div><div id="ww1036832" class="Body">    new IlvMapLineRenderingStyle(display);</div><div id="ww1036833" class="Body">style-&gt;setForeground(display-&gt;getColor("green"));</div><div id="ww1036834" class="Body">renderer-&gt;setLineRenderingStyle(style);</div><div id="ww1036835" class="Body">loader-&gt;load(iterator, renderer, status);</div><div id="ww1036836" class="Body">if(status != IlvMaps::NoError())</div><div id="ww1036837" class="Body">    IlvWarning(IlvMaps::GetErrorMessage(status, display));</div><div id="ww1034876" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1008747" class="Heading3"><span></span>Extending the IlvMapLoader Class </div><div id="ww1008755" class="Body">This section shows how to subtype the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html">IlvMapLoader</a></span> class so that it can recognize a file format other than the Rogue Wave&nbsp;Views Maps predefined formats. </div><div id="ww1032593" class="Body">The method <span class="MethodName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html#a286a07f9ebf47f0399bdbcfe758eaad1">makeFeatureIterator</a></span> method creates the reader that recognizes the format of the file specified as its parameter. We are going to derive the <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapLoader.html">IlvMapLoader</a></span> class and override this method so that it can recognize the format of the polyline file presented in the section <a href="../Options/programmingmaps.56.14.html#ww1008123" title="Writing a New Reader">Writing a New Reader</a>and initialize the appropriate reader. We assume that the file has the <span class="code">.pol</span> extension.</div><div class="ww_skin_page_overflow"><table class="CodeTable" cellspacing="0" summary=""><tr><td style="background-color: #E0E0E0; padding-bottom: 2pt; padding-left: 0pt; padding-right: 0pt; padding-top: 2pt; vertical-align: top; width: 371.338299212598pt"><div id="ww1037343" class="Body">#include &lt;strings.h&gt;</div><div id="ww1037345" class="Body">#include &lt;ilviews/maps/format/maploader.h&gt;</div><div id="ww1037347" class="Body">#include "polread.h"</div><div id="ww1037349" class="Body">class MyMapLoader</div><div id="ww1037350" class="Body">    :public IlvMapLoader</div><div id="ww1037351" class="Body">{</div><div id="ww1037352" class="Body">public:</div><div id="ww1037353" class="Body">    MyMapLoader(IlvDisplay* display,</div><div id="ww1037354" class="Body">                IlvManager* manager);</div><div id="ww1037356" class="Body">    /**</div><div id="ww1037357" class="Body">     * Overrides the makeFeatureIterator method from super class.</div><div id="ww1037358" class="Body">     */</div><div id="ww1037359" class="Body">    virtual IlvMapFeatureIterator* makeFeatureIterator(const char* fileName);</div><div id="ww1037360" class="Body">private:</div><div id="ww1037361" class="Body">    IlvDisplay* _display;</div><div id="ww1037362" class="Body">};</div><div id="ww1037364" class="Body">MyMapLoader::MyMapLoader(IlvDisplay* display,</div><div id="ww1037365" class="Body">                         IlvManager* manager)</div><div id="ww1037366" class="Body">    :IlvMapLoader(manager),</div><div id="ww1037367" class="Body">     _display(display)</div><div id="ww1037368" class="Body">{</div><div id="ww1037369" class="Body">}</div><div id="ww1037371" class="Body">IlvMapFeatureIterator*</div><div id="ww1037372" class="Body">MyMapLoader::makeFeatureIterator(const char* fileName)</div><div id="ww1037373" class="Body">{</div><div id="ww1037374" class="Body">    // Does superclass know the format of provided file?</div><div id="ww1037375" class="Body">    IlvMapFeatureIterator* result =</div><div id="ww1037376" class="Body">        IlvMapLoader::makeFeatureIterator(fileName);</div><div id="ww1037377" class="Body">    // If not, try with the polygon reader.</div><div id="ww1037378" class="Body">    if (!result) {</div><div id="ww1037379" class="Body">        // test extension</div><div id="ww1037380" class="Body">        int length = strlen(fileName);</div><div id="ww1037381" class="Body">        // .pol are polylines files.</div><div id="ww1037382" class="Body">        if (length &gt; 4) {</div><div id="ww1037383" class="Body">            char* ptr = strrchr(fileName, ’.’);</div><div id="ww1037384" class="Body">            if(ptr)</div><div id="ww1037385" class="Body">                if(strcasecmp(ptr, ".pol") == 0)</div><div id="ww1037386" class="Body">                    return new SimplePolylineReader(_display, fileName);</div><div id="ww1037387" class="Body">        }</div><div id="ww1037388" class="Body">    }</div><div id="ww1037389" class="Body">    return result;</div><div id="ww1037390" class="Body">}</div><div id="ww1035308" class="CodeInTable">&nbsp;</div></td></tr></table></div><div id="ww1008794" class="Body">The <span class="code">makeFeatureIterator</span> method first attempts to get an <span class="ClassName"><a href="../RefMan/refcppmaps/classIlvMapFeatureIterator.html">IlvMapFeatureIterator</a></span> from its superclass. If the file is not recognized, it tries to determine whether the file extension provided (in this example, <span class="code">.pol</span>) corresponds to that of the file to be read. If the result of the test is successful, it creates the appropriate reader, which in this case is the reader created in the section <a href="../Options/programmingmaps.56.14.html#ww1008123" title="Writing a New Reader">Writing a New Reader</a>.</div><div id="ww1008873" class="Body">If the file does not contain a header, the method returns the null pointer to indicate that it was not able to identify the file format.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><div class="ww_skin_page_globalization"><div id="google_translate_element">&nbsp;</div><script><!--
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({
                  pageLanguage: '',
                  autoDisplay: true
                }, 'google_translate_element');
            }
// --></script></div><br /></footer><HR /><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Version 6.2.1</div><div style="font-size: 8pt; font-family: verdana; font-weight: normal; text-align: center;">Copyright © 2018, Rogue Wave Software, Inc. All Rights Reserved.</div></body></html>